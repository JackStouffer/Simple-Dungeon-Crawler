!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=25)}([function(e,t,n){const{EntityRef:r,EntitySet:i,EntityObject:o}=n(19);e.exports={World:n(20),System:n(13),Component:n(11),Entity:n(7),EntityRef:r,EntitySet:i,EntityObject:o}},function(e,t,n){(function(e,r){var i;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var o="Expected a function",a="__lodash_placeholder__",s=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],l="[object Arguments]",u="[object Array]",c="[object Boolean]",h="[object Date]",d="[object Error]",p="[object Function]",f="[object GeneratorFunction]",m="[object Map]",g="[object Number]",y="[object Object]",v="[object RegExp]",_="[object Set]",w="[object String]",b="[object Symbol]",x="[object WeakMap]",C="[object ArrayBuffer]",T="[object DataView]",E="[object Float32Array]",S="[object Float64Array]",k="[object Int8Array]",A="[object Int16Array]",O="[object Int32Array]",P="[object Uint8Array]",I="[object Uint16Array]",M="[object Uint32Array]",G=/\b__p \+= '';/g,L=/\b(__p \+=) '' \+/g,D=/(__e\(.*?\)|\b__t\)) \+\n'';/g,j=/&(?:amp|lt|gt|quot|#39);/g,F=/[&<>"']/g,N=RegExp(j.source),R=RegExp(F.source),H=/<%-([\s\S]+?)%>/g,$=/<%([\s\S]+?)%>/g,z=/<%=([\s\S]+?)%>/g,W=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,U=/^\w*$/,B=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,q=/[\\^$.*+?()[\]{}|]/g,V=RegExp(q.source),K=/^\s+|\s+$/g,X=/^\s+/,Y=/\s+$/,Q=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Z=/\{\n\/\* \[wrapped with (.+)\] \*/,J=/,? & /,ee=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,te=/\\(\\)?/g,ne=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,re=/\w*$/,ie=/^[-+]0x[0-9a-f]+$/i,oe=/^0b[01]+$/i,ae=/^\[object .+?Constructor\]$/,se=/^0o[0-7]+$/i,le=/^(?:0|[1-9]\d*)$/,ue=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ce=/($^)/,he=/['\n\r\u2028\u2029\\]/g,de="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",pe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",fe="[\\ud800-\\udfff]",me="["+pe+"]",ge="["+de+"]",ye="\\d+",ve="[\\u2700-\\u27bf]",_e="[a-z\\xdf-\\xf6\\xf8-\\xff]",we="[^\\ud800-\\udfff"+pe+ye+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",be="\\ud83c[\\udffb-\\udfff]",xe="[^\\ud800-\\udfff]",Ce="(?:\\ud83c[\\udde6-\\uddff]){2}",Te="[\\ud800-\\udbff][\\udc00-\\udfff]",Ee="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Se="(?:"+_e+"|"+we+")",ke="(?:"+Ee+"|"+we+")",Ae="(?:"+ge+"|"+be+")"+"?",Oe="[\\ufe0e\\ufe0f]?"+Ae+("(?:\\u200d(?:"+[xe,Ce,Te].join("|")+")[\\ufe0e\\ufe0f]?"+Ae+")*"),Pe="(?:"+[ve,Ce,Te].join("|")+")"+Oe,Ie="(?:"+[xe+ge+"?",ge,Ce,Te,fe].join("|")+")",Me=RegExp("['’]","g"),Ge=RegExp(ge,"g"),Le=RegExp(be+"(?="+be+")|"+Ie+Oe,"g"),De=RegExp([Ee+"?"+_e+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[me,Ee,"$"].join("|")+")",ke+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[me,Ee+Se,"$"].join("|")+")",Ee+"?"+Se+"+(?:['’](?:d|ll|m|re|s|t|ve))?",Ee+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ye,Pe].join("|"),"g"),je=RegExp("[\\u200d\\ud800-\\udfff"+de+"\\ufe0e\\ufe0f]"),Fe=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ne=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Re=-1,He={};He[E]=He[S]=He[k]=He[A]=He[O]=He[P]=He["[object Uint8ClampedArray]"]=He[I]=He[M]=!0,He[l]=He[u]=He[C]=He[c]=He[T]=He[h]=He[d]=He[p]=He[m]=He[g]=He[y]=He[v]=He[_]=He[w]=He[x]=!1;var $e={};$e[l]=$e[u]=$e[C]=$e[T]=$e[c]=$e[h]=$e[E]=$e[S]=$e[k]=$e[A]=$e[O]=$e[m]=$e[g]=$e[y]=$e[v]=$e[_]=$e[w]=$e[b]=$e[P]=$e["[object Uint8ClampedArray]"]=$e[I]=$e[M]=!0,$e[d]=$e[p]=$e[x]=!1;var ze={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},We=parseFloat,Ue=parseInt,Be="object"==typeof e&&e&&e.Object===Object&&e,qe="object"==typeof self&&self&&self.Object===Object&&self,Ve=Be||qe||Function("return this")(),Ke=t&&!t.nodeType&&t,Xe=Ke&&"object"==typeof r&&r&&!r.nodeType&&r,Ye=Xe&&Xe.exports===Ke,Qe=Ye&&Be.process,Ze=function(){try{var e=Xe&&Xe.require&&Xe.require("util").types;return e||Qe&&Qe.binding&&Qe.binding("util")}catch(e){}}(),Je=Ze&&Ze.isArrayBuffer,et=Ze&&Ze.isDate,tt=Ze&&Ze.isMap,nt=Ze&&Ze.isRegExp,rt=Ze&&Ze.isSet,it=Ze&&Ze.isTypedArray;function ot(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function at(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}function st(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function lt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function ut(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function ct(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}function ht(e,t){return!!(null==e?0:e.length)&&bt(e,t,0)>-1}function dt(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function pt(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function ft(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function mt(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function gt(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function yt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var vt=Et("length");function _t(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function wt(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function bt(e,t,n){return t==t?function(e,t,n){var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):wt(e,Ct,n)}function xt(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function Ct(e){return e!=e}function Tt(e,t){var n=null==e?0:e.length;return n?At(e,t)/n:NaN}function Et(e){return function(t){return null==t?void 0:t[e]}}function St(e){return function(t){return null==e?void 0:e[t]}}function kt(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}function At(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);void 0!==o&&(n=void 0===n?o:n+o)}return n}function Ot(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Pt(e){return function(t){return e(t)}}function It(e,t){return pt(t,(function(t){return e[t]}))}function Mt(e,t){return e.has(t)}function Gt(e,t){for(var n=-1,r=e.length;++n<r&&bt(t,e[n],0)>-1;);return n}function Lt(e,t){for(var n=e.length;n--&&bt(t,e[n],0)>-1;);return n}function Dt(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}var jt=St({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Ft=St({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Nt(e){return"\\"+ze[e]}function Rt(e){return je.test(e)}function Ht(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function $t(e,t){return function(n){return e(t(n))}}function zt(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n];s!==t&&s!==a||(e[n]=a,o[i++]=n)}return o}function Wt(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function Ut(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function Bt(e){return Rt(e)?function(e){var t=Le.lastIndex=0;for(;Le.test(e);)++t;return t}(e):vt(e)}function qt(e){return Rt(e)?function(e){return e.match(Le)||[]}(e):function(e){return e.split("")}(e)}var Vt=St({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Kt=function e(t){var n,r=(t=null==t?Ve:Kt.defaults(Ve.Object(),t,Kt.pick(Ve,Ne))).Array,i=t.Date,de=t.Error,pe=t.Function,fe=t.Math,me=t.Object,ge=t.RegExp,ye=t.String,ve=t.TypeError,_e=r.prototype,we=pe.prototype,be=me.prototype,xe=t["__core-js_shared__"],Ce=we.toString,Te=be.hasOwnProperty,Ee=0,Se=(n=/[^.]+$/.exec(xe&&xe.keys&&xe.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",ke=be.toString,Ae=Ce.call(me),Oe=Ve._,Pe=ge("^"+Ce.call(Te).replace(q,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ie=Ye?t.Buffer:void 0,Le=t.Symbol,je=t.Uint8Array,ze=Ie?Ie.allocUnsafe:void 0,Be=$t(me.getPrototypeOf,me),qe=me.create,Ke=be.propertyIsEnumerable,Xe=_e.splice,Qe=Le?Le.isConcatSpreadable:void 0,Ze=Le?Le.iterator:void 0,vt=Le?Le.toStringTag:void 0,St=function(){try{var e=Ji(me,"defineProperty");return e({},"",{}),e}catch(e){}}(),Xt=t.clearTimeout!==Ve.clearTimeout&&t.clearTimeout,Yt=i&&i.now!==Ve.Date.now&&i.now,Qt=t.setTimeout!==Ve.setTimeout&&t.setTimeout,Zt=fe.ceil,Jt=fe.floor,en=me.getOwnPropertySymbols,tn=Ie?Ie.isBuffer:void 0,nn=t.isFinite,rn=_e.join,on=$t(me.keys,me),an=fe.max,sn=fe.min,ln=i.now,un=t.parseInt,cn=fe.random,hn=_e.reverse,dn=Ji(t,"DataView"),pn=Ji(t,"Map"),fn=Ji(t,"Promise"),mn=Ji(t,"Set"),gn=Ji(t,"WeakMap"),yn=Ji(me,"create"),vn=gn&&new gn,_n={},wn=ko(dn),bn=ko(pn),xn=ko(fn),Cn=ko(mn),Tn=ko(gn),En=Le?Le.prototype:void 0,Sn=En?En.valueOf:void 0,kn=En?En.toString:void 0;function An(e){if(Ua(e)&&!Ga(e)&&!(e instanceof Mn)){if(e instanceof In)return e;if(Te.call(e,"__wrapped__"))return Ao(e)}return new In(e)}var On=function(){function e(){}return function(t){if(!Wa(t))return{};if(qe)return qe(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Pn(){}function In(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function Mn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Gn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Ln(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Dn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function jn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Dn;++t<n;)this.add(e[t])}function Fn(e){var t=this.__data__=new Ln(e);this.size=t.size}function Nn(e,t){var n=Ga(e),r=!n&&Ma(e),i=!n&&!r&&Fa(e),o=!n&&!r&&!i&&Za(e),a=n||r||i||o,s=a?Ot(e.length,ye):[],l=s.length;for(var u in e)!t&&!Te.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ao(u,l))||s.push(u);return s}function Rn(e){var t=e.length;return t?e[jr(0,t-1)]:void 0}function Hn(e,t){return To(yi(e),Xn(t,0,e.length))}function $n(e){return To(yi(e))}function zn(e,t,n){(void 0!==n&&!Oa(e[t],n)||void 0===n&&!(t in e))&&Vn(e,t,n)}function Wn(e,t,n){var r=e[t];Te.call(e,t)&&Oa(r,n)&&(void 0!==n||t in e)||Vn(e,t,n)}function Un(e,t){for(var n=e.length;n--;)if(Oa(e[n][0],t))return n;return-1}function Bn(e,t,n,r){return er(e,(function(e,i,o){t(r,e,n(e),o)})),r}function qn(e,t){return e&&vi(t,ws(t),e)}function Vn(e,t,n){"__proto__"==t&&St?St(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Kn(e,t){for(var n=-1,i=t.length,o=r(i),a=null==e;++n<i;)o[n]=a?void 0:ms(e,t[n]);return o}function Xn(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}function Yn(e,t,n,r,i,o){var a,s=1&t,u=2&t,d=4&t;if(n&&(a=i?n(e,r,i,o):n(e)),void 0!==a)return a;if(!Wa(e))return e;var x=Ga(e);if(x){if(a=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&Te.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!s)return yi(e,a)}else{var G=no(e),L=G==p||G==f;if(Fa(e))return hi(e,s);if(G==y||G==l||L&&!i){if(a=u||L?{}:io(e),!s)return u?function(e,t){return vi(e,to(e),t)}(e,function(e,t){return e&&vi(t,bs(t),e)}(a,e)):function(e,t){return vi(e,eo(e),t)}(e,qn(a,e))}else{if(!$e[G])return i?e:{};a=function(e,t,n){var r=e.constructor;switch(t){case C:return di(e);case c:case h:return new r(+e);case T:return function(e,t){var n=t?di(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case E:case S:case k:case A:case O:case P:case"[object Uint8ClampedArray]":case I:case M:return pi(e,n);case m:return new r;case g:case w:return new r(e);case v:return function(e){var t=new e.constructor(e.source,re.exec(e));return t.lastIndex=e.lastIndex,t}(e);case _:return new r;case b:return i=e,Sn?me(Sn.call(i)):{}}var i}(e,G,s)}}o||(o=new Fn);var D=o.get(e);if(D)return D;o.set(e,a),Xa(e)?e.forEach((function(r){a.add(Yn(r,t,n,r,e,o))})):Ba(e)&&e.forEach((function(r,i){a.set(i,Yn(r,t,n,i,e,o))}));var j=x?void 0:(d?u?qi:Bi:u?bs:ws)(e);return st(j||e,(function(r,i){j&&(r=e[i=r]),Wn(a,i,Yn(r,t,n,i,e,o))})),a}function Qn(e,t,n){var r=n.length;if(null==e)return!r;for(e=me(e);r--;){var i=n[r],o=t[i],a=e[i];if(void 0===a&&!(i in e)||!o(a))return!1}return!0}function Zn(e,t,n){if("function"!=typeof e)throw new ve(o);return wo((function(){e.apply(void 0,n)}),t)}function Jn(e,t,n,r){var i=-1,o=ht,a=!0,s=e.length,l=[],u=t.length;if(!s)return l;n&&(t=pt(t,Pt(n))),r?(o=dt,a=!1):t.length>=200&&(o=Mt,a=!1,t=new jn(t));e:for(;++i<s;){var c=e[i],h=null==n?c:n(c);if(c=r||0!==c?c:0,a&&h==h){for(var d=u;d--;)if(t[d]===h)continue e;l.push(c)}else o(t,h,r)||l.push(c)}return l}An.templateSettings={escape:H,evaluate:$,interpolate:z,variable:"",imports:{_:An}},An.prototype=Pn.prototype,An.prototype.constructor=An,In.prototype=On(Pn.prototype),In.prototype.constructor=In,Mn.prototype=On(Pn.prototype),Mn.prototype.constructor=Mn,Gn.prototype.clear=function(){this.__data__=yn?yn(null):{},this.size=0},Gn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Gn.prototype.get=function(e){var t=this.__data__;if(yn){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Te.call(t,e)?t[e]:void 0},Gn.prototype.has=function(e){var t=this.__data__;return yn?void 0!==t[e]:Te.call(t,e)},Gn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=yn&&void 0===t?"__lodash_hash_undefined__":t,this},Ln.prototype.clear=function(){this.__data__=[],this.size=0},Ln.prototype.delete=function(e){var t=this.__data__,n=Un(t,e);return!(n<0)&&(n==t.length-1?t.pop():Xe.call(t,n,1),--this.size,!0)},Ln.prototype.get=function(e){var t=this.__data__,n=Un(t,e);return n<0?void 0:t[n][1]},Ln.prototype.has=function(e){return Un(this.__data__,e)>-1},Ln.prototype.set=function(e,t){var n=this.__data__,r=Un(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Dn.prototype.clear=function(){this.size=0,this.__data__={hash:new Gn,map:new(pn||Ln),string:new Gn}},Dn.prototype.delete=function(e){var t=Qi(this,e).delete(e);return this.size-=t?1:0,t},Dn.prototype.get=function(e){return Qi(this,e).get(e)},Dn.prototype.has=function(e){return Qi(this,e).has(e)},Dn.prototype.set=function(e,t){var n=Qi(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},jn.prototype.add=jn.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},jn.prototype.has=function(e){return this.__data__.has(e)},Fn.prototype.clear=function(){this.__data__=new Ln,this.size=0},Fn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Fn.prototype.get=function(e){return this.__data__.get(e)},Fn.prototype.has=function(e){return this.__data__.has(e)},Fn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Ln){var r=n.__data__;if(!pn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Dn(r)}return n.set(e,t),this.size=n.size,this};var er=bi(lr),tr=bi(ur,!0);function nr(e,t){var n=!0;return er(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function rr(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],a=t(o);if(null!=a&&(void 0===s?a==a&&!Qa(a):n(a,s)))var s=a,l=o}return l}function ir(e,t){var n=[];return er(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function or(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=oo),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?or(s,t-1,n,r,i):ft(i,s):r||(i[i.length]=s)}return i}var ar=xi(),sr=xi(!0);function lr(e,t){return e&&ar(e,t,ws)}function ur(e,t){return e&&sr(e,t,ws)}function cr(e,t){return ct(t,(function(t){return Ha(e[t])}))}function hr(e,t){for(var n=0,r=(t=si(t,e)).length;null!=e&&n<r;)e=e[So(t[n++])];return n&&n==r?e:void 0}function dr(e,t,n){var r=t(e);return Ga(e)?r:ft(r,n(e))}function pr(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":vt&&vt in me(e)?function(e){var t=Te.call(e,vt),n=e[vt];try{e[vt]=void 0;var r=!0}catch(e){}var i=ke.call(e);r&&(t?e[vt]=n:delete e[vt]);return i}(e):function(e){return ke.call(e)}(e)}function fr(e,t){return e>t}function mr(e,t){return null!=e&&Te.call(e,t)}function gr(e,t){return null!=e&&t in me(e)}function yr(e,t,n){for(var i=n?dt:ht,o=e[0].length,a=e.length,s=a,l=r(a),u=1/0,c=[];s--;){var h=e[s];s&&t&&(h=pt(h,Pt(t))),u=sn(h.length,u),l[s]=!n&&(t||o>=120&&h.length>=120)?new jn(s&&h):void 0}h=e[0];var d=-1,p=l[0];e:for(;++d<o&&c.length<u;){var f=h[d],m=t?t(f):f;if(f=n||0!==f?f:0,!(p?Mt(p,m):i(c,m,n))){for(s=a;--s;){var g=l[s];if(!(g?Mt(g,m):i(e[s],m,n)))continue e}p&&p.push(m),c.push(f)}}return c}function vr(e,t,n){var r=null==(e=go(e,t=si(t,e)))?e:e[So(Ro(t))];return null==r?void 0:ot(r,e,n)}function _r(e){return Ua(e)&&pr(e)==l}function wr(e,t,n,r,i){return e===t||(null==e||null==t||!Ua(e)&&!Ua(t)?e!=e&&t!=t:function(e,t,n,r,i,o){var a=Ga(e),s=Ga(t),p=a?u:no(e),f=s?u:no(t),x=(p=p==l?y:p)==y,E=(f=f==l?y:f)==y,S=p==f;if(S&&Fa(e)){if(!Fa(t))return!1;a=!0,x=!1}if(S&&!x)return o||(o=new Fn),a||Za(e)?Wi(e,t,n,r,i,o):function(e,t,n,r,i,o,a){switch(n){case T:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case C:return!(e.byteLength!=t.byteLength||!o(new je(e),new je(t)));case c:case h:case g:return Oa(+e,+t);case d:return e.name==t.name&&e.message==t.message;case v:case w:return e==t+"";case m:var s=Ht;case _:var l=1&r;if(s||(s=Wt),e.size!=t.size&&!l)return!1;var u=a.get(e);if(u)return u==t;r|=2,a.set(e,t);var p=Wi(s(e),s(t),r,i,o,a);return a.delete(e),p;case b:if(Sn)return Sn.call(e)==Sn.call(t)}return!1}(e,t,p,n,r,i,o);if(!(1&n)){var k=x&&Te.call(e,"__wrapped__"),A=E&&Te.call(t,"__wrapped__");if(k||A){var O=k?e.value():e,P=A?t.value():t;return o||(o=new Fn),i(O,P,n,r,o)}}if(!S)return!1;return o||(o=new Fn),function(e,t,n,r,i,o){var a=1&n,s=Bi(e),l=s.length,u=Bi(t).length;if(l!=u&&!a)return!1;var c=l;for(;c--;){var h=s[c];if(!(a?h in t:Te.call(t,h)))return!1}var d=o.get(e),p=o.get(t);if(d&&p)return d==t&&p==e;var f=!0;o.set(e,t),o.set(t,e);var m=a;for(;++c<l;){h=s[c];var g=e[h],y=t[h];if(r)var v=a?r(y,g,h,t,e,o):r(g,y,h,e,t,o);if(!(void 0===v?g===y||i(g,y,n,r,o):v)){f=!1;break}m||(m="constructor"==h)}if(f&&!m){var _=e.constructor,w=t.constructor;_==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof w&&w instanceof w||(f=!1)}return o.delete(e),o.delete(t),f}(e,t,n,r,i,o)}(e,t,n,r,wr,i))}function br(e,t,n,r){var i=n.length,o=i,a=!r;if(null==e)return!o;for(e=me(e);i--;){var s=n[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var l=(s=n[i])[0],u=e[l],c=s[1];if(a&&s[2]){if(void 0===u&&!(l in e))return!1}else{var h=new Fn;if(r)var d=r(u,c,l,e,t,h);if(!(void 0===d?wr(c,u,3,r,h):d))return!1}}return!0}function xr(e){return!(!Wa(e)||(t=e,Se&&Se in t))&&(Ha(e)?Pe:ae).test(ko(e));var t}function Cr(e){return"function"==typeof e?e:null==e?qs:"object"==typeof e?Ga(e)?Or(e[0],e[1]):Ar(e):tl(e)}function Tr(e){if(!ho(e))return on(e);var t=[];for(var n in me(e))Te.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Er(e){if(!Wa(e))return function(e){var t=[];if(null!=e)for(var n in me(e))t.push(n);return t}(e);var t=ho(e),n=[];for(var r in e)("constructor"!=r||!t&&Te.call(e,r))&&n.push(r);return n}function Sr(e,t){return e<t}function kr(e,t){var n=-1,i=Da(e)?r(e.length):[];return er(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}function Ar(e){var t=Zi(e);return 1==t.length&&t[0][2]?fo(t[0][0],t[0][1]):function(n){return n===e||br(n,e,t)}}function Or(e,t){return lo(e)&&po(t)?fo(So(e),t):function(n){var r=ms(n,e);return void 0===r&&r===t?gs(n,e):wr(t,r,3)}}function Pr(e,t,n,r,i){e!==t&&ar(t,(function(o,a){if(i||(i=new Fn),Wa(o))!function(e,t,n,r,i,o,a){var s=vo(e,n),l=vo(t,n),u=a.get(l);if(u)return void zn(e,n,u);var c=o?o(s,l,n+"",e,t,a):void 0,h=void 0===c;if(h){var d=Ga(l),p=!d&&Fa(l),f=!d&&!p&&Za(l);c=l,d||p||f?Ga(s)?c=s:ja(s)?c=yi(s):p?(h=!1,c=hi(l,!0)):f?(h=!1,c=pi(l,!0)):c=[]:Va(l)||Ma(l)?(c=s,Ma(s)?c=as(s):Wa(s)&&!Ha(s)||(c=io(l))):h=!1}h&&(a.set(l,c),i(c,l,r,o,a),a.delete(l));zn(e,n,c)}(e,t,a,n,Pr,r,i);else{var s=r?r(vo(e,a),o,a+"",e,t,i):void 0;void 0===s&&(s=o),zn(e,a,s)}}),bs)}function Ir(e,t){var n=e.length;if(n)return ao(t+=t<0?n:0,n)?e[t]:void 0}function Mr(e,t,n){t=t.length?pt(t,(function(e){return Ga(e)?function(t){return hr(t,1===e.length?e[0]:e)}:e})):[qs];var r=-1;return t=pt(t,Pt(Yi())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(kr(e,(function(e,n,i){return{criteria:pt(t,(function(t){return t(e)})),index:++r,value:e}})),(function(e,t){return function(e,t,n){var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;for(;++r<a;){var l=fi(i[r],o[r]);if(l){if(r>=s)return l;var u=n[r];return l*("desc"==u?-1:1)}}return e.index-t.index}(e,t,n)}))}function Gr(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=hr(e,a);n(s,a)&&$r(o,si(a,e),s)}return o}function Lr(e,t,n,r){var i=r?xt:bt,o=-1,a=t.length,s=e;for(e===t&&(t=yi(t)),n&&(s=pt(e,Pt(n)));++o<a;)for(var l=0,u=t[o],c=n?n(u):u;(l=i(s,c,l,r))>-1;)s!==e&&Xe.call(s,l,1),Xe.call(e,l,1);return e}function Dr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;ao(i)?Xe.call(e,i,1):Jr(e,i)}}return e}function jr(e,t){return e+Jt(cn()*(t-e+1))}function Fr(e,t){var n="";if(!e||t<1||t>9007199254740991)return n;do{t%2&&(n+=e),(t=Jt(t/2))&&(e+=e)}while(t);return n}function Nr(e,t){return bo(mo(e,t,qs),e+"")}function Rr(e){return Rn(Os(e))}function Hr(e,t){var n=Os(e);return To(n,Xn(t,0,n.length))}function $r(e,t,n,r){if(!Wa(e))return e;for(var i=-1,o=(t=si(t,e)).length,a=o-1,s=e;null!=s&&++i<o;){var l=So(t[i]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(i!=a){var c=s[l];void 0===(u=r?r(c,l,s):void 0)&&(u=Wa(c)?c:ao(t[i+1])?[]:{})}Wn(s,l,u),s=s[l]}return e}var zr=vn?function(e,t){return vn.set(e,t),e}:qs,Wr=St?function(e,t){return St(e,"toString",{configurable:!0,enumerable:!1,value:Ws(t),writable:!0})}:qs;function Ur(e){return To(Os(e))}function Br(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var a=r(o);++i<o;)a[i]=e[i+t];return a}function qr(e,t){var n;return er(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function Vr(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,a=e[o];null!==a&&!Qa(a)&&(n?a<=t:a<t)?r=o+1:i=o}return i}return Kr(e,t,qs,n)}function Kr(e,t,n,r){var i=0,o=null==e?0:e.length;if(0===o)return 0;for(var a=(t=n(t))!=t,s=null===t,l=Qa(t),u=void 0===t;i<o;){var c=Jt((i+o)/2),h=n(e[c]),d=void 0!==h,p=null===h,f=h==h,m=Qa(h);if(a)var g=r||f;else g=u?f&&(r||d):s?f&&d&&(r||!p):l?f&&d&&!p&&(r||!m):!p&&!m&&(r?h<=t:h<t);g?i=c+1:o=c}return sn(o,4294967294)}function Xr(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n],s=t?t(a):a;if(!n||!Oa(s,l)){var l=s;o[i++]=0===a?0:a}}return o}function Yr(e){return"number"==typeof e?e:Qa(e)?NaN:+e}function Qr(e){if("string"==typeof e)return e;if(Ga(e))return pt(e,Qr)+"";if(Qa(e))return kn?kn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Zr(e,t,n){var r=-1,i=ht,o=e.length,a=!0,s=[],l=s;if(n)a=!1,i=dt;else if(o>=200){var u=t?null:Fi(e);if(u)return Wt(u);a=!1,i=Mt,l=new jn}else l=t?[]:s;e:for(;++r<o;){var c=e[r],h=t?t(c):c;if(c=n||0!==c?c:0,a&&h==h){for(var d=l.length;d--;)if(l[d]===h)continue e;t&&l.push(h),s.push(c)}else i(l,h,n)||(l!==s&&l.push(h),s.push(c))}return s}function Jr(e,t){return null==(e=go(e,t=si(t,e)))||delete e[So(Ro(t))]}function ei(e,t,n,r){return $r(e,t,n(hr(e,t)),r)}function ti(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?Br(e,r?0:o,r?o+1:i):Br(e,r?o+1:0,r?i:o)}function ni(e,t){var n=e;return n instanceof Mn&&(n=n.value()),mt(t,(function(e,t){return t.func.apply(t.thisArg,ft([e],t.args))}),n)}function ri(e,t,n){var i=e.length;if(i<2)return i?Zr(e[0]):[];for(var o=-1,a=r(i);++o<i;)for(var s=e[o],l=-1;++l<i;)l!=o&&(a[o]=Jn(a[o]||s,e[l],t,n));return Zr(or(a,1),t,n)}function ii(e,t,n){for(var r=-1,i=e.length,o=t.length,a={};++r<i;){var s=r<o?t[r]:void 0;n(a,e[r],s)}return a}function oi(e){return ja(e)?e:[]}function ai(e){return"function"==typeof e?e:qs}function si(e,t){return Ga(e)?e:lo(e,t)?[e]:Eo(ss(e))}var li=Nr;function ui(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:Br(e,t,n)}var ci=Xt||function(e){return Ve.clearTimeout(e)};function hi(e,t){if(t)return e.slice();var n=e.length,r=ze?ze(n):new e.constructor(n);return e.copy(r),r}function di(e){var t=new e.constructor(e.byteLength);return new je(t).set(new je(e)),t}function pi(e,t){var n=t?di(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function fi(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e==e,o=Qa(e),a=void 0!==t,s=null===t,l=t==t,u=Qa(t);if(!s&&!u&&!o&&e>t||o&&a&&l&&!s&&!u||r&&a&&l||!n&&l||!i)return 1;if(!r&&!o&&!u&&e<t||u&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!l)return-1}return 0}function mi(e,t,n,i){for(var o=-1,a=e.length,s=n.length,l=-1,u=t.length,c=an(a-s,0),h=r(u+c),d=!i;++l<u;)h[l]=t[l];for(;++o<s;)(d||o<a)&&(h[n[o]]=e[o]);for(;c--;)h[l++]=e[o++];return h}function gi(e,t,n,i){for(var o=-1,a=e.length,s=-1,l=n.length,u=-1,c=t.length,h=an(a-l,0),d=r(h+c),p=!i;++o<h;)d[o]=e[o];for(var f=o;++u<c;)d[f+u]=t[u];for(;++s<l;)(p||o<a)&&(d[f+n[s]]=e[o++]);return d}function yi(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function vi(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],l=r?r(n[s],e[s],s,n,e):void 0;void 0===l&&(l=e[s]),i?Vn(n,s,l):Wn(n,s,l)}return n}function _i(e,t){return function(n,r){var i=Ga(n)?at:Bn,o=t?t():{};return i(n,e,Yi(r,2),o)}}function wi(e){return Nr((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&so(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),t=me(t);++r<i;){var s=n[r];s&&e(t,s,r,o)}return t}))}function bi(e,t){return function(n,r){if(null==n)return n;if(!Da(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=me(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function xi(e){return function(t,n,r){for(var i=-1,o=me(t),a=r(t),s=a.length;s--;){var l=a[e?s:++i];if(!1===n(o[l],l,o))break}return t}}function Ci(e){return function(t){var n=Rt(t=ss(t))?qt(t):void 0,r=n?n[0]:t.charAt(0),i=n?ui(n,1).join(""):t.slice(1);return r[e]()+i}}function Ti(e){return function(t){return mt(Hs(Ms(t).replace(Me,"")),e,"")}}function Ei(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=On(e.prototype),r=e.apply(n,t);return Wa(r)?r:n}}function Si(e){return function(t,n,r){var i=me(t);if(!Da(t)){var o=Yi(n,3);t=ws(t),n=function(e){return o(i[e],e,i)}}var a=e(t,n,r);return a>-1?i[o?t[a]:a]:void 0}}function ki(e){return Ui((function(t){var n=t.length,r=n,i=In.prototype.thru;for(e&&t.reverse();r--;){var a=t[r];if("function"!=typeof a)throw new ve(o);if(i&&!s&&"wrapper"==Ki(a))var s=new In([],!0)}for(r=s?r:n;++r<n;){var l=Ki(a=t[r]),u="wrapper"==l?Vi(a):void 0;s=u&&uo(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?s[Ki(u[0])].apply(s,u[3]):1==a.length&&uo(a)?s[l]():s.thru(a)}return function(){var e=arguments,r=e[0];if(s&&1==e.length&&Ga(r))return s.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}function Ai(e,t,n,i,o,a,s,l,u,c){var h=128&t,d=1&t,p=2&t,f=24&t,m=512&t,g=p?void 0:Ei(e);return function y(){for(var v=arguments.length,_=r(v),w=v;w--;)_[w]=arguments[w];if(f)var b=Xi(y),x=Dt(_,b);if(i&&(_=mi(_,i,o,f)),a&&(_=gi(_,a,s,f)),v-=x,f&&v<c){var C=zt(_,b);return Di(e,t,Ai,y.placeholder,n,_,C,l,u,c-v)}var T=d?n:this,E=p?T[e]:e;return v=_.length,l?_=yo(_,l):m&&v>1&&_.reverse(),h&&u<v&&(_.length=u),this&&this!==Ve&&this instanceof y&&(E=g||Ei(E)),E.apply(T,_)}}function Oi(e,t){return function(n,r){return function(e,t,n,r){return lr(e,(function(e,i,o){t(r,n(e),i,o)})),r}(n,e,t(r),{})}}function Pi(e,t){return function(n,r){var i;if(void 0===n&&void 0===r)return t;if(void 0!==n&&(i=n),void 0!==r){if(void 0===i)return r;"string"==typeof n||"string"==typeof r?(n=Qr(n),r=Qr(r)):(n=Yr(n),r=Yr(r)),i=e(n,r)}return i}}function Ii(e){return Ui((function(t){return t=pt(t,Pt(Yi())),Nr((function(n){var r=this;return e(t,(function(e){return ot(e,r,n)}))}))}))}function Mi(e,t){var n=(t=void 0===t?" ":Qr(t)).length;if(n<2)return n?Fr(t,e):t;var r=Fr(t,Zt(e/Bt(t)));return Rt(t)?ui(qt(r),0,e).join(""):r.slice(0,e)}function Gi(e){return function(t,n,i){return i&&"number"!=typeof i&&so(t,n,i)&&(n=i=void 0),t=ns(t),void 0===n?(n=t,t=0):n=ns(n),function(e,t,n,i){for(var o=-1,a=an(Zt((t-e)/(n||1)),0),s=r(a);a--;)s[i?a:++o]=e,e+=n;return s}(t,n,i=void 0===i?t<n?1:-1:ns(i),e)}}function Li(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=os(t),n=os(n)),e(t,n)}}function Di(e,t,n,r,i,o,a,s,l,u){var c=8&t;t|=c?32:64,4&(t&=~(c?64:32))||(t&=-4);var h=[e,t,i,c?o:void 0,c?a:void 0,c?void 0:o,c?void 0:a,s,l,u],d=n.apply(void 0,h);return uo(e)&&_o(d,h),d.placeholder=r,xo(d,e,t)}function ji(e){var t=fe[e];return function(e,n){if(e=os(e),(n=null==n?0:sn(rs(n),292))&&nn(e)){var r=(ss(e)+"e").split("e");return+((r=(ss(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Fi=mn&&1/Wt(new mn([,-0]))[1]==1/0?function(e){return new mn(e)}:Qs;function Ni(e){return function(t){var n=no(t);return n==m?Ht(t):n==_?Ut(t):function(e,t){return pt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Ri(e,t,n,i,s,l,u,c){var h=2&t;if(!h&&"function"!=typeof e)throw new ve(o);var d=i?i.length:0;if(d||(t&=-97,i=s=void 0),u=void 0===u?u:an(rs(u),0),c=void 0===c?c:rs(c),d-=s?s.length:0,64&t){var p=i,f=s;i=s=void 0}var m=h?void 0:Vi(e),g=[e,t,n,i,s,p,f,l,u,c];if(m&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,s=128==r&&8==n||128==r&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!s)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var l=t[3];if(l){var u=e[3];e[3]=u?mi(u,l,t[4]):l,e[4]=u?zt(e[3],a):t[4]}(l=t[5])&&(u=e[5],e[5]=u?gi(u,l,t[6]):l,e[6]=u?zt(e[5],a):t[6]);(l=t[7])&&(e[7]=l);128&r&&(e[8]=null==e[8]?t[8]:sn(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=i}(g,m),e=g[0],t=g[1],n=g[2],i=g[3],s=g[4],!(c=g[9]=void 0===g[9]?h?0:e.length:an(g[9]-d,0))&&24&t&&(t&=-25),t&&1!=t)y=8==t||16==t?function(e,t,n){var i=Ei(e);return function o(){for(var a=arguments.length,s=r(a),l=a,u=Xi(o);l--;)s[l]=arguments[l];var c=a<3&&s[0]!==u&&s[a-1]!==u?[]:zt(s,u);if((a-=c.length)<n)return Di(e,t,Ai,o.placeholder,void 0,s,c,void 0,void 0,n-a);var h=this&&this!==Ve&&this instanceof o?i:e;return ot(h,this,s)}}(e,t,c):32!=t&&33!=t||s.length?Ai.apply(void 0,g):function(e,t,n,i){var o=1&t,a=Ei(e);return function t(){for(var s=-1,l=arguments.length,u=-1,c=i.length,h=r(c+l),d=this&&this!==Ve&&this instanceof t?a:e;++u<c;)h[u]=i[u];for(;l--;)h[u++]=arguments[++s];return ot(d,o?n:this,h)}}(e,t,n,i);else var y=function(e,t,n){var r=1&t,i=Ei(e);return function t(){var o=this&&this!==Ve&&this instanceof t?i:e;return o.apply(r?n:this,arguments)}}(e,t,n);return xo((m?zr:_o)(y,g),e,t)}function Hi(e,t,n,r){return void 0===e||Oa(e,be[n])&&!Te.call(r,n)?t:e}function $i(e,t,n,r,i,o){return Wa(e)&&Wa(t)&&(o.set(t,e),Pr(e,t,void 0,$i,o),o.delete(t)),e}function zi(e){return Va(e)?void 0:e}function Wi(e,t,n,r,i,o){var a=1&n,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var u=o.get(e),c=o.get(t);if(u&&c)return u==t&&c==e;var h=-1,d=!0,p=2&n?new jn:void 0;for(o.set(e,t),o.set(t,e);++h<s;){var f=e[h],m=t[h];if(r)var g=a?r(m,f,h,t,e,o):r(f,m,h,e,t,o);if(void 0!==g){if(g)continue;d=!1;break}if(p){if(!yt(t,(function(e,t){if(!Mt(p,t)&&(f===e||i(f,e,n,r,o)))return p.push(t)}))){d=!1;break}}else if(f!==m&&!i(f,m,n,r,o)){d=!1;break}}return o.delete(e),o.delete(t),d}function Ui(e){return bo(mo(e,void 0,Lo),e+"")}function Bi(e){return dr(e,ws,eo)}function qi(e){return dr(e,bs,to)}var Vi=vn?function(e){return vn.get(e)}:Qs;function Ki(e){for(var t=e.name+"",n=_n[t],r=Te.call(_n,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function Xi(e){return(Te.call(An,"placeholder")?An:e).placeholder}function Yi(){var e=An.iteratee||Vs;return e=e===Vs?Cr:e,arguments.length?e(arguments[0],arguments[1]):e}function Qi(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Zi(e){for(var t=ws(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,po(i)]}return t}function Ji(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return xr(n)?n:void 0}var eo=en?function(e){return null==e?[]:(e=me(e),ct(en(e),(function(t){return Ke.call(e,t)})))}:il,to=en?function(e){for(var t=[];e;)ft(t,eo(e)),e=Be(e);return t}:il,no=pr;function ro(e,t,n){for(var r=-1,i=(t=si(t,e)).length,o=!1;++r<i;){var a=So(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&za(i)&&ao(a,i)&&(Ga(e)||Ma(e))}function io(e){return"function"!=typeof e.constructor||ho(e)?{}:On(Be(e))}function oo(e){return Ga(e)||Ma(e)||!!(Qe&&e&&e[Qe])}function ao(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&le.test(e))&&e>-1&&e%1==0&&e<t}function so(e,t,n){if(!Wa(n))return!1;var r=typeof t;return!!("number"==r?Da(n)&&ao(t,n.length):"string"==r&&t in n)&&Oa(n[t],e)}function lo(e,t){if(Ga(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Qa(e))||(U.test(e)||!W.test(e)||null!=t&&e in me(t))}function uo(e){var t=Ki(e),n=An[t];if("function"!=typeof n||!(t in Mn.prototype))return!1;if(e===n)return!0;var r=Vi(n);return!!r&&e===r[0]}(dn&&no(new dn(new ArrayBuffer(1)))!=T||pn&&no(new pn)!=m||fn&&"[object Promise]"!=no(fn.resolve())||mn&&no(new mn)!=_||gn&&no(new gn)!=x)&&(no=function(e){var t=pr(e),n=t==y?e.constructor:void 0,r=n?ko(n):"";if(r)switch(r){case wn:return T;case bn:return m;case xn:return"[object Promise]";case Cn:return _;case Tn:return x}return t});var co=xe?Ha:ol;function ho(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||be)}function po(e){return e==e&&!Wa(e)}function fo(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in me(n)))}}function mo(e,t,n){return t=an(void 0===t?e.length-1:t,0),function(){for(var i=arguments,o=-1,a=an(i.length-t,0),s=r(a);++o<a;)s[o]=i[t+o];o=-1;for(var l=r(t+1);++o<t;)l[o]=i[o];return l[t]=n(s),ot(e,this,l)}}function go(e,t){return t.length<2?e:hr(e,Br(t,0,-1))}function yo(e,t){for(var n=e.length,r=sn(t.length,n),i=yi(e);r--;){var o=t[r];e[r]=ao(o,n)?i[o]:void 0}return e}function vo(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var _o=Co(zr),wo=Qt||function(e,t){return Ve.setTimeout(e,t)},bo=Co(Wr);function xo(e,t,n){var r=t+"";return bo(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(Q,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return st(s,(function(n){var r="_."+n[0];t&n[1]&&!ht(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(Z);return t?t[1].split(J):[]}(r),n)))}function Co(e){var t=0,n=0;return function(){var r=ln(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function To(e,t){var n=-1,r=e.length,i=r-1;for(t=void 0===t?r:t;++n<t;){var o=jr(n,i),a=e[o];e[o]=e[n],e[n]=a}return e.length=t,e}var Eo=function(e){var t=Ca(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(B,(function(e,n,r,i){t.push(r?i.replace(te,"$1"):n||e)})),t}));function So(e){if("string"==typeof e||Qa(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function ko(e){if(null!=e){try{return Ce.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Ao(e){if(e instanceof Mn)return e.clone();var t=new In(e.__wrapped__,e.__chain__);return t.__actions__=yi(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Oo=Nr((function(e,t){return ja(e)?Jn(e,or(t,1,ja,!0)):[]})),Po=Nr((function(e,t){var n=Ro(t);return ja(n)&&(n=void 0),ja(e)?Jn(e,or(t,1,ja,!0),Yi(n,2)):[]})),Io=Nr((function(e,t){var n=Ro(t);return ja(n)&&(n=void 0),ja(e)?Jn(e,or(t,1,ja,!0),void 0,n):[]}));function Mo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:rs(n);return i<0&&(i=an(r+i,0)),wt(e,Yi(t,3),i)}function Go(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=rs(n),i=n<0?an(r+i,0):sn(i,r-1)),wt(e,Yi(t,3),i,!0)}function Lo(e){return(null==e?0:e.length)?or(e,1):[]}function Do(e){return e&&e.length?e[0]:void 0}var jo=Nr((function(e){var t=pt(e,oi);return t.length&&t[0]===e[0]?yr(t):[]})),Fo=Nr((function(e){var t=Ro(e),n=pt(e,oi);return t===Ro(n)?t=void 0:n.pop(),n.length&&n[0]===e[0]?yr(n,Yi(t,2)):[]})),No=Nr((function(e){var t=Ro(e),n=pt(e,oi);return(t="function"==typeof t?t:void 0)&&n.pop(),n.length&&n[0]===e[0]?yr(n,void 0,t):[]}));function Ro(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var Ho=Nr($o);function $o(e,t){return e&&e.length&&t&&t.length?Lr(e,t):e}var zo=Ui((function(e,t){var n=null==e?0:e.length,r=Kn(e,t);return Dr(e,pt(t,(function(e){return ao(e,n)?+e:e})).sort(fi)),r}));function Wo(e){return null==e?e:hn.call(e)}var Uo=Nr((function(e){return Zr(or(e,1,ja,!0))})),Bo=Nr((function(e){var t=Ro(e);return ja(t)&&(t=void 0),Zr(or(e,1,ja,!0),Yi(t,2))})),qo=Nr((function(e){var t=Ro(e);return t="function"==typeof t?t:void 0,Zr(or(e,1,ja,!0),void 0,t)}));function Vo(e){if(!e||!e.length)return[];var t=0;return e=ct(e,(function(e){if(ja(e))return t=an(e.length,t),!0})),Ot(t,(function(t){return pt(e,Et(t))}))}function Ko(e,t){if(!e||!e.length)return[];var n=Vo(e);return null==t?n:pt(n,(function(e){return ot(t,void 0,e)}))}var Xo=Nr((function(e,t){return ja(e)?Jn(e,t):[]})),Yo=Nr((function(e){return ri(ct(e,ja))})),Qo=Nr((function(e){var t=Ro(e);return ja(t)&&(t=void 0),ri(ct(e,ja),Yi(t,2))})),Zo=Nr((function(e){var t=Ro(e);return t="function"==typeof t?t:void 0,ri(ct(e,ja),void 0,t)})),Jo=Nr(Vo);var ea=Nr((function(e){var t=e.length,n=t>1?e[t-1]:void 0;return n="function"==typeof n?(e.pop(),n):void 0,Ko(e,n)}));function ta(e){var t=An(e);return t.__chain__=!0,t}function na(e,t){return t(e)}var ra=Ui((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return Kn(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Mn&&ao(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:na,args:[i],thisArg:void 0}),new In(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(void 0),e}))):this.thru(i)}));var ia=_i((function(e,t,n){Te.call(e,n)?++e[n]:Vn(e,n,1)}));var oa=Si(Mo),aa=Si(Go);function sa(e,t){return(Ga(e)?st:er)(e,Yi(t,3))}function la(e,t){return(Ga(e)?lt:tr)(e,Yi(t,3))}var ua=_i((function(e,t,n){Te.call(e,n)?e[n].push(t):Vn(e,n,[t])}));var ca=Nr((function(e,t,n){var i=-1,o="function"==typeof t,a=Da(e)?r(e.length):[];return er(e,(function(e){a[++i]=o?ot(t,e,n):vr(e,t,n)})),a})),ha=_i((function(e,t,n){Vn(e,n,t)}));function da(e,t){return(Ga(e)?pt:kr)(e,Yi(t,3))}var pa=_i((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var fa=Nr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&so(e,t[0],t[1])?t=[]:n>2&&so(t[0],t[1],t[2])&&(t=[t[0]]),Mr(e,or(t,1),[])})),ma=Yt||function(){return Ve.Date.now()};function ga(e,t,n){return t=n?void 0:t,Ri(e,128,void 0,void 0,void 0,void 0,t=e&&null==t?e.length:t)}function ya(e,t){var n;if("function"!=typeof t)throw new ve(o);return e=rs(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}var va=Nr((function(e,t,n){var r=1;if(n.length){var i=zt(n,Xi(va));r|=32}return Ri(e,r,t,n,i)})),_a=Nr((function(e,t,n){var r=3;if(n.length){var i=zt(n,Xi(_a));r|=32}return Ri(t,r,e,n,i)}));function wa(e,t,n){var r,i,a,s,l,u,c=0,h=!1,d=!1,p=!0;if("function"!=typeof e)throw new ve(o);function f(t){var n=r,o=i;return r=i=void 0,c=t,s=e.apply(o,n)}function m(e){return c=e,l=wo(y,t),h?f(e):s}function g(e){var n=e-u;return void 0===u||n>=t||n<0||d&&e-c>=a}function y(){var e=ma();if(g(e))return v(e);l=wo(y,function(e){var n=t-(e-u);return d?sn(n,a-(e-c)):n}(e))}function v(e){return l=void 0,p&&r?f(e):(r=i=void 0,s)}function _(){var e=ma(),n=g(e);if(r=arguments,i=this,u=e,n){if(void 0===l)return m(u);if(d)return ci(l),l=wo(y,t),f(u)}return void 0===l&&(l=wo(y,t)),s}return t=os(t)||0,Wa(n)&&(h=!!n.leading,a=(d="maxWait"in n)?an(os(n.maxWait)||0,t):a,p="trailing"in n?!!n.trailing:p),_.cancel=function(){void 0!==l&&ci(l),c=0,r=u=i=l=void 0},_.flush=function(){return void 0===l?s:v(ma())},_}var ba=Nr((function(e,t){return Zn(e,1,t)})),xa=Nr((function(e,t,n){return Zn(e,os(t)||0,n)}));function Ca(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new ve(o);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Ca.Cache||Dn),n}function Ta(e){if("function"!=typeof e)throw new ve(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ca.Cache=Dn;var Ea=li((function(e,t){var n=(t=1==t.length&&Ga(t[0])?pt(t[0],Pt(Yi())):pt(or(t,1),Pt(Yi()))).length;return Nr((function(r){for(var i=-1,o=sn(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return ot(e,this,r)}))})),Sa=Nr((function(e,t){return Ri(e,32,void 0,t,zt(t,Xi(Sa)))})),ka=Nr((function(e,t){return Ri(e,64,void 0,t,zt(t,Xi(ka)))})),Aa=Ui((function(e,t){return Ri(e,256,void 0,void 0,void 0,t)}));function Oa(e,t){return e===t||e!=e&&t!=t}var Pa=Li(fr),Ia=Li((function(e,t){return e>=t})),Ma=_r(function(){return arguments}())?_r:function(e){return Ua(e)&&Te.call(e,"callee")&&!Ke.call(e,"callee")},Ga=r.isArray,La=Je?Pt(Je):function(e){return Ua(e)&&pr(e)==C};function Da(e){return null!=e&&za(e.length)&&!Ha(e)}function ja(e){return Ua(e)&&Da(e)}var Fa=tn||ol,Na=et?Pt(et):function(e){return Ua(e)&&pr(e)==h};function Ra(e){if(!Ua(e))return!1;var t=pr(e);return t==d||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!Va(e)}function Ha(e){if(!Wa(e))return!1;var t=pr(e);return t==p||t==f||"[object AsyncFunction]"==t||"[object Proxy]"==t}function $a(e){return"number"==typeof e&&e==rs(e)}function za(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Wa(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ua(e){return null!=e&&"object"==typeof e}var Ba=tt?Pt(tt):function(e){return Ua(e)&&no(e)==m};function qa(e){return"number"==typeof e||Ua(e)&&pr(e)==g}function Va(e){if(!Ua(e)||pr(e)!=y)return!1;var t=Be(e);if(null===t)return!0;var n=Te.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Ce.call(n)==Ae}var Ka=nt?Pt(nt):function(e){return Ua(e)&&pr(e)==v};var Xa=rt?Pt(rt):function(e){return Ua(e)&&no(e)==_};function Ya(e){return"string"==typeof e||!Ga(e)&&Ua(e)&&pr(e)==w}function Qa(e){return"symbol"==typeof e||Ua(e)&&pr(e)==b}var Za=it?Pt(it):function(e){return Ua(e)&&za(e.length)&&!!He[pr(e)]};var Ja=Li(Sr),es=Li((function(e,t){return e<=t}));function ts(e){if(!e)return[];if(Da(e))return Ya(e)?qt(e):yi(e);if(Ze&&e[Ze])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Ze]());var t=no(e);return(t==m?Ht:t==_?Wt:Os)(e)}function ns(e){return e?(e=os(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function rs(e){var t=ns(e),n=t%1;return t==t?n?t-n:t:0}function is(e){return e?Xn(rs(e),0,4294967295):0}function os(e){if("number"==typeof e)return e;if(Qa(e))return NaN;if(Wa(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Wa(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(K,"");var n=oe.test(e);return n||se.test(e)?Ue(e.slice(2),n?2:8):ie.test(e)?NaN:+e}function as(e){return vi(e,bs(e))}function ss(e){return null==e?"":Qr(e)}var ls=wi((function(e,t){if(ho(t)||Da(t))vi(t,ws(t),e);else for(var n in t)Te.call(t,n)&&Wn(e,n,t[n])})),us=wi((function(e,t){vi(t,bs(t),e)})),cs=wi((function(e,t,n,r){vi(t,bs(t),e,r)})),hs=wi((function(e,t,n,r){vi(t,ws(t),e,r)})),ds=Ui(Kn);var ps=Nr((function(e,t){e=me(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&so(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],a=bs(o),s=-1,l=a.length;++s<l;){var u=a[s],c=e[u];(void 0===c||Oa(c,be[u])&&!Te.call(e,u))&&(e[u]=o[u])}return e})),fs=Nr((function(e){return e.push(void 0,$i),ot(Cs,void 0,e)}));function ms(e,t,n){var r=null==e?void 0:hr(e,t);return void 0===r?n:r}function gs(e,t){return null!=e&&ro(e,t,gr)}var ys=Oi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=ke.call(t)),e[t]=n}),Ws(qs)),vs=Oi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=ke.call(t)),Te.call(e,t)?e[t].push(n):e[t]=[n]}),Yi),_s=Nr(vr);function ws(e){return Da(e)?Nn(e):Tr(e)}function bs(e){return Da(e)?Nn(e,!0):Er(e)}var xs=wi((function(e,t,n){Pr(e,t,n)})),Cs=wi((function(e,t,n,r){Pr(e,t,n,r)})),Ts=Ui((function(e,t){var n={};if(null==e)return n;var r=!1;t=pt(t,(function(t){return t=si(t,e),r||(r=t.length>1),t})),vi(e,qi(e),n),r&&(n=Yn(n,7,zi));for(var i=t.length;i--;)Jr(n,t[i]);return n}));var Es=Ui((function(e,t){return null==e?{}:function(e,t){return Gr(e,t,(function(t,n){return gs(e,n)}))}(e,t)}));function Ss(e,t){if(null==e)return{};var n=pt(qi(e),(function(e){return[e]}));return t=Yi(t),Gr(e,n,(function(e,n){return t(e,n[0])}))}var ks=Ni(ws),As=Ni(bs);function Os(e){return null==e?[]:It(e,ws(e))}var Ps=Ti((function(e,t,n){return t=t.toLowerCase(),e+(n?Is(t):t)}));function Is(e){return Rs(ss(e).toLowerCase())}function Ms(e){return(e=ss(e))&&e.replace(ue,jt).replace(Ge,"")}var Gs=Ti((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Ls=Ti((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Ds=Ci("toLowerCase");var js=Ti((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var Fs=Ti((function(e,t,n){return e+(n?" ":"")+Rs(t)}));var Ns=Ti((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Rs=Ci("toUpperCase");function Hs(e,t,n){return e=ss(e),void 0===(t=n?void 0:t)?function(e){return Fe.test(e)}(e)?function(e){return e.match(De)||[]}(e):function(e){return e.match(ee)||[]}(e):e.match(t)||[]}var $s=Nr((function(e,t){try{return ot(e,void 0,t)}catch(e){return Ra(e)?e:new de(e)}})),zs=Ui((function(e,t){return st(t,(function(t){t=So(t),Vn(e,t,va(e[t],e))})),e}));function Ws(e){return function(){return e}}var Us=ki(),Bs=ki(!0);function qs(e){return e}function Vs(e){return Cr("function"==typeof e?e:Yn(e,1))}var Ks=Nr((function(e,t){return function(n){return vr(n,e,t)}})),Xs=Nr((function(e,t){return function(n){return vr(e,n,t)}}));function Ys(e,t,n){var r=ws(t),i=cr(t,r);null!=n||Wa(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=cr(t,ws(t)));var o=!(Wa(n)&&"chain"in n&&!n.chain),a=Ha(e);return st(i,(function(n){var r=t[n];e[n]=r,a&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__),i=n.__actions__=yi(this.__actions__);return i.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,ft([this.value()],arguments))})})),e}function Qs(){}var Zs=Ii(pt),Js=Ii(ut),el=Ii(yt);function tl(e){return lo(e)?Et(So(e)):function(e){return function(t){return hr(t,e)}}(e)}var nl=Gi(),rl=Gi(!0);function il(){return[]}function ol(){return!1}var al=Pi((function(e,t){return e+t}),0),sl=ji("ceil"),ll=Pi((function(e,t){return e/t}),1),ul=ji("floor");var cl,hl=Pi((function(e,t){return e*t}),1),dl=ji("round"),pl=Pi((function(e,t){return e-t}),0);return An.after=function(e,t){if("function"!=typeof t)throw new ve(o);return e=rs(e),function(){if(--e<1)return t.apply(this,arguments)}},An.ary=ga,An.assign=ls,An.assignIn=us,An.assignInWith=cs,An.assignWith=hs,An.at=ds,An.before=ya,An.bind=va,An.bindAll=zs,An.bindKey=_a,An.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Ga(e)?e:[e]},An.chain=ta,An.chunk=function(e,t,n){t=(n?so(e,t,n):void 0===t)?1:an(rs(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var o=0,a=0,s=r(Zt(i/t));o<i;)s[a++]=Br(e,o,o+=t);return s},An.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},An.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return ft(Ga(n)?yi(n):[n],or(t,1))},An.cond=function(e){var t=null==e?0:e.length,n=Yi();return e=t?pt(e,(function(e){if("function"!=typeof e[1])throw new ve(o);return[n(e[0]),e[1]]})):[],Nr((function(n){for(var r=-1;++r<t;){var i=e[r];if(ot(i[0],this,n))return ot(i[1],this,n)}}))},An.conforms=function(e){return function(e){var t=ws(e);return function(n){return Qn(n,e,t)}}(Yn(e,1))},An.constant=Ws,An.countBy=ia,An.create=function(e,t){var n=On(e);return null==t?n:qn(n,t)},An.curry=function e(t,n,r){var i=Ri(t,8,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return i.placeholder=e.placeholder,i},An.curryRight=function e(t,n,r){var i=Ri(t,16,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return i.placeholder=e.placeholder,i},An.debounce=wa,An.defaults=ps,An.defaultsDeep=fs,An.defer=ba,An.delay=xa,An.difference=Oo,An.differenceBy=Po,An.differenceWith=Io,An.drop=function(e,t,n){var r=null==e?0:e.length;return r?Br(e,(t=n||void 0===t?1:rs(t))<0?0:t,r):[]},An.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?Br(e,0,(t=r-(t=n||void 0===t?1:rs(t)))<0?0:t):[]},An.dropRightWhile=function(e,t){return e&&e.length?ti(e,Yi(t,3),!0,!0):[]},An.dropWhile=function(e,t){return e&&e.length?ti(e,Yi(t,3),!0):[]},An.fill=function(e,t,n,r){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&so(e,t,n)&&(n=0,r=i),function(e,t,n,r){var i=e.length;for((n=rs(n))<0&&(n=-n>i?0:i+n),(r=void 0===r||r>i?i:rs(r))<0&&(r+=i),r=n>r?0:is(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},An.filter=function(e,t){return(Ga(e)?ct:ir)(e,Yi(t,3))},An.flatMap=function(e,t){return or(da(e,t),1)},An.flatMapDeep=function(e,t){return or(da(e,t),1/0)},An.flatMapDepth=function(e,t,n){return n=void 0===n?1:rs(n),or(da(e,t),n)},An.flatten=Lo,An.flattenDeep=function(e){return(null==e?0:e.length)?or(e,1/0):[]},An.flattenDepth=function(e,t){return(null==e?0:e.length)?or(e,t=void 0===t?1:rs(t)):[]},An.flip=function(e){return Ri(e,512)},An.flow=Us,An.flowRight=Bs,An.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},An.functions=function(e){return null==e?[]:cr(e,ws(e))},An.functionsIn=function(e){return null==e?[]:cr(e,bs(e))},An.groupBy=ua,An.initial=function(e){return(null==e?0:e.length)?Br(e,0,-1):[]},An.intersection=jo,An.intersectionBy=Fo,An.intersectionWith=No,An.invert=ys,An.invertBy=vs,An.invokeMap=ca,An.iteratee=Vs,An.keyBy=ha,An.keys=ws,An.keysIn=bs,An.map=da,An.mapKeys=function(e,t){var n={};return t=Yi(t,3),lr(e,(function(e,r,i){Vn(n,t(e,r,i),e)})),n},An.mapValues=function(e,t){var n={};return t=Yi(t,3),lr(e,(function(e,r,i){Vn(n,r,t(e,r,i))})),n},An.matches=function(e){return Ar(Yn(e,1))},An.matchesProperty=function(e,t){return Or(e,Yn(t,1))},An.memoize=Ca,An.merge=xs,An.mergeWith=Cs,An.method=Ks,An.methodOf=Xs,An.mixin=Ys,An.negate=Ta,An.nthArg=function(e){return e=rs(e),Nr((function(t){return Ir(t,e)}))},An.omit=Ts,An.omitBy=function(e,t){return Ss(e,Ta(Yi(t)))},An.once=function(e){return ya(2,e)},An.orderBy=function(e,t,n,r){return null==e?[]:(Ga(t)||(t=null==t?[]:[t]),Ga(n=r?void 0:n)||(n=null==n?[]:[n]),Mr(e,t,n))},An.over=Zs,An.overArgs=Ea,An.overEvery=Js,An.overSome=el,An.partial=Sa,An.partialRight=ka,An.partition=pa,An.pick=Es,An.pickBy=Ss,An.property=tl,An.propertyOf=function(e){return function(t){return null==e?void 0:hr(e,t)}},An.pull=Ho,An.pullAll=$o,An.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Lr(e,t,Yi(n,2)):e},An.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Lr(e,t,void 0,n):e},An.pullAt=zo,An.range=nl,An.rangeRight=rl,An.rearg=Aa,An.reject=function(e,t){return(Ga(e)?ct:ir)(e,Ta(Yi(t,3)))},An.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=Yi(t,3);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return Dr(e,i),n},An.rest=function(e,t){if("function"!=typeof e)throw new ve(o);return Nr(e,t=void 0===t?t:rs(t))},An.reverse=Wo,An.sampleSize=function(e,t,n){return t=(n?so(e,t,n):void 0===t)?1:rs(t),(Ga(e)?Hn:Hr)(e,t)},An.set=function(e,t,n){return null==e?e:$r(e,t,n)},An.setWith=function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:$r(e,t,n,r)},An.shuffle=function(e){return(Ga(e)?$n:Ur)(e)},An.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&so(e,t,n)?(t=0,n=r):(t=null==t?0:rs(t),n=void 0===n?r:rs(n)),Br(e,t,n)):[]},An.sortBy=fa,An.sortedUniq=function(e){return e&&e.length?Xr(e):[]},An.sortedUniqBy=function(e,t){return e&&e.length?Xr(e,Yi(t,2)):[]},An.split=function(e,t,n){return n&&"number"!=typeof n&&so(e,t,n)&&(t=n=void 0),(n=void 0===n?4294967295:n>>>0)?(e=ss(e))&&("string"==typeof t||null!=t&&!Ka(t))&&!(t=Qr(t))&&Rt(e)?ui(qt(e),0,n):e.split(t,n):[]},An.spread=function(e,t){if("function"!=typeof e)throw new ve(o);return t=null==t?0:an(rs(t),0),Nr((function(n){var r=n[t],i=ui(n,0,t);return r&&ft(i,r),ot(e,this,i)}))},An.tail=function(e){var t=null==e?0:e.length;return t?Br(e,1,t):[]},An.take=function(e,t,n){return e&&e.length?Br(e,0,(t=n||void 0===t?1:rs(t))<0?0:t):[]},An.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?Br(e,(t=r-(t=n||void 0===t?1:rs(t)))<0?0:t,r):[]},An.takeRightWhile=function(e,t){return e&&e.length?ti(e,Yi(t,3),!1,!0):[]},An.takeWhile=function(e,t){return e&&e.length?ti(e,Yi(t,3)):[]},An.tap=function(e,t){return t(e),e},An.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new ve(o);return Wa(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),wa(e,t,{leading:r,maxWait:t,trailing:i})},An.thru=na,An.toArray=ts,An.toPairs=ks,An.toPairsIn=As,An.toPath=function(e){return Ga(e)?pt(e,So):Qa(e)?[e]:yi(Eo(ss(e)))},An.toPlainObject=as,An.transform=function(e,t,n){var r=Ga(e),i=r||Fa(e)||Za(e);if(t=Yi(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:Wa(e)&&Ha(o)?On(Be(e)):{}}return(i?st:lr)(e,(function(e,r,i){return t(n,e,r,i)})),n},An.unary=function(e){return ga(e,1)},An.union=Uo,An.unionBy=Bo,An.unionWith=qo,An.uniq=function(e){return e&&e.length?Zr(e):[]},An.uniqBy=function(e,t){return e&&e.length?Zr(e,Yi(t,2)):[]},An.uniqWith=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?Zr(e,void 0,t):[]},An.unset=function(e,t){return null==e||Jr(e,t)},An.unzip=Vo,An.unzipWith=Ko,An.update=function(e,t,n){return null==e?e:ei(e,t,ai(n))},An.updateWith=function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:ei(e,t,ai(n),r)},An.values=Os,An.valuesIn=function(e){return null==e?[]:It(e,bs(e))},An.without=Xo,An.words=Hs,An.wrap=function(e,t){return Sa(ai(t),e)},An.xor=Yo,An.xorBy=Qo,An.xorWith=Zo,An.zip=Jo,An.zipObject=function(e,t){return ii(e||[],t||[],Wn)},An.zipObjectDeep=function(e,t){return ii(e||[],t||[],$r)},An.zipWith=ea,An.entries=ks,An.entriesIn=As,An.extend=us,An.extendWith=cs,Ys(An,An),An.add=al,An.attempt=$s,An.camelCase=Ps,An.capitalize=Is,An.ceil=sl,An.clamp=function(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=os(n))==n?n:0),void 0!==t&&(t=(t=os(t))==t?t:0),Xn(os(e),t,n)},An.clone=function(e){return Yn(e,4)},An.cloneDeep=function(e){return Yn(e,5)},An.cloneDeepWith=function(e,t){return Yn(e,5,t="function"==typeof t?t:void 0)},An.cloneWith=function(e,t){return Yn(e,4,t="function"==typeof t?t:void 0)},An.conformsTo=function(e,t){return null==t||Qn(e,t,ws(t))},An.deburr=Ms,An.defaultTo=function(e,t){return null==e||e!=e?t:e},An.divide=ll,An.endsWith=function(e,t,n){e=ss(e),t=Qr(t);var r=e.length,i=n=void 0===n?r:Xn(rs(n),0,r);return(n-=t.length)>=0&&e.slice(n,i)==t},An.eq=Oa,An.escape=function(e){return(e=ss(e))&&R.test(e)?e.replace(F,Ft):e},An.escapeRegExp=function(e){return(e=ss(e))&&V.test(e)?e.replace(q,"\\$&"):e},An.every=function(e,t,n){var r=Ga(e)?ut:nr;return n&&so(e,t,n)&&(t=void 0),r(e,Yi(t,3))},An.find=oa,An.findIndex=Mo,An.findKey=function(e,t){return _t(e,Yi(t,3),lr)},An.findLast=aa,An.findLastIndex=Go,An.findLastKey=function(e,t){return _t(e,Yi(t,3),ur)},An.floor=ul,An.forEach=sa,An.forEachRight=la,An.forIn=function(e,t){return null==e?e:ar(e,Yi(t,3),bs)},An.forInRight=function(e,t){return null==e?e:sr(e,Yi(t,3),bs)},An.forOwn=function(e,t){return e&&lr(e,Yi(t,3))},An.forOwnRight=function(e,t){return e&&ur(e,Yi(t,3))},An.get=ms,An.gt=Pa,An.gte=Ia,An.has=function(e,t){return null!=e&&ro(e,t,mr)},An.hasIn=gs,An.head=Do,An.identity=qs,An.includes=function(e,t,n,r){e=Da(e)?e:Os(e),n=n&&!r?rs(n):0;var i=e.length;return n<0&&(n=an(i+n,0)),Ya(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&bt(e,t,n)>-1},An.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:rs(n);return i<0&&(i=an(r+i,0)),bt(e,t,i)},An.inRange=function(e,t,n){return t=ns(t),void 0===n?(n=t,t=0):n=ns(n),function(e,t,n){return e>=sn(t,n)&&e<an(t,n)}(e=os(e),t,n)},An.invoke=_s,An.isArguments=Ma,An.isArray=Ga,An.isArrayBuffer=La,An.isArrayLike=Da,An.isArrayLikeObject=ja,An.isBoolean=function(e){return!0===e||!1===e||Ua(e)&&pr(e)==c},An.isBuffer=Fa,An.isDate=Na,An.isElement=function(e){return Ua(e)&&1===e.nodeType&&!Va(e)},An.isEmpty=function(e){if(null==e)return!0;if(Da(e)&&(Ga(e)||"string"==typeof e||"function"==typeof e.splice||Fa(e)||Za(e)||Ma(e)))return!e.length;var t=no(e);if(t==m||t==_)return!e.size;if(ho(e))return!Tr(e).length;for(var n in e)if(Te.call(e,n))return!1;return!0},An.isEqual=function(e,t){return wr(e,t)},An.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===r?wr(e,t,void 0,n):!!r},An.isError=Ra,An.isFinite=function(e){return"number"==typeof e&&nn(e)},An.isFunction=Ha,An.isInteger=$a,An.isLength=za,An.isMap=Ba,An.isMatch=function(e,t){return e===t||br(e,t,Zi(t))},An.isMatchWith=function(e,t,n){return n="function"==typeof n?n:void 0,br(e,t,Zi(t),n)},An.isNaN=function(e){return qa(e)&&e!=+e},An.isNative=function(e){if(co(e))throw new de("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return xr(e)},An.isNil=function(e){return null==e},An.isNull=function(e){return null===e},An.isNumber=qa,An.isObject=Wa,An.isObjectLike=Ua,An.isPlainObject=Va,An.isRegExp=Ka,An.isSafeInteger=function(e){return $a(e)&&e>=-9007199254740991&&e<=9007199254740991},An.isSet=Xa,An.isString=Ya,An.isSymbol=Qa,An.isTypedArray=Za,An.isUndefined=function(e){return void 0===e},An.isWeakMap=function(e){return Ua(e)&&no(e)==x},An.isWeakSet=function(e){return Ua(e)&&"[object WeakSet]"==pr(e)},An.join=function(e,t){return null==e?"":rn.call(e,t)},An.kebabCase=Gs,An.last=Ro,An.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;return void 0!==n&&(i=(i=rs(n))<0?an(r+i,0):sn(i,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,i):wt(e,Ct,i,!0)},An.lowerCase=Ls,An.lowerFirst=Ds,An.lt=Ja,An.lte=es,An.max=function(e){return e&&e.length?rr(e,qs,fr):void 0},An.maxBy=function(e,t){return e&&e.length?rr(e,Yi(t,2),fr):void 0},An.mean=function(e){return Tt(e,qs)},An.meanBy=function(e,t){return Tt(e,Yi(t,2))},An.min=function(e){return e&&e.length?rr(e,qs,Sr):void 0},An.minBy=function(e,t){return e&&e.length?rr(e,Yi(t,2),Sr):void 0},An.stubArray=il,An.stubFalse=ol,An.stubObject=function(){return{}},An.stubString=function(){return""},An.stubTrue=function(){return!0},An.multiply=hl,An.nth=function(e,t){return e&&e.length?Ir(e,rs(t)):void 0},An.noConflict=function(){return Ve._===this&&(Ve._=Oe),this},An.noop=Qs,An.now=ma,An.pad=function(e,t,n){e=ss(e);var r=(t=rs(t))?Bt(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Mi(Jt(i),n)+e+Mi(Zt(i),n)},An.padEnd=function(e,t,n){e=ss(e);var r=(t=rs(t))?Bt(e):0;return t&&r<t?e+Mi(t-r,n):e},An.padStart=function(e,t,n){e=ss(e);var r=(t=rs(t))?Bt(e):0;return t&&r<t?Mi(t-r,n)+e:e},An.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),un(ss(e).replace(X,""),t||0)},An.random=function(e,t,n){if(n&&"boolean"!=typeof n&&so(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=ns(e),void 0===t?(t=e,e=0):t=ns(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=cn();return sn(e+i*(t-e+We("1e-"+((i+"").length-1))),t)}return jr(e,t)},An.reduce=function(e,t,n){var r=Ga(e)?mt:kt,i=arguments.length<3;return r(e,Yi(t,4),n,i,er)},An.reduceRight=function(e,t,n){var r=Ga(e)?gt:kt,i=arguments.length<3;return r(e,Yi(t,4),n,i,tr)},An.repeat=function(e,t,n){return t=(n?so(e,t,n):void 0===t)?1:rs(t),Fr(ss(e),t)},An.replace=function(){var e=arguments,t=ss(e[0]);return e.length<3?t:t.replace(e[1],e[2])},An.result=function(e,t,n){var r=-1,i=(t=si(t,e)).length;for(i||(i=1,e=void 0);++r<i;){var o=null==e?void 0:e[So(t[r])];void 0===o&&(r=i,o=n),e=Ha(o)?o.call(e):o}return e},An.round=dl,An.runInContext=e,An.sample=function(e){return(Ga(e)?Rn:Rr)(e)},An.size=function(e){if(null==e)return 0;if(Da(e))return Ya(e)?Bt(e):e.length;var t=no(e);return t==m||t==_?e.size:Tr(e).length},An.snakeCase=js,An.some=function(e,t,n){var r=Ga(e)?yt:qr;return n&&so(e,t,n)&&(t=void 0),r(e,Yi(t,3))},An.sortedIndex=function(e,t){return Vr(e,t)},An.sortedIndexBy=function(e,t,n){return Kr(e,t,Yi(n,2))},An.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=Vr(e,t);if(r<n&&Oa(e[r],t))return r}return-1},An.sortedLastIndex=function(e,t){return Vr(e,t,!0)},An.sortedLastIndexBy=function(e,t,n){return Kr(e,t,Yi(n,2),!0)},An.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=Vr(e,t,!0)-1;if(Oa(e[n],t))return n}return-1},An.startCase=Fs,An.startsWith=function(e,t,n){return e=ss(e),n=null==n?0:Xn(rs(n),0,e.length),t=Qr(t),e.slice(n,n+t.length)==t},An.subtract=pl,An.sum=function(e){return e&&e.length?At(e,qs):0},An.sumBy=function(e,t){return e&&e.length?At(e,Yi(t,2)):0},An.template=function(e,t,n){var r=An.templateSettings;n&&so(e,t,n)&&(t=void 0),e=ss(e),t=cs({},t,r,Hi);var i,o,a=cs({},t.imports,r.imports,Hi),s=ws(a),l=It(a,s),u=0,c=t.interpolate||ce,h="__p += '",d=ge((t.escape||ce).source+"|"+c.source+"|"+(c===z?ne:ce).source+"|"+(t.evaluate||ce).source+"|$","g"),p="//# sourceURL="+(Te.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Re+"]")+"\n";e.replace(d,(function(t,n,r,a,s,l){return r||(r=a),h+=e.slice(u,l).replace(he,Nt),n&&(i=!0,h+="' +\n__e("+n+") +\n'"),s&&(o=!0,h+="';\n"+s+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=l+t.length,t})),h+="';\n";var f=Te.call(t,"variable")&&t.variable;f||(h="with (obj) {\n"+h+"\n}\n"),h=(o?h.replace(G,""):h).replace(L,"$1").replace(D,"$1;"),h="function("+(f||"obj")+") {\n"+(f?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var m=$s((function(){return pe(s,p+"return "+h).apply(void 0,l)}));if(m.source=h,Ra(m))throw m;return m},An.times=function(e,t){if((e=rs(e))<1||e>9007199254740991)return[];var n=4294967295,r=sn(e,4294967295);e-=4294967295;for(var i=Ot(r,t=Yi(t));++n<e;)t(n);return i},An.toFinite=ns,An.toInteger=rs,An.toLength=is,An.toLower=function(e){return ss(e).toLowerCase()},An.toNumber=os,An.toSafeInteger=function(e){return e?Xn(rs(e),-9007199254740991,9007199254740991):0===e?e:0},An.toString=ss,An.toUpper=function(e){return ss(e).toUpperCase()},An.trim=function(e,t,n){if((e=ss(e))&&(n||void 0===t))return e.replace(K,"");if(!e||!(t=Qr(t)))return e;var r=qt(e),i=qt(t);return ui(r,Gt(r,i),Lt(r,i)+1).join("")},An.trimEnd=function(e,t,n){if((e=ss(e))&&(n||void 0===t))return e.replace(Y,"");if(!e||!(t=Qr(t)))return e;var r=qt(e);return ui(r,0,Lt(r,qt(t))+1).join("")},An.trimStart=function(e,t,n){if((e=ss(e))&&(n||void 0===t))return e.replace(X,"");if(!e||!(t=Qr(t)))return e;var r=qt(e);return ui(r,Gt(r,qt(t))).join("")},An.truncate=function(e,t){var n=30,r="...";if(Wa(t)){var i="separator"in t?t.separator:i;n="length"in t?rs(t.length):n,r="omission"in t?Qr(t.omission):r}var o=(e=ss(e)).length;if(Rt(e)){var a=qt(e);o=a.length}if(n>=o)return e;var s=n-Bt(r);if(s<1)return r;var l=a?ui(a,0,s).join(""):e.slice(0,s);if(void 0===i)return l+r;if(a&&(s+=l.length-s),Ka(i)){if(e.slice(s).search(i)){var u,c=l;for(i.global||(i=ge(i.source,ss(re.exec(i))+"g")),i.lastIndex=0;u=i.exec(c);)var h=u.index;l=l.slice(0,void 0===h?s:h)}}else if(e.indexOf(Qr(i),s)!=s){var d=l.lastIndexOf(i);d>-1&&(l=l.slice(0,d))}return l+r},An.unescape=function(e){return(e=ss(e))&&N.test(e)?e.replace(j,Vt):e},An.uniqueId=function(e){var t=++Ee;return ss(e)+t},An.upperCase=Ns,An.upperFirst=Rs,An.each=sa,An.eachRight=la,An.first=Do,Ys(An,(cl={},lr(An,(function(e,t){Te.call(An.prototype,t)||(cl[t]=e)})),cl),{chain:!1}),An.VERSION="4.17.20",st(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){An[e].placeholder=An})),st(["drop","take"],(function(e,t){Mn.prototype[e]=function(n){n=void 0===n?1:an(rs(n),0);var r=this.__filtered__&&!t?new Mn(this):this.clone();return r.__filtered__?r.__takeCount__=sn(n,r.__takeCount__):r.__views__.push({size:sn(n,4294967295),type:e+(r.__dir__<0?"Right":"")}),r},Mn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),st(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Mn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Yi(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),st(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Mn.prototype[e]=function(){return this[n](1).value()[0]}})),st(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Mn.prototype[e]=function(){return this.__filtered__?new Mn(this):this[n](1)}})),Mn.prototype.compact=function(){return this.filter(qs)},Mn.prototype.find=function(e){return this.filter(e).head()},Mn.prototype.findLast=function(e){return this.reverse().find(e)},Mn.prototype.invokeMap=Nr((function(e,t){return"function"==typeof e?new Mn(this):this.map((function(n){return vr(n,e,t)}))})),Mn.prototype.reject=function(e){return this.filter(Ta(Yi(e)))},Mn.prototype.slice=function(e,t){e=rs(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Mn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),void 0!==t&&(n=(t=rs(t))<0?n.dropRight(-t):n.take(t-e)),n)},Mn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Mn.prototype.toArray=function(){return this.take(4294967295)},lr(Mn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=An[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);i&&(An.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,s=t instanceof Mn,l=a[0],u=s||Ga(t),c=function(e){var t=i.apply(An,ft([e],a));return r&&h?t[0]:t};u&&n&&"function"==typeof l&&1!=l.length&&(s=u=!1);var h=this.__chain__,d=!!this.__actions__.length,p=o&&!h,f=s&&!d;if(!o&&u){t=f?t:new Mn(this);var m=e.apply(t,a);return m.__actions__.push({func:na,args:[c],thisArg:void 0}),new In(m,h)}return p&&f?e.apply(this,a):(m=this.thru(c),p?r?m.value()[0]:m.value():m)})})),st(["pop","push","shift","sort","splice","unshift"],(function(e){var t=_e[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);An.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(Ga(i)?i:[],e)}return this[n]((function(n){return t.apply(Ga(n)?n:[],e)}))}})),lr(Mn.prototype,(function(e,t){var n=An[t];if(n){var r=n.name+"";Te.call(_n,r)||(_n[r]=[]),_n[r].push({name:t,func:n})}})),_n[Ai(void 0,2).name]=[{name:"wrapper",func:void 0}],Mn.prototype.clone=function(){var e=new Mn(this.__wrapped__);return e.__actions__=yi(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=yi(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=yi(this.__views__),e},Mn.prototype.reverse=function(){if(this.__filtered__){var e=new Mn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Mn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Ga(e),r=t<0,i=n?e.length:0,o=function(e,t,n){var r=-1,i=n.length;for(;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=sn(t,e+a);break;case"takeRight":e=an(e,t-a)}}return{start:e,end:t}}(0,i,this.__views__),a=o.start,s=o.end,l=s-a,u=r?s:a-1,c=this.__iteratees__,h=c.length,d=0,p=sn(l,this.__takeCount__);if(!n||!r&&i==l&&p==l)return ni(e,this.__actions__);var f=[];e:for(;l--&&d<p;){for(var m=-1,g=e[u+=t];++m<h;){var y=c[m],v=y.iteratee,_=y.type,w=v(g);if(2==_)g=w;else if(!w){if(1==_)continue e;break e}}f[d++]=g}return f},An.prototype.at=ra,An.prototype.chain=function(){return ta(this)},An.prototype.commit=function(){return new In(this.value(),this.__chain__)},An.prototype.next=function(){void 0===this.__values__&&(this.__values__=ts(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},An.prototype.plant=function(e){for(var t,n=this;n instanceof Pn;){var r=Ao(n);r.__index__=0,r.__values__=void 0,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t},An.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Mn){var t=e;return this.__actions__.length&&(t=new Mn(this)),(t=t.reverse()).__actions__.push({func:na,args:[Wo],thisArg:void 0}),new In(t,this.__chain__)}return this.thru(Wo)},An.prototype.toJSON=An.prototype.valueOf=An.prototype.value=function(){return ni(this.__wrapped__,this.__actions__)},An.prototype.first=An.prototype.head,Ze&&(An.prototype[Ze]=function(){return this}),An}();Ve._=Kt,void 0===(i=function(){return Kt}.call(t,n,t,r))||(r.exports=i)}).call(this)}).call(this,n(14),n(8)(e))},function(e,t,n){"use strict";n.r(t),n.d(t,"fromString",(function(){return o})),n.d(t,"add",(function(){return a})),n.d(t,"add_",(function(){return s})),n.d(t,"multiply",(function(){return l})),n.d(t,"multiply_",(function(){return u})),n.d(t,"interpolate",(function(){return c})),n.d(t,"lerp",(function(){return h})),n.d(t,"interpolateHSL",(function(){return d})),n.d(t,"lerpHSL",(function(){return p})),n.d(t,"randomize",(function(){return f})),n.d(t,"rgb2hsl",(function(){return m})),n.d(t,"hsl2rgb",(function(){return y})),n.d(t,"toRGB",(function(){return v})),n.d(t,"toHex",(function(){return _}));var r=n(4),i=n(5);
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
function o(e){let t,n;if(e in w)t=w[e];else{if("#"===e.charAt(0)){const n=(e.match(/[0-9a-f]/gi)||[]).map(e=>parseInt(e,16));if(3===n.length)t=n.map(e=>17*e);else{for(let e=0;e<3;e++)n[e+1]+=16*n[e],n.splice(e,1);t=n}}else t=(n=e.match(/rgb\(([0-9, ]+)\)/i))?n[1].split(/\s*,\s*/).map(e=>parseInt(e)):[0,0,0];w[e]=t}return t.slice()}function a(e,...t){const n=e.slice();for(let e=0;e<3;e++)for(let r=0;r<t.length;r++)n[e]+=t[r][e];return n}function s(e,...t){for(let n=0;n<3;n++)for(let r=0;r<t.length;r++)e[n]+=t[r][n];return e}function l(e,...t){const n=e.slice();for(let e=0;e<3;e++){for(let r=0;r<t.length;r++)n[e]*=t[r][e]/255;n[e]=Math.round(n[e])}return n}function u(e,...t){for(let n=0;n<3;n++){for(let r=0;r<t.length;r++)e[n]*=t[r][n]/255;e[n]=Math.round(e[n])}return e}function c(e,t,n=.5){const r=e.slice();for(let i=0;i<3;i++)r[i]=Math.round(r[i]+n*(t[i]-e[i]));return r}const h=c;function d(e,t,n=.5){const r=m(e),i=m(t);for(let e=0;e<3;e++)r[e]+=n*(i[e]-r[e]);return y(r)}const p=d;function f(e,t){t instanceof Array||(t=Math.round(i.a.getNormal(0,t)));const n=e.slice();for(let e=0;e<3;e++)n[e]+=t instanceof Array?Math.round(i.a.getNormal(0,t[e])):t;return n}function m(e){const t=e[0]/255,n=e[1]/255,r=e[2]/255,i=Math.max(t,n,r),o=Math.min(t,n,r);let a,s=0,l=(i+o)/2;if(i===o)a=0;else{const e=i-o;switch(a=l>.5?e/(2-i-o):e/(i+o),i){case t:s=(n-r)/e+(n<r?6:0);break;case n:s=(r-t)/e+2;break;case r:s=(t-n)/e+4}s/=6}return[s,a,l]}function g(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function y(e){let t=e[2];if(0===e[1])return t=Math.round(255*t),[t,t,t];{const n=e[1],r=t<.5?t*(1+n):t+n-t*n,i=2*t-r,o=g(i,r,e[0]+1/3),a=g(i,r,e[0]),s=g(i,r,e[0]-1/3);return[Math.round(255*o),Math.round(255*a),Math.round(255*s)]}}function v(e){return`rgb(${e.map(e=>Object(r.clamp)(e,0,255)).join(",")})`}function _(e){return"#"+e.map(e=>Object(r.clamp)(e,0,255).toString(16).padStart(2,"0")).join("")}const w={black:[0,0,0],navy:[0,0,128],darkblue:[0,0,139],mediumblue:[0,0,205],blue:[0,0,255],darkgreen:[0,100,0],green:[0,128,0],teal:[0,128,128],darkcyan:[0,139,139],deepskyblue:[0,191,255],darkturquoise:[0,206,209],mediumspringgreen:[0,250,154],lime:[0,255,0],springgreen:[0,255,127],aqua:[0,255,255],cyan:[0,255,255],midnightblue:[25,25,112],dodgerblue:[30,144,255],forestgreen:[34,139,34],seagreen:[46,139,87],darkslategray:[47,79,79],darkslategrey:[47,79,79],limegreen:[50,205,50],mediumseagreen:[60,179,113],turquoise:[64,224,208],royalblue:[65,105,225],steelblue:[70,130,180],darkslateblue:[72,61,139],mediumturquoise:[72,209,204],indigo:[75,0,130],darkolivegreen:[85,107,47],cadetblue:[95,158,160],cornflowerblue:[100,149,237],mediumaquamarine:[102,205,170],dimgray:[105,105,105],dimgrey:[105,105,105],slateblue:[106,90,205],olivedrab:[107,142,35],slategray:[112,128,144],slategrey:[112,128,144],lightslategray:[119,136,153],lightslategrey:[119,136,153],mediumslateblue:[123,104,238],lawngreen:[124,252,0],chartreuse:[127,255,0],aquamarine:[127,255,212],maroon:[128,0,0],purple:[128,0,128],olive:[128,128,0],gray:[128,128,128],grey:[128,128,128],skyblue:[135,206,235],lightskyblue:[135,206,250],blueviolet:[138,43,226],darkred:[139,0,0],darkmagenta:[139,0,139],saddlebrown:[139,69,19],darkseagreen:[143,188,143],lightgreen:[144,238,144],mediumpurple:[147,112,216],darkviolet:[148,0,211],palegreen:[152,251,152],darkorchid:[153,50,204],yellowgreen:[154,205,50],sienna:[160,82,45],brown:[165,42,42],darkgray:[169,169,169],darkgrey:[169,169,169],lightblue:[173,216,230],greenyellow:[173,255,47],paleturquoise:[175,238,238],lightsteelblue:[176,196,222],powderblue:[176,224,230],firebrick:[178,34,34],darkgoldenrod:[184,134,11],mediumorchid:[186,85,211],rosybrown:[188,143,143],darkkhaki:[189,183,107],silver:[192,192,192],mediumvioletred:[199,21,133],indianred:[205,92,92],peru:[205,133,63],chocolate:[210,105,30],tan:[210,180,140],lightgray:[211,211,211],lightgrey:[211,211,211],palevioletred:[216,112,147],thistle:[216,191,216],orchid:[218,112,214],goldenrod:[218,165,32],crimson:[220,20,60],gainsboro:[220,220,220],plum:[221,160,221],burlywood:[222,184,135],lightcyan:[224,255,255],lavender:[230,230,250],darksalmon:[233,150,122],violet:[238,130,238],palegoldenrod:[238,232,170],lightcoral:[240,128,128],khaki:[240,230,140],aliceblue:[240,248,255],honeydew:[240,255,240],azure:[240,255,255],sandybrown:[244,164,96],wheat:[245,222,179],beige:[245,245,220],whitesmoke:[245,245,245],mintcream:[245,255,250],ghostwhite:[248,248,255],salmon:[250,128,114],antiquewhite:[250,235,215],linen:[250,240,230],lightgoldenrodyellow:[250,250,210],oldlace:[253,245,230],red:[255,0,0],fuchsia:[255,0,255],magenta:[255,0,255],deeppink:[255,20,147],orangered:[255,69,0],tomato:[255,99,71],hotpink:[255,105,180],coral:[255,127,80],darkorange:[255,140,0],lightsalmon:[255,160,122],orange:[255,165,0],lightpink:[255,182,193],pink:[255,192,203],gold:[255,215,0],peachpuff:[255,218,185],navajowhite:[255,222,173],moccasin:[255,228,181],bisque:[255,228,196],mistyrose:[255,228,225],blanchedalmond:[255,235,205],papayawhip:[255,239,213],lavenderblush:[255,240,245],seashell:[255,245,238],cornsilk:[255,248,220],lemonchiffon:[255,250,205],floralwhite:[255,250,240],snow:[255,250,250],yellow:[255,255,0],lightyellow:[255,255,224],ivory:[255,255,240],white:[255,255,255]}},function(e,t,n){(function(n){var r;
/*!
 *  howler.js v2.2.1
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */!function(){"use strict";var i=function(){this.init()};i.prototype={init:function(){var e=this||o;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||o;if(e=parseFloat(e),t.ctx||p(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,o.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var r=t._howls[n]._getSoundIds(),i=0;i<r.length;i++){var a=t._howls[n]._soundById(r[i]);a&&a._node&&(a._node.volume=a._volume*e)}return t}return t._volume},mute:function(e){var t=this||o;t.ctx||p(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,o.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var r=t._howls[n]._getSoundIds(),i=0;i<r.length;i++){var a=t._howls[n]._soundById(r[i]);a&&a._node&&(a._node.muted=!!e||a._muted)}return t},stop:function(){for(var e=this||o,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||o,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,p()),e},codecs:function(e){return(this||o)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||o;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||o,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var n=t.canPlayType("audio/mpeg;").replace(/^no$/,""),r=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),i=r&&parseInt(r[0].split("/")[1],10)<33;return e._codecs={mp3:!(i||!n&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(t.canPlayType('audio/wav; codecs="1"')||t.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(t.canPlayType("audio/x-m4b;")||t.canPlayType("audio/m4b;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||o;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(n){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var r=new Audio;r._unlocked=!0,e._releaseHtml5Audio(r)}catch(n){e.noAudio=!0;break}for(var i=0;i<e._howls.length;i++)if(!e._howls[i]._webAudio)for(var o=e._howls[i]._getSoundIds(),a=0;a<o.length;a++){var s=e._howls[i]._soundById(o[a]);s&&s._node&&!s._node._unlocked&&(s._node._unlocked=!0,s._node.load())}e._autoResume();var l=e.ctx.createBufferSource();l.buffer=e._scratchBuffer,l.connect(e.ctx.destination),void 0===l.start?l.noteOn(0):l.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),l.onended=function(){l.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0);for(var n=0;n<e._howls.length;n++)e._howls[n]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),e}},_obtainHtml5Audio:function(){var e=this||o;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=(new Audio).play();return t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)&&t.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(e){var t=this||o;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&o.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var n=0;n<e._howls[t]._sounds.length;n++)if(!e._howls[t]._sounds[n]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout((function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var t=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}}),3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&o.usingWebAudio)return"running"===e.state&&"interrupted"!==e.ctx.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state||"running"===e.state&&"interrupted"===e.ctx.state?(e.ctx.resume().then((function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")})),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var o=new i,a=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};a.prototype={init:function(e){var t=this;return o.ctx||p(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload&&"metadata"!==e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!(!e.xhr||!e.xhr.withCredentials)&&e.xhr.withCredentials},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=o.usingWebAudio&&!t._html5,void 0!==o.ctx&&o.ctx&&o.autoUnlock&&o._unlockAudio(),o._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&"none"!==t._preload&&t.load(),t},load:function(){var e=null;if(o.noAudio)this._emit("loaderror",null,"No audio support.");else{"string"==typeof this._src&&(this._src=[this._src]);for(var t=0;t<this._src.length;t++){var n,r;if(this._format&&this._format[t])n=this._format[t];else{if("string"!=typeof(r=this._src[t])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(n=/^data:audio\/([^;,]+);/i.exec(r))||(n=/\.([^.]+)$/.exec(r.split("?",1)[0])),n&&(n=n[1].toLowerCase())}if(n||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),n&&o.codecs(n)){e=this._src[t];break}}if(e)return this._src=e,this._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new s(this),this._webAudio&&u(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,t){var n=this,r=null;if("number"==typeof e)r=e,e=null;else{if("string"==typeof e&&"loaded"===n._state&&!n._sprite[e])return null;if(void 0===e&&(e="__default",!n._playLock)){for(var i=0,a=0;a<n._sounds.length;a++)n._sounds[a]._paused&&!n._sounds[a]._ended&&(i++,r=n._sounds[a]._id);1===i?e=null:r=null}}var s=r?n._soundById(r):n._inactiveSound();if(!s)return null;if(r&&!e&&(e=s._sprite||"__default"),"loaded"!==n._state){s._sprite=e,s._ended=!1;var l=s._id;return n._queue.push({event:"play",action:function(){n.play(l)}}),l}if(r&&!s._paused)return t||n._loadQueue("play"),s._id;n._webAudio&&o._autoResume();var u=Math.max(0,s._seek>0?s._seek:n._sprite[e][0]/1e3),c=Math.max(0,(n._sprite[e][0]+n._sprite[e][1])/1e3-u),h=1e3*c/Math.abs(s._rate),d=n._sprite[e][0]/1e3,p=(n._sprite[e][0]+n._sprite[e][1])/1e3;s._sprite=e,s._ended=!1;var f=function(){s._paused=!1,s._seek=u,s._start=d,s._stop=p,s._loop=!(!s._loop&&!n._sprite[e][2])};if(!(u>=p)){var m=s._node;if(n._webAudio){var g=function(){n._playLock=!1,f(),n._refreshBuffer(s);var e=s._muted||n._muted?0:s._volume;m.gain.setValueAtTime(e,o.ctx.currentTime),s._playStart=o.ctx.currentTime,void 0===m.bufferSource.start?s._loop?m.bufferSource.noteGrainOn(0,u,86400):m.bufferSource.noteGrainOn(0,u,c):s._loop?m.bufferSource.start(0,u,86400):m.bufferSource.start(0,u,c),h!==1/0&&(n._endTimers[s._id]=setTimeout(n._ended.bind(n,s),h)),t||setTimeout((function(){n._emit("play",s._id),n._loadQueue()}),0)};"running"===o.state&&"interrupted"!==o.ctx.state?g():(n._playLock=!0,n.once("resume",g),n._clearTimer(s._id))}else{var y=function(){m.currentTime=u,m.muted=s._muted||n._muted||o._muted||m.muted,m.volume=s._volume*o.volume(),m.playbackRate=s._rate;try{var r=m.play();if(r&&"undefined"!=typeof Promise&&(r instanceof Promise||"function"==typeof r.then)?(n._playLock=!0,f(),r.then((function(){n._playLock=!1,m._unlocked=!0,t||(n._emit("play",s._id),n._loadQueue())})).catch((function(){n._playLock=!1,n._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),s._ended=!0,s._paused=!0}))):t||(n._playLock=!1,f(),n._emit("play",s._id),n._loadQueue()),m.playbackRate=s._rate,m.paused)return void n._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||s._loop?n._endTimers[s._id]=setTimeout(n._ended.bind(n,s),h):(n._endTimers[s._id]=function(){n._ended(s),m.removeEventListener("ended",n._endTimers[s._id],!1)},m.addEventListener("ended",n._endTimers[s._id],!1))}catch(e){n._emit("playerror",s._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===m.src&&(m.src=n._src,m.load());var v=window&&window.ejecta||!m.readyState&&o._navigator.isCocoonJS;if(m.readyState>=3||v)y();else{n._playLock=!0;var _=function(){y(),m.removeEventListener(o._canPlayEvent,_,!1)};m.addEventListener(o._canPlayEvent,_,!1),n._clearTimer(s._id)}}return s._id}n._ended(s)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),r=0;r<n.length;r++){t._clearTimer(n[r]);var i=t._soundById(n[r]);if(i&&!i._paused&&(i._seek=t.seek(n[r]),i._rateSeek=0,i._paused=!0,t._stopFade(n[r]),i._node))if(t._webAudio){if(!i._node.bufferSource)continue;void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),t._cleanBuffer(i._node)}else isNaN(i._node.duration)&&i._node.duration!==1/0||i._node.pause();arguments[1]||t._emit("pause",i?i._id:null)}return t},stop:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var r=n._getSoundIds(e),i=0;i<r.length;i++){n._clearTimer(r[i]);var o=n._soundById(r[i]);o&&(o._seek=o._start||0,o._rateSeek=0,o._paused=!0,o._ended=!0,n._stopFade(r[i]),o._node&&(n._webAudio?o._node.bufferSource&&(void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),n._cleanBuffer(o._node)):isNaN(o._node.duration)&&o._node.duration!==1/0||(o._node.currentTime=o._start||0,o._node.pause(),o._node.duration===1/0&&n._clearSound(o._node))),t||n._emit("stop",o._id))}return n},mute:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(e,t)}}),n;if(void 0===t){if("boolean"!=typeof e)return n._muted;n._muted=e}for(var r=n._getSoundIds(t),i=0;i<r.length;i++){var a=n._soundById(r[i]);a&&(a._muted=e,a._interval&&n._stopFade(a._id),n._webAudio&&a._node?a._node.gain.setValueAtTime(e?0:a._volume,o.ctx.currentTime):a._node&&(a._node.muted=!!o._muted||e),n._emit("mute",a._id))}return n},volume:function(){var e,t,n,r=this,i=arguments;if(0===i.length)return r._volume;if(1===i.length||2===i.length&&void 0===i[1]){var a=r._getSoundIds(),s=a.indexOf(i[0]);s>=0?t=parseInt(i[0],10):e=parseFloat(i[0])}else i.length>=2&&(e=parseFloat(i[0]),t=parseInt(i[1],10));if(!(void 0!==e&&e>=0&&e<=1))return(n=t?r._soundById(t):r._sounds[0])?n._volume:0;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,i)}}),r;void 0===t&&(r._volume=e),t=r._getSoundIds(t);for(var l=0;l<t.length;l++)(n=r._soundById(t[l]))&&(n._volume=e,i[2]||r._stopFade(t[l]),r._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(e,o.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=e*o.volume()),r._emit("volume",n._id));return r},fade:function(e,t,n,r){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"fade",action:function(){i.fade(e,t,n,r)}}),i;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),n=parseFloat(n),i.volume(e,r);for(var a=i._getSoundIds(r),s=0;s<a.length;s++){var l=i._soundById(a[s]);if(l){if(r||i._stopFade(a[s]),i._webAudio&&!l._muted){var u=o.ctx.currentTime,c=u+n/1e3;l._volume=e,l._node.gain.setValueAtTime(e,u),l._node.gain.linearRampToValueAtTime(t,c)}i._startFadeInterval(l,e,t,n,a[s],void 0===r)}}return i},_startFadeInterval:function(e,t,n,r,i,o){var a=this,s=t,l=n-t,u=Math.abs(l/.01),c=Math.max(4,u>0?r/u:r),h=Date.now();e._fadeTo=n,e._interval=setInterval((function(){var i=(Date.now()-h)/r;h=Date.now(),s+=l*i,s=Math.round(100*s)/100,s=l<0?Math.max(n,s):Math.min(n,s),a._webAudio?e._volume=s:a.volume(s,e._id,!0),o&&(a._volume=s),(n<t&&s<=n||n>t&&s>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,a.volume(n,e._id),a._emit("fade",e._id))}),c)},_stopFade:function(e){var t=this._soundById(e);return t&&t._interval&&(this._webAudio&&t._node.gain.cancelScheduledValues(o.ctx.currentTime),clearInterval(t._interval),t._interval=null,this.volume(t._fadeTo,e),t._fadeTo=null,this._emit("fade",e)),this},loop:function(){var e,t,n,r=this,i=arguments;if(0===i.length)return r._loop;if(1===i.length){if("boolean"!=typeof i[0])return!!(n=r._soundById(parseInt(i[0],10)))&&n._loop;e=i[0],r._loop=e}else 2===i.length&&(e=i[0],t=parseInt(i[1],10));for(var o=r._getSoundIds(t),a=0;a<o.length;a++)(n=r._soundById(o[a]))&&(n._loop=e,r._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=e,e&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop)));return r},rate:function(){var e,t,n,r=this,i=arguments;if(0===i.length)t=r._sounds[0]._id;else if(1===i.length){var a=r._getSoundIds(),s=a.indexOf(i[0]);s>=0?t=parseInt(i[0],10):e=parseFloat(i[0])}else 2===i.length&&(e=parseFloat(i[0]),t=parseInt(i[1],10));if("number"!=typeof e)return(n=r._soundById(t))?n._rate:r._rate;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,i)}}),r;void 0===t&&(r._rate=e),t=r._getSoundIds(t);for(var l=0;l<t.length;l++)if(n=r._soundById(t[l])){r.playing(t[l])&&(n._rateSeek=r.seek(t[l]),n._playStart=r._webAudio?o.ctx.currentTime:n._playStart),n._rate=e,r._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(e,o.ctx.currentTime):n._node&&(n._node.playbackRate=e);var u=r.seek(t[l]),c=(r._sprite[n._sprite][0]+r._sprite[n._sprite][1])/1e3-u,h=1e3*c/Math.abs(n._rate);!r._endTimers[t[l]]&&n._paused||(r._clearTimer(t[l]),r._endTimers[t[l]]=setTimeout(r._ended.bind(r,n),h)),r._emit("rate",n._id)}return r},seek:function(){var e,t,n=this,r=arguments;if(0===r.length)t=n._sounds[0]._id;else if(1===r.length){var i=n._getSoundIds(),a=i.indexOf(r[0]);a>=0?t=parseInt(r[0],10):n._sounds.length&&(t=n._sounds[0]._id,e=parseFloat(r[0]))}else 2===r.length&&(e=parseFloat(r[0]),t=parseInt(r[1],10));if(void 0===t)return n;if("number"==typeof e&&("loaded"!==n._state||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,r)}}),n;var s=n._soundById(t);if(s){if(!("number"==typeof e&&e>=0)){if(n._webAudio){var l=n.playing(t)?o.ctx.currentTime-s._playStart:0,u=s._rateSeek?s._rateSeek-s._seek:0;return s._seek+(u+l*Math.abs(s._rate))}return s._node.currentTime}var c=n.playing(t);c&&n.pause(t,!0),s._seek=e,s._ended=!1,n._clearTimer(t),n._webAudio||!s._node||isNaN(s._node.duration)||(s._node.currentTime=e);var h=function(){n._emit("seek",t),c&&n.play(t,!0)};if(c&&!n._webAudio){var d=function(){n._playLock?setTimeout(d,0):h()};setTimeout(d,0)}else h()}return n},playing:function(e){if("number"==typeof e){var t=this._soundById(e);return!!t&&!t._paused}for(var n=0;n<this._sounds.length;n++)if(!this._sounds[n]._paused)return!0;return!1},duration:function(e){var t=this._duration,n=this._soundById(e);return n&&(t=this._sprite[n._sprite][1]/1e3),t},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,n=0;n<t.length;n++)t[n]._paused||e.stop(t[n]._id),e._webAudio||(e._clearSound(t[n]._node),t[n]._node.removeEventListener("error",t[n]._errorFn,!1),t[n]._node.removeEventListener(o._canPlayEvent,t[n]._loadFn,!1),t[n]._node.removeEventListener("ended",t[n]._endFn,!1),o._releaseHtml5Audio(t[n]._node)),delete t[n]._node,e._clearTimer(t[n]._id);var r=o._howls.indexOf(e);r>=0&&o._howls.splice(r,1);var i=!0;for(n=0;n<o._howls.length;n++)if(o._howls[n]._src===e._src||e._src.indexOf(o._howls[n]._src)>=0){i=!1;break}return l&&i&&delete l[e._src],o.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,n,r){var i=this["_on"+e];return"function"==typeof t&&i.push(r?{id:n,fn:t,once:r}:{id:n,fn:t}),this},off:function(e,t,n){var r=this["_on"+e],i=0;if("number"==typeof t&&(n=t,t=null),t||n)for(i=0;i<r.length;i++){var o=n===r[i].id;if(t===r[i].fn&&o||!t&&o){r.splice(i,1);break}}else if(e)this["_on"+e]=[];else{var a=Object.keys(this);for(i=0;i<a.length;i++)0===a[i].indexOf("_on")&&Array.isArray(this[a[i]])&&(this[a[i]]=[])}return this},once:function(e,t,n){return this.on(e,t,n,1),this},_emit:function(e,t,n){for(var r=this["_on"+e],i=r.length-1;i>=0;i--)r[i].id&&r[i].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,n)}.bind(this,r[i].fn),0),r[i].once&&this.off(e,r[i].fn,r[i].id));return this._loadQueue(e),this},_loadQueue:function(e){if(this._queue.length>0){var t=this._queue[0];t.event===e&&(this._queue.shift(),this._loadQueue()),e||t.action()}return this},_ended:function(e){var t=e._sprite;if(!this._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(this._ended.bind(this,e),100),this;var n=!(!e._loop&&!this._sprite[t][2]);if(this._emit("end",e._id),!this._webAudio&&n&&this.stop(e._id,!0).play(e._id),this._webAudio&&n){this._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=o.ctx.currentTime;var r=1e3*(e._stop-e._start)/Math.abs(e._rate);this._endTimers[e._id]=setTimeout(this._ended.bind(this,e),r)}return this._webAudio&&!n&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,this._clearTimer(e._id),this._cleanBuffer(e._node),o._autoSuspend()),this._webAudio||n||this.stop(e._id,!0),this},_clearTimer:function(e){if(this._endTimers[e]){if("function"!=typeof this._endTimers[e])clearTimeout(this._endTimers[e]);else{var t=this._soundById(e);t&&t._node&&t._node.removeEventListener("ended",this._endTimers[e],!1)}delete this._endTimers[e]}return this},_soundById:function(e){for(var t=0;t<this._sounds.length;t++)if(e===this._sounds[t]._id)return this._sounds[t];return null},_inactiveSound:function(){this._drain();for(var e=0;e<this._sounds.length;e++)if(this._sounds[e]._ended)return this._sounds[e].reset();return new s(this)},_drain:function(){var e=this._pool,t=0,n=0;if(!(this._sounds.length<e)){for(n=0;n<this._sounds.length;n++)this._sounds[n]._ended&&t++;for(n=this._sounds.length-1;n>=0;n--){if(t<=e)return;this._sounds[n]._ended&&(this._webAudio&&this._sounds[n]._node&&this._sounds[n]._node.disconnect(0),this._sounds.splice(n,1),t--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],n=0;n<this._sounds.length;n++)t.push(this._sounds[n]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=o.ctx.createBufferSource(),e._node.bufferSource.buffer=l[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,o.ctx.currentTime),this},_cleanBuffer:function(e){var t=o._navigator&&o._navigator.vendor.indexOf("Apple")>=0;if(o._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=o._scratchBuffer}catch(e){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(o._navigator&&o._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var s=function(e){this._parent=e,this.init()};s.prototype={init:function(){var e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++o._counter,e._sounds.push(this),this.create(),this},create:function(){var e=this._parent,t=o._muted||this._muted||this._parent._muted?0:this._volume;return e._webAudio?(this._node=void 0===o.ctx.createGain?o.ctx.createGainNode():o.ctx.createGain(),this._node.gain.setValueAtTime(t,o.ctx.currentTime),this._node.paused=!0,this._node.connect(o.masterGain)):o.noAudio||(this._node=o._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(o._canPlayEvent,this._loadFn,!1),this._endFn=this._endListener.bind(this),this._node.addEventListener("ended",this._endFn,!1),this._node.src=e._src,this._node.preload=!0===e._preload?"auto":e._preload,this._node.volume=t*o.volume(),this._node.load()),this},reset:function(){var e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++o._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var e=this._parent;e._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),this._node.removeEventListener(o._canPlayEvent,this._loadFn,!1)},_endListener:function(){var e=this._parent;e._duration===1/0&&(e._duration=Math.ceil(10*this._node.duration)/10,e._sprite.__default[1]===1/0&&(e._sprite.__default[1]=1e3*e._duration),e._ended(this)),this._node.removeEventListener("ended",this._endFn,!1)}};var l={},u=function(e){var t=e._src;if(l[t])return e._duration=l[t].duration,void d(e);if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(",")[1]),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);h(r.buffer,e)}else{var o=new XMLHttpRequest;o.open(e._xhr.method,t,!0),o.withCredentials=e._xhr.withCredentials,o.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach((function(t){o.setRequestHeader(t,e._xhr.headers[t])})),o.onload=function(){var t=(o.status+"")[0];"0"===t||"2"===t||"3"===t?h(o.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+o.status+".")},o.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete l[t],e.load())},c(o)}},c=function(e){try{e.send()}catch(t){e.onerror()}},h=function(e,t){var n=function(){t._emit("loaderror",null,"Decoding audio data failed.")},r=function(e){e&&t._sounds.length>0?(l[t._src]=e,d(t,e)):n()};"undefined"!=typeof Promise&&1===o.ctx.decodeAudioData.length?o.ctx.decodeAudioData(e).then(r).catch(n):o.ctx.decodeAudioData(e,r,n)},d=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},p=function(){if(o.usingWebAudio){try{"undefined"!=typeof AudioContext?o.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?o.ctx=new webkitAudioContext:o.usingWebAudio=!1}catch(e){o.usingWebAudio=!1}o.ctx||(o.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(o._navigator&&o._navigator.platform),t=o._navigator&&o._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=t?parseInt(t[1],10):null;if(e&&n&&n<9){var r=/safari/.test(o._navigator&&o._navigator.userAgent.toLowerCase());o._navigator&&!r&&(o.usingWebAudio=!1)}o.usingWebAudio&&(o.masterGain=void 0===o.ctx.createGain?o.ctx.createGainNode():o.ctx.createGain(),o.masterGain.gain.setValueAtTime(o._muted?0:o._volume,o.ctx.currentTime),o.masterGain.connect(o.ctx.destination)),o._setup()}};void 0===(r=function(){return{Howler:o,Howl:a}}.apply(t,[]))||(e.exports=r),t.Howler=o,t.Howl=a,void 0!==n?(n.HowlerGlobal=i,n.Howler=o,n.Howl=a,n.Sound=s):"undefined"!=typeof window&&(window.HowlerGlobal=i,window.Howler=o,window.Howl=a,window.Sound=s)}(),
/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.1
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
function(){"use strict";var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){if(!this.ctx||!this.ctx.listener)return this;for(var t=this._howls.length-1;t>=0;t--)this._howls[t].stereo(e);return this},HowlerGlobal.prototype.pos=function(e,t,n){return this.ctx&&this.ctx.listener?(t="number"!=typeof t?this._pos[1]:t,n="number"!=typeof n?this._pos[2]:n,"number"!=typeof e?this._pos:(this._pos=[e,t,n],void 0!==this.ctx.listener.positionX?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this},HowlerGlobal.prototype.orientation=function(e,t,n,r,i,o){if(!this.ctx||!this.ctx.listener)return this;var a=this._orientation;return t="number"!=typeof t?a[1]:t,n="number"!=typeof n?a[2]:n,r="number"!=typeof r?a[3]:r,i="number"!=typeof i?a[4]:i,o="number"!=typeof o?a[5]:o,"number"!=typeof e?a:(this._orientation=[e,t,n,r,i,o],void 0!==this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(r,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(i,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(o,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(e,t,n,r,i,o),this)},Howl.prototype.init=(e=Howl.prototype.init,function(t){return this._orientation=t.orientation||[1,0,0],this._stereo=t.stereo||null,this._pos=t.pos||null,this._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},this._onstereo=t.onstereo?[{fn:t.onstereo}]:[],this._onpos=t.onpos?[{fn:t.onpos}]:[],this._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,n){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"stereo",action:function(){r.stereo(e,n)}}),r;var i=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof e)return r._stereo;r._stereo=e,r._pos=[e,0,0]}for(var o=r._getSoundIds(n),a=0;a<o.length;a++){var s=r._soundById(o[a]);if(s){if("number"!=typeof e)return s._stereo;s._stereo=e,s._pos=[e,0,0],s._node&&(s._pannerAttr.panningModel="equalpower",s._panner&&s._panner.pan||t(s,i),"spatial"===i?void 0!==s._panner.positionX?(s._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),s._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),s._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):s._panner.setPosition(e,0,0):s._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),r._emit("stereo",s._id)}}return r},Howl.prototype.pos=function(e,n,r,i){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"pos",action:function(){o.pos(e,n,r,i)}}),o;if(n="number"!=typeof n?0:n,r="number"!=typeof r?-.5:r,void 0===i){if("number"!=typeof e)return o._pos;o._pos=[e,n,r]}for(var a=o._getSoundIds(i),s=0;s<a.length;s++){var l=o._soundById(a[s]);if(l){if("number"!=typeof e)return l._pos;l._pos=[e,n,r],l._node&&(l._panner&&!l._panner.pan||t(l,"spatial"),void 0!==l._panner.positionX?(l._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):l._panner.setPosition(e,n,r)),o._emit("pos",l._id)}}return o},Howl.prototype.orientation=function(e,n,r,i){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"orientation",action:function(){o.orientation(e,n,r,i)}}),o;if(n="number"!=typeof n?o._orientation[1]:n,r="number"!=typeof r?o._orientation[2]:r,void 0===i){if("number"!=typeof e)return o._orientation;o._orientation=[e,n,r]}for(var a=o._getSoundIds(i),s=0;s<a.length;s++){var l=o._soundById(a[s]);if(l){if("number"!=typeof e)return l._orientation;l._orientation=[e,n,r],l._node&&(l._panner||(l._pos||(l._pos=o._pos||[0,0,-.5]),t(l,"spatial")),void 0!==l._panner.orientationX?(l._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):l._panner.setOrientation(e,n,r)),o._emit("orientation",l._id)}}return o},Howl.prototype.pannerAttr=function(){var e,n,r,i=this,o=arguments;if(!i._webAudio)return i;if(0===o.length)return i._pannerAttr;if(1===o.length){if("object"!=typeof o[0])return(r=i._soundById(parseInt(o[0],10)))?r._pannerAttr:i._pannerAttr;e=o[0],void 0===n&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),i._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:i._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:i._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:i._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:i._panningModel})}else 2===o.length&&(e=o[0],n=parseInt(o[1],10));for(var a=i._getSoundIds(n),s=0;s<a.length;s++)if(r=i._soundById(a[s])){var l=r._pannerAttr;l={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:l.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:l.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:l.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:l.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:l.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:l.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:l.panningModel};var u=r._panner;u?(u.coneInnerAngle=l.coneInnerAngle,u.coneOuterAngle=l.coneOuterAngle,u.coneOuterGain=l.coneOuterGain,u.distanceModel=l.distanceModel,u.maxDistance=l.maxDistance,u.refDistance=l.refDistance,u.rolloffFactor=l.rolloffFactor,u.panningModel=l.panningModel):(r._pos||(r._pos=i._pos||[0,0,-.5]),t(r,"spatial"))}return i},Sound.prototype.init=function(e){return function(){var t=this._parent;this._orientation=t._orientation,this._stereo=t._stereo,this._pos=t._pos,this._pannerAttr=t._pannerAttr,e.call(this),this._stereo?t.stereo(this._stereo):this._pos&&t.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this._parent;return this._orientation=t._orientation,this._stereo=t._stereo,this._pos=t._pos,this._pannerAttr=t._pannerAttr,this._stereo?t.stereo(this._stereo):this._pos?t.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,t._refreshBuffer(this)),e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()}).call(this,n(14))},function(e,t,n){"use strict";
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
function r(e,t){return(e%t+t)%t}function i(e,t=0,n=1){return e<t?t:e>n?n:e}function o(e){return e.charAt(0).toUpperCase()+e.substring(1)}function a(e,...t){const n=a.map;return e.replace(/%(?:([a-z]+)|(?:{([^}]+)}))/gi,(function(r,i,a,s){if("%"===e.charAt(s-1))return r.substring(1);if(!t.length)return r;let l=t[0];const u=(i||a).split(","),c=u.shift()||"",h=n[c.toLowerCase()];if(!h)return r;l=t.shift();let d=l[h].apply(l,u);const p=c.charAt(0);return p!==p.toLowerCase()&&(d=o(d)),d}))}n.r(t),n.d(t,"mod",(function(){return r})),n.d(t,"clamp",(function(){return i})),n.d(t,"capitalize",(function(){return o})),n.d(t,"format",(function(){return a})),a.map={s:"toString"}},function(e,t,n){"use strict";
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */const r=2.3283064365386963e-10;class i{constructor(){this._seed=0,this._s0=0,this._s1=0,this._s2=0,this._c=0}getSeed(){return this._seed}setSeed(e){return e=e<1?1/e:e,this._seed=e,this._s0=(e>>>0)*r,e=69069*e+1>>>0,this._s1=e*r,e=69069*e+1>>>0,this._s2=e*r,this._c=1,this}getUniform(){const e=2091639*this._s0+this._c*r;return this._s0=this._s1,this._s1=this._s2,this._c=0|e,this._s2=e-this._c,this._s2}getUniformInt(e,t){const n=Math.max(e,t),r=Math.min(e,t);return Math.floor(this.getUniform()*(n-r+1))+r}getNormal(e=0,t=1){let n,r,i;do{n=2*this.getUniform()-1,r=2*this.getUniform()-1,i=n*n+r*r}while(i>1||0===i);return e+n*Math.sqrt(-2*Math.log(i)/i)*t}getPercentage(){return 1+Math.floor(100*this.getUniform())}getItem(e){return e.length?e[Math.floor(this.getUniform()*e.length)]:null}shuffle(e){const t=[],n=e.slice();for(;n.length;){const e=n.indexOf(this.getItem(n));t.push(n.splice(e,1)[0])}return t}getWeightedValue(e){let t=0;for(const n in e)t+=e[n];const n=this.getUniform()*t;let r,i=0;for(r in e)if(i+=e[r],n<i)return r;return r}getState(){return[this._s0,this._s1,this._s2,this._c]}setState(e){return this._s0=e[0],this._s1=e[1],this._s2=e[2],this._c=e[3],this}clone(){return(new i).setState(this.getState())}}t.a=(new i).setSeed(Date.now())},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
class r{getContainer(){return null}setOptions(e){this._options=e}}},function(e,t,n){n(11);const r=new(0,n(9).IdGenerator);e.exports=class{constructor(){this.types={},this.c={},this.id="",this.tags=new Set,this.updatedComponents=0,this.updatedValues=0,this.destroyed=!1,this.ready=!1}_setup(e){if(this.destroyed=!1,e.id?this.id=e.id:this.id=r.genId(),this.world.entities.set(this.id,this),this.updatedComponents=this.world.currentTick,e.tags)for(const t of e.tags)this.addTag(t);if(e.components)for(const t of e.components)this.addComponent(t);if(e.c){const t=e.c;for(const e of Object.keys(t)){const n={...t[e],key:e};n.type||(n.type=e),this.addComponent(n)}}this.ready=!0,this.world._entityUpdated(this)}has(e){return"string"!=typeof e&&(e=e.name),this.tags.has(e)||this.types.hasOwnProperty(e)}getOne(e){let t;return"string"!=typeof e&&(e=e.name),this.types[e]&&(t=[...this.types[e]][0]),t}getComponents(e){return"string"!=typeof e&&(e=e.name),this.types[e]||new Set}addTag(e){if(!this.world.tags.has(e))throw new Error(`addTag "${e}" is not registered. Type-O?`);this.tags.add(e),this.updatedComponents=this.world.currentTick,this.world.entitiesByComponent[e].add(this.id),this.ready&&this.world._entityUpdated(this)}removeTag(e){this.tags.delete(e),this.updatedComponents=this.world.currentTick,this.world.entitiesByComponent[e].delete(this.id),this.world._entityUpdated(this)}addComponent(e){const t=e.type,n=this.world.componentPool.get(t);if(void 0===n)throw new Error(`Component "${t}" has not been registered.`);const r=n.get(this,e);return this.types[t]||(this.types[t]=new Set),this.types[t].add(r),this.world._addEntityComponent(t,this),this.updatedComponents=this.world.currentTick,this.ready&&this.world._entityUpdated(this),r}removeComponent(e){return"string"==typeof e&&(e=this.c[e]),void 0!==e&&(e.key&&delete this.c[e.key],this.types[e.type].delete(e),0===this.types[e.type].size&&delete this.types[e.type],this.world._deleteEntityComponent(e),this.world._entityUpdated(this),e.destroy(),!0)}getObject(e=!0){const t={id:this.id,tags:[...this.tags],components:[],c:{}};for(const n of Object.keys(this.types))for(const r of this.types[n])r.constructor.serialize&&(r.key?t.c[r.key]=r.getObject(e):t.components.push(r.getObject(e)));return t}destroy(){if(this.world.refs[this.id])for(const e of this.world.refs[this.id]){const[t,n,r,i]=e.split("..."),o=this.world.getEntity(t);if(!o)continue;const a=o.world.componentsById.get(n);if(!a)continue;const s=r.split(".");let l=a,u=l;for(const e of s)u=l,l=l[e];"__set__"===i?l.delete(this):"__obj__"===i?delete u[s[1]]:u[r]=null}for(const e of Object.keys(this.types))for(const t of this.types[e])this.removeComponent(t);this.tags.clear(),this.world.entities.delete(this.id),delete this.world.entityReverse[this.id],this.destroyed=!0,this.ready=!1,this.world.entityPool.destroy(this),this.world._clearIndexes(this)}}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){const r=n(26).v4;e.exports={IdGenerator:class{constructor(){this.gen_num=0,this.prefix="",this.genPrefix()}genPrefix(){return r()}genId(){return this.gen_num++,4294967295===this.gen_num&&(this.gen_num=0,this.genPrefix()),this.prefix+this.gen_num}},setIntersection:function(){let e=Array.from(arguments),t=e.map(e=>e.size),n=t.indexOf(Math.min.apply(Math,t)),r=e[n],i=new Set(r);return e.splice(n,1),r.forEach(t=>{for(let n=0;n<e.length;n+=1)if(!e[n].has(t)){i.delete(t);break}}),i},setUnion:function(){let e=new Set;return Array.from(arguments).forEach(t=>{t.forEach(t=>e.add(t))}),e}}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var r=n(6),i=n(2);function o(e){const t=i.fromString(e);return 36*Math.floor(t[0]*(6/256))+6*Math.floor(t[1]*(6/256))+1*Math.floor(t[2]*(6/256))+16}class a extends r.a{constructor(){super(),this._offset=[0,0],this._cursor=[-1,-1],this._lastColor=""}setOptions(e){super.setOptions(e);const t=[e.width,e.height],n=this.computeSize();this._offset=n.map((e,n)=>Math.floor((e-t[n])/2))}clear(){e.stdout.write(`[0;48;5;${o(this._options.bg)}m[2J`)}draw(t,n){let[r,i,a,s,l]=t;const u=this._offset[0]+r,c=this._offset[1]+i,h=this.computeSize();if(u<0||u>=h[0])return;if(c<0||c>=h[1])return;if(u===this._cursor[0]&&c===this._cursor[1]||(e.stdout.write(function(e,t){return`[${t+1};${e+1}H`}(u,c)),this._cursor[0]=u,this._cursor[1]=c),n&&(a||(a=" ")),!a)return;const d=function(e,t){return`[0;38;5;${o(e)};48;5;${o(t)}m`}(s,l);if(d!==this._lastColor&&(e.stdout.write(d),this._lastColor=d),"\t"!==a){const t=[].concat(a);e.stdout.write(t[0])}this._cursor[0]++,this._cursor[0]>=h[0]&&(this._cursor[0]=0,this._cursor[1]++)}computeFontSize(){throw new Error("Terminal backend has no notion of font size")}eventToPosition(e,t){return[e,t]}computeSize(){return[e.stdout.columns,e.stdout.rows]}}}).call(this,n(24))},function(e,t,n){const r=new(n(9).IdGenerator);class i{constructor(e){this.world=e,this._meta={key:"",updated:0,entityId:"",refs:new Set,ready:!1,values:{}}}preInit(e){return e}init(e){}get type(){return this.constructor.name}get key(){return this._meta.key}set key(e){const t=this._meta.key;this._meta.key=e,t&&delete this.entity.c[t],e&&(this.entity.c[e]=this)}destroy(){this.preDestroy(),this._meta.values={};for(const e of this._meta.refs){const[t,n,r]=e.split("||");this.world._deleteRef(t,this._meta.entityId,this.id,n,r,this._meta.key,this.type)}this.world._sendChange({op:"destroy",component:this.id,entity:this._meta.entityId,type:this.type}),this.world.componentsById.delete(this.id),this.world.componentPool.get(this.type).release(this),this.postDestroy()}preDestroy(){}postDestroy(){}getObject(e=!0){const t={type:this.constructor.name};e&&(t.id=this.id,t.entity=this.entity.id);let n=this.constructor.serializeFields||this.constructor.fields;Array.isArray(this.constructor.skipSerializeFields)&&(n=n.filter((e,t,n)=>-1===this.constructor.skipSerializeFields.indexOf(e)));for(const e of n)void 0!==this[e]&&null!==this[e]&&"function"==typeof this[e].getValue?t[e]=this[e].getValue():this._meta.values.hasOwnProperty(e)?t[e]=this._meta.values[e]:t[e]=this[e];return this._meta.key&&(t.key=this._meta.key),t}_setup(e,t){this.entity=e,this.id=t.id||r.genId(),this._meta.updated=this.world.currentTick,this._meta.entityId=e.id,t.key&&(this.key=t.key),this._meta.values={},this.world.componentsById.set(this.id,this);const n=this.constructor.fields,i=this.constructor.primitives,o=this.constructor.factories;t=this.preInit(t);const a=Object.assign({},i,t);for(const e of n){const t=a[e];if(o.hasOwnProperty(e)){const n=o[e](this,t,e);void 0!==n&&(this[e]=n)}else this[e]=t}this._meta.ready=!0,Object.freeze(),this.init(t),this.world._sendChange({op:"add",component:this.id,entity:this._meta.entityId,type:this.type})}_reset(){this._meta.key="",this._meta.updated=0,this._meta.entityId=0,this._meta.ready=!1,this._meta.refs.clear(),this._meta.values={}}update(e){if(e&&(delete e.type,Object.assign(this,e),this.constructor.changeEvents)){const t={op:"change",props:[],component:this.id,entity:this._meta.entityId,type:this.type};for(const n in e)t.props.push(n);this.world._sendChange(t)}this._meta.updated=this.entity.updatedValues=this.world.currentTick}_addRef(e,t,n){this._meta.refs.add(`${e}||${t}||${n}`),this.world._addRef(e,this._meta.entityId,this.id,t,n,this._meta.key,this.type)}_deleteRef(e,t,n){this._meta.refs.delete(`${e}||${t}||${n}`),this.world._deleteRef(e,this._meta.entityId,this.id,t,n,this._meta.key,this.type)}}i.properties={},i.serialize=!0,i.serializeFields=null,i.skipSerializeFields=null,i.subbed=!1,i.registered=!1,e.exports=i},function(e,t,n){n(7);const r=n(9);e.exports=class{constructor(e,t,n){if(this.system=t,this.world=e,this.query={froms:[],filters:[]},this.hasStatic=!1,this.persisted=!1,this.results=new Set,this.executed=!1,this.added=new Set,this.removed=new Set,this.world.config.useApeDestroy&&!n&&this.not("ApeDestroy"),n){if(this.trackAdded=n.trackAdded||!1,this.trackRemoved=n.trackRemoved||!1,(this.trackAdded||this.trackRemoved)&&!this.system)throw new Error("Queries cannot track added or removed when initialized outside of a system");this.world.config.useApeDestroy&&!n.includeApeDestroy&&(n.not?n.not.push("ApeDestroy"):n.not=["ApeDestroy"]),n.from&&this.from(...n.from),n.reverse&&this.fromReverse(n.reverse.entity,n.reverse.type),n.all&&this.fromAll(...n.all),n.any&&this.fromAny(...n.any),n.not&&this.not(...n.not),n.only&&this.only(...n.only),n.persist&&this.persist()}}from(...e){return e=e.map(e=>"string"!=typeof e?e.id:e),this.query.froms.push({from:"from",entities:e}),this.hasStatic=!0,this}fromReverse(e,t){return"string"==typeof e&&(e=this.world.getEntity(e)),"function"==typeof t&&(t=t.name),this.query.froms.push({from:"reverse",entity:e,type:t}),this}fromAll(...e){const t=e.map(e=>"string"!=typeof e?e.name:e);return this.query.froms.push({from:"all",types:t}),this}fromAny(...e){const t=e.map(e=>"string"!=typeof e?e.name:e);return this.query.froms.push({from:"any",types:t}),this}not(...e){const t=e.map(e=>"string"!=typeof e?e.name:e);return this.query.filters.push({filter:"not",types:t}),this}only(...e){const t=e.map(e=>"string"!=typeof e?e.name:e);return this.query.filters.push({filter:"only",types:t}),this}update(e){let t=!1;for(const n of this.query.froms)if("all"===n.from){let r=!0;for(const t of n.types)if(!e.has(t)){r=!1;break}if(r){t=!0;break}}else if("any"===n.from){let r=!1;for(const t of n.types)if(e.has(t)){r=!0;break}if(r){t=!0;break}}else if("reverse"===n.from&&this.world.entityReverse.hasOwnProperty(n.entity.id)&&this.world.entityReverse[n.entity.id].hasOwnProperty(n.type)){new Set(this.world.entityReverse[n.entity.id][n.type].keys());if(new Set(this.world.entityReverse[n.entity.id][n.type].keys()).has(e.id)){t=!0;break}}t?(this.results.add(e),this._filter(e),this.trackAdded&&this.added.add(e)):this._removeEntity(e)}_removeEntity(e){this.results.has(e)&&this.trackRemoved&&this.removed.add(e),this.results.delete(e)}persist(e,t){if(this.hasStatic)throw new Error("Cannot persist query with static list of entities.");if(0===this.query.froms.length)throw new Error("Cannot persist query without entity source (fromAll, fromAny, fromReverse).");return this.world.queries.push(this),null!==this.system&&this.system.queries.push(this),"boolean"==typeof e&&(this.trackAdded=e),"boolean"==typeof t&&(this.trackRemoved=t),this.persisted=!0,this}clearChanges(){this.added.clear(),this.removed.clear()}refresh(){let e=new Set;for(const t of this.query.froms)if("from"===t.from)e=r.setUnion(e,t.entities);else if("all"===t.from)if(1===t.types.length){if(!this.world.entitiesByComponent.hasOwnProperty(t.types[0]))throw new Error(t.types[0]+" is not a registered Component/Tag");e=r.setUnion(e,this.world.entitiesByComponent[t.types[0]])}else{const n=[];for(const e of t.types){const t=this.world.entitiesByComponent[e];if(void 0===t)throw new Error(e+" is not a registered Component/Tag");n.push(t)}e=r.setUnion(e,r.setIntersection(...n))}else if("any"===t.from){const n=[];for(const e of t.types){const t=this.world.entitiesByComponent[e];if(void 0===t)throw new Error(e+" is not a registered Component/Tag");n.push(t)}e=r.setUnion(e,...n)}else"reverse"===t.from&&this.world.entityReverse[t.entity.id]&&this.world.entityReverse[t.entity.id].hasOwnProperty(t.type)&&(e=r.setUnion(e,new Set([...this.world.entityReverse[t.entity.id][t.type].keys()])));this.results=new Set([...e].map(e=>this.world.getEntity(e)).filter(e=>!!e));for(const e of this.results)this._filter(e);return this.trackAdded&&(this.added=new Set(this.results)),this}_filter(e){for(const t of this.query.filters)if("not"===t.filter){for(const n of t.types)if(e.has(n)){this.results.delete(e);break}}else if("only"===t.filter){let n=!1;for(const r of t.types)if(e.has(r)){n=!0;break}n||this.results.delete(e)}}execute(e){if(this.executed||this.refresh(),this.executed=!0,void 0===e||!e.hasOwnProperty("updatedComponents")&&!e.hasOwnProperty("updatedValues"))return this.results;const t=[];for(const n of this.results)e.updatedComponents&&n.updatedComponents<e.updatedComponents||e.updatedValues&&n.updatedValues<e.updatedValues||t.push(n);return new Set(t)}}},function(e,t,n){const r=n(12);e.exports=class{constructor(e,...t){if(this.world=e,this._stagedChanges=[],this.changes=[],this.queries=[],this.lastTick=this.world.currentTick,this.constructor.subscriptions)for(const e of this.constructor.subscriptions)this.subscribe(e);this.init(...t)}init(){}update(e){}createQuery(e){return new r(this.world,this,e)}subscribe(e){"string"!=typeof e&&(e=e.name),this.world.subscriptions.has(e)||(this.world.componentTypes[e].subbed=!0,this.world.subscriptions.set(e,new Set)),this.world.subscriptions.get(e).add(this)}_preUpdate(){this.changes=this._stagedChanges,this._stagedChanges=[],this.world.updateIndexes()}_postUpdate(){for(const e of this.queries)e.clearChanges()}_recvChange(e){this._stagedChanges.push(e)}}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(n,r){function i(){void 0!==o&&e.removeListener("error",o),n([].slice.call(arguments))}var o;"error"!==t&&(o=function(n){e.removeListener(t,i),r(n)},e.once("error",o)),e.once(t,i)}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function h(e,t,n,r){var i,o,a,s;if(u(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=c(e))>0&&a.length>i&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=a.length,s=l,console&&console.warn&&console.warn(s)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=d.bind(r);return i.listener=n,r.wrapFn=i,i}function f(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):g(i,i.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var l=i[e];if(void 0===l)return!1;if("function"==typeof l)o(l,this,t);else{var u=l.length,c=g(l,u);for(n=0;n<u;++n)o(c[n],this,t)}return!0},s.prototype.addListener=function(e,t){return h(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return h(this,e,t,!0)},s.prototype.once=function(e,t){return u(t),this.on(e,p(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,p(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,i,o,a;if(u(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return f(this,e,!0)},s.prototype.rawListeners=function(e){return f(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},s.prototype.listenerCount=m,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(e,t,n){(function(e){var t;t={compressionlevel:-1,editorsettings:{export:{target:"."}},height:100,infinite:!1,layers:[{draworder:"topdown",id:4,name:"World Layout",objects:[{gid:3073,height:38337.6,id:21,name:"World Map",rotation:0,type:"",visible:!0,width:38337.6,x:-5138.67916444398,y:2855.67508895881}],offsetx:-2887.98689881748,offsety:2769.98583384405,opacity:1,type:"objectgroup",visible:!1,x:0,y:0},{data:[1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,1048,1048,1048,1048,1048,1048,1048,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,1543,1048,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,1048,964,964,964,964,964,1048,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,1165,1165,964,964,964,964,1048,964,964,980,2936,2936,1048,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,1165,1165,1165,964,964,964,1048,1048,1048,1048,1048,1048,1048,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,2869,964,964,964,964,2869,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,2869,964,964,2869,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,1165,1165,1165,1165,1165,1165,964,780,964,964,780,964,964,780,964,964,780,964,964,780,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,1165,1165,1165,1165,1165,1165,964,780,964,964,780,964,964,780,964,964,780,964,964,780,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,1165,1165,1165,1165,1165,1165,964,780,964,964,780,964,964,780,964,964,780,964,964,780,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,1165,964,964,964,964,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,1165,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,1165,1165,1165,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,1165,1165,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,1165,1165,1165,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,1165,964,964,964,964,964,964,1165,964,1165,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,1165,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,1165,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,1165,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,1165,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964,964],height:100,id:1,name:"Tile Layer",opacity:1,type:"tilelayer",visible:!0,width:70,x:0,y:0},{data:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,831,831,831,831,831,831,831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,32,32,32,32,32,32,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,831,831,831,831,831,831,831,831,831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,32,32,32,28,28,32,32,32,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,831,831,831,831,831,831,831,831,831,831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,28,28,28,28,28,28,32,32,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,831,831,831,831,831,831,831,831,831,831,831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,32,28,28,28,28,28,28,32,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,831,0,831,831,831,0,831,831,831,831,831,831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,32,32,28,28,28,28,28,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,831,831,831,831,831,831,831,831,831,831,831,831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,32,32,32,32,32,32,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,831,831,831,831,831,831,831,831,0,831,831,831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,900,900,900,900,900,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,831,831,831,831,831,831,831,831,0,831,831,831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,900,900,900,900,900,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,831,831,831,831,831,831,831,831,831,831,831,831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,900,900,900,900,900,900,900,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,831,831,831,831,0,831,831,831,831,831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,900,900,900,900,900,900,900,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,831,831,831,831,831,831,831,831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,831,831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],height:100,id:8,name:"Environment Layer",opacity:1,type:"tilelayer",visible:!0,width:70,x:0,y:0},{draworder:"topdown",id:2,name:"Object Layer",objects:[{height:0,id:1,name:"Fire",point:!0,properties:[{name:"objectType",type:"string",value:"campfire"}],rotation:0,type:"object",visible:!0,width:0,x:1359.43345152199,y:474.20204354433},{height:0,id:2,name:"Crate",point:!0,properties:[{name:"inventory",type:"string",value:"health_potion_weak"},{name:"objectType",type:"string",value:"crate"}],rotation:0,type:"object",visible:!0,width:0,x:1519.48935537457,y:440.741072766735},{height:0,id:3,name:"Crate",point:!0,properties:[{name:"inventory",type:"string",value:""},{name:"objectType",type:"string",value:"crate"}],rotation:0,type:"object",visible:!0,width:0,x:1492.09888714889,y:438.227878496818},{height:0,id:4,name:"Goblin",point:!0,properties:[{name:"objectType",type:"string",value:"goblin"}],rotation:0,type:"object",visible:!0,width:0,x:1443.79118357932,y:520.959011276967},{height:0,id:5,name:"Rat",point:!0,properties:[{name:"objectType",type:"string",value:"rat"}],rotation:0,type:"object",visible:!0,width:0,x:1247.02699102889,y:759.977100331318},{height:0,id:6,name:"Goblin",point:!0,properties:[{name:"objectType",type:"string",value:"goblin"}],rotation:0,type:"object",visible:!0,width:0,x:806.429892890274,y:151.062577766692},{height:0,id:7,name:"Barrel",point:!0,properties:[{name:"inventory",type:"string",value:""},{name:"objectType",type:"string",value:"barrel"}],rotation:0,type:"object",visible:!0,width:0,x:1105.27396337073,y:529.648827795078},{height:0,id:8,name:"Barrel",point:!0,properties:[{name:"inventory",type:"string",value:""},{name:"objectType",type:"string",value:"barrel"}],rotation:0,type:"object",visible:!0,width:0,x:1104.24125747701,y:568.292697425079},{height:0,id:9,name:"Door",point:!0,properties:[{name:"objectType",type:"string",value:"door"}],rotation:0,type:"object",visible:!0,width:0,x:558.804418453541,y:151.072124756335},{height:0,id:10,name:"Barrel",point:!0,properties:[{name:"inventory",type:"string",value:""},{name:"objectType",type:"string",value:"barrel"}],rotation:0,type:"object",visible:!0,width:0,x:595.193249453778,y:217.73525201537},{height:0,id:11,name:"Dead Body",point:!0,properties:[{name:"objectType",type:"string",value:"dead_body"}],rotation:0,type:"object",visible:!0,width:0,x:656.219392752204,y:180.818202365705},{height:0,id:12,name:"Player",point:!0,properties:[{name:"objectType",type:"string",value:"player"}],rotation:0,type:"object",visible:!0,width:0,x:11.9135881457158,y:627.183739576656},{height:0,id:13,name:"Load Door",point:!0,properties:[{name:"levelName",type:"string",value:"durdwin_001"},{name:"objectType",type:"string",value:"load_door"}],rotation:0,type:"object",visible:!0,width:0,x:1710.30519759869,y:630.284396617986},{height:0,id:16,name:"Chest",point:!0,properties:[{name:"inventory",type:"string",value:"confuse_scroll"},{name:"objectType",type:"string",value:"chest"}],rotation:0,type:"object",visible:!0,width:0,x:1073.2833237161,y:1112.95441431044},{height:0,id:31,name:"Bandit",point:!0,properties:[{name:"fallbackPosition",type:"object",value:32},{name:"objectType",type:"string",value:"bandit"},{name:"patrolTarget",type:"object",value:25}],rotation:0,type:"object",visible:!0,width:0,x:304.373875692173,y:1398.22503366288},{height:0,id:35,name:"Bandit Mage",point:!0,properties:[{name:"fallbackPosition",type:"object",value:32},{name:"inventory",type:"string",value:""},{name:"objectType",type:"string",value:"bandit_mage"},{name:"patrolTarget",type:"object",value:25}],rotation:0,type:"object",visible:!0,width:0,x:273.664559134681,y:1395.76424540602},{height:0,id:36,name:"Bandit",point:!0,properties:[{name:"fallbackPosition",type:"object",value:32},{name:"objectType",type:"string",value:"bandit"},{name:"patrolTarget",type:"object",value:25}],rotation:0,type:"object",visible:!0,width:0,x:303.835220653339,y:1431.56717461205},{height:0,id:37,name:"Attacking Tutorial Trigger",point:!0,properties:[{name:"event",type:"string",value:"tutorial.attacking"},{name:"objectType",type:"string",value:"event_trigger"}],rotation:0,type:"object",visible:!0,width:0,x:1067.03309833911,y:786.234914565659},{height:0,id:38,name:"Attacking Tutorial Trigger",point:!0,properties:[{name:"event",type:"string",value:"tutorial.attacking"},{name:"objectType",type:"string",value:"event_trigger"}],rotation:0,type:"object",visible:!0,width:0,x:372.804397180069,y:184.012426813239},{height:0,id:70,name:"Bandit White Mage",point:!0,properties:[{name:"inventory",type:"string",value:""},{name:"objectType",type:"string",value:"bandit_white_mage"}],rotation:0,type:"object",visible:!0,width:0,x:1362.11068612911,y:694.715478885333}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0},{draworder:"topdown",id:5,name:"Node Layer",objects:[{height:0,id:30,name:"Patrol Path",point:!0,properties:[{name:"next",type:"object",value:25},{name:"pathName",type:"string",value:"forrest_path_01"}],rotation:0,type:"path_node",visible:!0,width:0,x:952.329808799347,y:1396.68717326633},{height:0,id:29,name:"Patrol Path",point:!0,properties:[{name:"next",type:"object",value:30},{name:"pathName",type:"string",value:"forrest_path_01"}],rotation:0,type:"path_node",visible:!0,width:0,x:956.098950243405,y:2074.03948567639},{height:0,id:26,name:"Patrol Path",point:!0,properties:[{name:"next",type:"object",value:29},{name:"pathName",type:"string",value:"forrest_path_01"}],rotation:0,type:"path_node",visible:!0,width:0,x:192.671667569103,y:2128.71751613854},{height:0,id:25,name:"Patrol Path",point:!0,properties:[{name:"next",type:"object",value:26},{name:"pathName",type:"string",value:"forrest_path_01"}],rotation:0,type:"path_node",visible:!0,width:0,x:217.391304347826,y:1366.930171278},{height:0,id:32,name:"Fallback Position",point:!0,rotation:0,type:"fallback_node",visible:!0,width:0,x:338.912712685019,y:1521.648914096}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:9,nextobjectid:71,orientation:"orthogonal",renderorder:"right-down",tiledversion:"1.4.3",tileheight:32,tilesets:[{firstgid:1,source:"DungeonCrawl_ProjectUtumnoTileset.tsx"},{firstgid:3073,source:"World.tsx"}],tilewidth:32,type:"map",version:1.4,width:70},"undefined"==typeof onTileMapLoaded?("undefined"==typeof TileMaps&&(TileMaps={}),TileMaps.forrest_001=t):onTileMapLoaded("forrest_001",t),e&&e.exports&&(e.exports=t)}).call(this,n(8)(e))},function(e,t,n){(function(e){var t;t={compressionlevel:-1,editorsettings:{export:{target:"."}},height:39,infinite:!1,layers:[{data:[1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,2936,2936,2936,900,1048,1048,1048,900,900,900,900,900,900,900,2869,900,900,900,2869,900,900,900,2869,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,1048,1048,1048,900,900,900,900,900,2710,2710,2710,2710,2710,2710,2710,2710,2710,2710,2710,2710,2710,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,1048,1048,1048,900,900,900,900,900,2710,2710,2710,2710,2710,2710,2710,2710,2710,2710,2710,2710,2710,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,2869,900,900,900,2869,900,900,900,2869,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,1048,1048,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,1048,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,1048,1048,1048,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,1048,1048,1048,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048],height:39,id:1,name:"Tile Layer",opacity:1,type:"tilelayer",visible:!0,width:70,x:0,y:0},{draworder:"topdown",id:4,name:"Object Layer",objects:[{height:0,id:4,name:"Player",point:!0,properties:[{name:"objectType",type:"string",value:"player"}],rotation:0,type:"object",visible:!0,width:0,x:48.9730893444762,y:727.91157376972},{height:0,id:5,name:"Golbin",point:!0,properties:[{name:"objectType",type:"string",value:"goblin"}],rotation:0,type:"object",visible:!0,width:0,x:644.193719444052,y:712.330540708638},{height:0,id:6,name:"Chest",point:!0,properties:[{name:"inventory",type:"string",value:"health_potion_weak,lightning_scroll_weak"},{name:"objectType",type:"string",value:"chest"}],rotation:0,type:"object",visible:!0,width:0,x:341.526275397425,y:948.672967850652},{height:0,id:7,name:"Stairs",point:!0,properties:[{name:"levelName",type:"string",value:"level_2"},{name:"objectType",type:"string",value:"stairs"}],rotation:0,type:"object",visible:!0,width:0,x:1202.30788561211,y:247.937747564976},{height:0,id:8,name:"Crate",point:!0,properties:[{name:"inventory",type:"string",value:"health_potion_weak"},{name:"objectType",type:"string",value:"crate"}],rotation:0,type:"object",visible:!0,width:0,x:370.617261554132,y:949.94792690583},{height:0,id:9,name:"Crate",point:!0,properties:[{name:"inventory",type:"string",value:""},{name:"objectType",type:"string",value:"crate"}],rotation:0,type:"object",visible:!0,width:0,x:944.729776321084,y:725.333340842067},{height:0,id:11,name:"Crate",point:!0,properties:[{name:"inventory",type:"string",value:"health_potion_weak"},{name:"objectType",type:"string",value:"crate"}],rotation:0,type:"object",visible:!0,width:0,x:943.603906892819,y:760.182468483655},{height:0,id:12,name:"Golbin",point:!0,properties:[{name:"objectType",type:"string",value:"goblin"}],rotation:0,type:"object",visible:!0,width:0,x:340.545596044442,y:1083.26097831731},{height:0,id:14,name:"Fire",point:!0,properties:[{name:"objectType",type:"string",value:"campfire"}],rotation:0,type:"object",visible:!0,width:0,x:658.781710294825,y:237.201980125518},{height:0,id:15,name:"Fire",point:!0,properties:[{name:"objectType",type:"string",value:"campfire"}],rotation:0,type:"object",visible:!0,width:0,x:786.258618604088,y:238.296842869239},{height:0,id:16,name:"Fire",point:!0,properties:[{name:"objectType",type:"string",value:"campfire"}],rotation:0,type:"object",visible:!0,width:0,x:910.850368936736,y:239.506471513245},{height:0,id:17,name:"Lantern",point:!0,properties:[{name:"objectType",type:"string",value:"lantern"}],rotation:0,type:"object",visible:!0,width:0,x:209.265755413088,y:951.97774283295},{height:0,id:18,name:"Golbin",point:!0,properties:[{name:"objectType",type:"string",value:"goblin"}],rotation:0,type:"object",visible:!0,width:0,x:949.558485544938,y:145.155437280755},{height:0,id:19,name:"Golbin",point:!0,properties:[{name:"objectType",type:"string",value:"goblin"}],rotation:0,type:"object",visible:!0,width:0,x:622.958751663239,y:147.574694568767},{height:0,id:20,name:"Rat",point:!0,properties:[{name:"objectType",type:"string",value:"rat"}],rotation:0,type:"object",visible:!0,width:0,x:244.344986089271,y:226.200556429176},{height:0,id:22,name:"Load Door",point:!0,properties:[{name:"levelName",type:"string",value:"forrest_001"},{name:"objectType",type:"string",value:"load_door"}],rotation:0,type:"object",visible:!0,width:0,x:14.605418138987,y:723.203769140165},{height:0,id:29,name:"Door",point:!0,properties:[{name:"objectType",type:"string",value:"door"}],rotation:0,type:"object",visible:!0,width:0,x:526.910048927362,y:728.264960481746}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:5,nextobjectid:30,orientation:"orthogonal",renderorder:"right-down",tiledversion:"1.4.2",tileheight:32,tilesets:[{firstgid:1,source:"DungeonCrawl_ProjectUtumnoTileset.tsx"}],tilewidth:32,type:"map",version:1.4,width:70},"undefined"==typeof onTileMapLoaded?("undefined"==typeof TileMaps&&(TileMaps={}),TileMaps.durdwin_001=t):onTileMapLoaded("durdwin_001",t),e&&e.exports&&(e.exports=t)}).call(this,n(8)(e))},function(e,t,n){(function(e){var t;t={compressionlevel:-1,editorsettings:{export:{target:"."}},height:39,infinite:!1,layers:[{data:[1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,1048,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,1048,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,1048,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,1048,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,1048,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,1048,1048,1048,1048,1048,1048,1048,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048],height:39,id:1,name:"Tile Layer 1",opacity:1,type:"tilelayer",visible:!0,width:70,x:0,y:0},{draworder:"topdown",id:2,name:"Object Layer 1",objects:[{height:0,id:1,name:"Player",point:!0,properties:[{name:"objectType",type:"string",value:"player"}],rotation:0,type:"object",visible:!0,width:0,x:880.250035462825,y:754.192197850584},{height:0,id:2,name:"Door",point:!0,properties:[{name:"objectType",type:"string",value:"door"}],rotation:0,type:"object",visible:!0,width:0,x:1297.45889387145,y:627.80269058296},{height:0,id:3,name:"Water Sprite",point:!0,properties:[{name:"objectType",type:"string",value:"water_sprite"}],rotation:0,type:"object",visible:!0,width:0,x:1297.45889387145,y:488.789237668161},{height:0,id:4,name:"Chest",point:!0,properties:[{name:"inventory",type:"string",value:"health_potion_weak,lightning_scroll_weak"},{name:"objectType",type:"string",value:"chest"}],rotation:0,type:"object",visible:!0,width:0,x:1166.46397769314,y:887.051192293996},{height:0,id:5,name:"Lantern",point:!0,properties:[{name:"objectType",type:"string",value:"lantern"}],rotation:0,type:"object",visible:!0,width:0,x:1139.76083707025,y:757.847533632287},{height:0,id:6,name:"Chest",point:!0,properties:[{name:"inventory",type:"string",value:"health_potion_weak,health_potion_weak"},{name:"objectType",type:"string",value:"chest"}],rotation:0,type:"object",visible:!0,width:0,x:1038.86397608371,y:887.144992526158},{height:0,id:7,name:"Magika Shrine",point:!0,properties:[{name:"objectType",type:"string",value:"magic_shrine"},{name:"spellId",type:"string",value:"lightning_bolt"}],rotation:0,type:"object",visible:!0,width:0,x:1425.26158445441,y:760.837070254111},{height:0,id:8,name:"Crate",point:!0,properties:[{name:"inventory",type:"string",value:"health_potion_weak"},{name:"objectType",type:"string",value:"crate"}],rotation:0,type:"object",visible:!0,width:0,x:1135.27653213752,y:887.144992526158},{height:0,id:9,name:"Door",point:!0,properties:[{name:"objectType",type:"string",value:"door"}],rotation:0,type:"object",visible:!0,width:0,x:1039.61136023916,y:630.792227204783},{height:0,id:10,name:"Goblin Brute",point:!0,properties:[{name:"objectType",type:"string",value:"goblin_brute"}],rotation:0,type:"object",visible:!0,width:0,x:1043.34828101644,y:507.473841554559},{height:0,id:11,name:"Barrel",point:!0,properties:[{name:"inventory",type:"string",value:"health_potion"},{name:"objectType",type:"string",value:"barrel"}],rotation:0,type:"object",visible:!0,width:0,x:1202.4730820996,y:883.664199192463}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:3,nextobjectid:12,orientation:"orthogonal",renderorder:"right-down",tiledversion:"1.4.2",tileheight:32,tilesets:[{firstgid:1,source:"DungeonCrawl_ProjectUtumnoTileset.tsx"}],tilewidth:32,type:"map",version:1.4,width:70},"undefined"==typeof onTileMapLoaded?("undefined"==typeof TileMaps&&(TileMaps={}),TileMaps.dev_room=t):onTileMapLoaded("dev_room",t),e&&e.exports&&(e.exports=t)}).call(this,n(8)(e))},function(e,t){class n extends Set{constructor(e,t,n){super(),this.component=e,this.field=n,this.sub="__set__",t=t.map(e=>"string"==typeof e?e:e.id),this.dvalue=t;for(const e of t)this.add(e)}_reset(){this.clear();for(const e of this.dvalue)this.add(e)}add(e){e.id&&(e=e.id),this.component._addRef(e,this.field,"__set__"),super.add(e)}delete(e){e.id&&(e=e.id),this.component._deleteRef(e,this.field,"__set__");return super.delete(e)}has(e){return e.id&&(e=e.id),super.has(e)}[Symbol.iterator](){const e=this,t=super[Symbol.iterator]();return{next(){const n=t.next();return"string"==typeof n.value&&(n.value=e.component.entity.world.getEntity(n.value)),n}}}getValue(){return[...this].map(e=>e.id)}}e.exports={EntityRef(e,t,n){t=t||null,e.hasOwnProperty(n)||Object.defineProperty(e,n,{get:()=>e.world.getEntity(e._meta.values[n]),set(t){const r=e._meta.values[n];t=t&&"string"!=typeof t?t.id:t,r&&r!==t&&e._deleteRef(r,n,void 0),t&&t!==r&&e._addRef(t,n,void 0),e._meta.values[n]=t}}),e[n]=t},EntityObject(e,t,n){e._meta.values[n]=t||{};const r=e._meta.values[n],i=Object.keys(r);for(const e of i)r[e]&&r[e].id&&(r[e]=r[e].id);return new Proxy(e._meta.values[n],{get:(t,n)=>e.world.getEntity(t[n]),set(t,r,i){const o=t[r];return i&&i.id&&(i=i.id),t[r]=i,o&&o!==i&&e._deleteRef(o,`${n}.${r}`,"__obj__"),i&&i!==o&&e._addRef(i,`${n}.${r}`,"__obj__"),!0},deleteProperty(t,r){if(!t.hasOwnProperty(r))return!1;const i=t[r];return delete t[r],e._deleteRef(i,`${n}.${r}`,"__obj__"),!0}})},EntitySet:(e,t=[],r)=>new n(e,t,r)}},function(e,t,n){const r=n(7),i=n(12),o=n(21),a=n(22),s=n(23),l=new Set(["constructor","init","type","key","destroy","preDestroy","postDestroy","getObject","_setup","_reset","update","clone","_meta","_addRef","_deleteRef","prototype"]);e.exports=class{constructor(e){this.config=Object.assign({trackChanges:!0,entityPool:10,cleanupPools:!0,useApeDestroy:!1},e),this.currentTick=0,this.entities=new Map,this.types={},this.tags=new Set,this.entitiesByComponent={},this.componentsById=new Map,this.entityReverse={},this.updatedEntities=new Set,this.componentTypes={},this.components=new Map,this.queries=[],this.subscriptions=new Map,this.systems=new Map,this.refs={},this.componentPool=new Map,this._statCallback=null,this._statTicks=0,this._nextStat=0,this.entityPool=new a(this,this.config.entityPool),this.config.useApeDestroy&&s(this)}tick(){if(this.config.useApeDestroy&&this.runSystems("ApeCleanup"),this.currentTick++,this.updateIndexes(),this.entityPool.release(),this.config.cleanupPools){this.entityPool.cleanup();for(const[e,t]of this.componentPool)t.cleanup()}return this._statCallback&&(this._nextStat+=1,this._nextStat>=this._statTicks&&this._outputStats()),this.currentTick}getStats(){const e={entity:{active:this.entities.size,pooled:this.entityPool.pool.length,target:this.entityPool.targetSize},components:{}};for(const[t,n]of this.componentPool)e.components[t]={active:n.active,pooled:n.pool.length,target:n.targetSize};return e}logStats(e,t){void 0===t&&(t=console.log),this._statCallback=t,this._statTicks=e,this._nextStat=0}_outputStats(){const e=this.getStats();this._nextStat=0;let t=`${this.currentTick}, Entities: ${e.entity.active} active, ${e.entity.pooled}/${e.entity.target} pooled`;for(const n of Object.keys(e.components)){const r=e.components[n];t+=`\n${this.currentTick}, ${n}: ${r.active} active, ${r.pooled}/${r.target} pooled`}this._statCallback(t)}_addRef(e,t,n,r,i,o,a){this.refs[e]||(this.refs[e]=new Set);this.getEntity(e);this.entityReverse.hasOwnProperty(e)||(this.entityReverse[e]={}),this.entityReverse[e].hasOwnProperty(o)||(this.entityReverse[e][o]=new Map);const s=this.entityReverse[e][o];let l=s.get(t);void 0===l&&(l=0),s.set(t,l+1),this.refs[e].add([t,n,r,i].join("...")),this._sendChange({op:"addRef",component:n,type:a,property:r,target:e,entity:t})}_deleteRef(e,t,n,r,i,o,a){const s=this.entityReverse[e][o];let l=s.get(t);l--,l<1?s.delete(t):s.set(t,l),0===s.size&&delete s[o],this.refs[e].delete([t,n,r,i].join("...")),0===this.refs[e].size&&delete this.refs[e],this._sendChange({op:"deleteRef",component:n,type:a,target:e,entity:t,property:r})}registerTags(...e){for(const t of e){if(this.entitiesByComponent.hasOwnProperty(t))throw new Error(`Cannot register tag "${t}", name is already taken.`);this.entitiesByComponent[t]=new Set,this.tags.add(t)}}registerComponent(e,t=1){e.typeName&&e.name!==e.typeName&&Object.defineProperty(e,"name",{value:e.typeName});const n=e.name;if(this.tags.has(n))throw new Error(`registerComponent: Tag already defined for "${n}"`);if(this.componentTypes.hasOwnProperty(n))throw new Error(`registerComponent: Component already defined for "${n}"`);if(this.componentTypes[n]=e,!e.registered){e.registered=!0,e.fields=Object.keys(e.properties),e.primitives={},e.factories={};for(const t of e.fields){if(l.has(t))throw new Error(`Error registering ${e.name}: Reserved property name "${t}"`);"function"==typeof e.properties[t]?e.factories[t]=e.properties[t]:e.primitives[t]=e.properties[t]}}this.entitiesByComponent[n]=new Set,this.componentPool.set(n,new o(this,n,t))}createEntity(e){return this.entityPool.get(e)}getObject(){const e=[];for(const t of this.entities)e.push(t[1].getObject());return e}createEntities(e){for(const t of e)this.createEntity(t)}copyTypes(e,t){for(const n of t)if(e.tags.has(n))this.registerTags(n);else{const t=e.componentTypes[n];this.componentTypes[n]=t,this.entitiesByComponent[n]=new Set,this.componentPool.set(n,new o(this,n,1))}}removeEntity(e){let t;e instanceof r?(t=e,e=t.id):t=this.getEntity(e),t.destroy()}getEntity(e){return this.entities.get(e)}getEntities(e){"string"!=typeof e&&(e=e.name);const t=[...this.entitiesByComponent[e]];return new Set(t.map(e=>this.getEntity(e)))}getComponent(e){return this.componentsById.get(e)}createQuery(e){return new i(this,null,e)}_sendChange(e){if(this.componentTypes[e.type].subbed){const t=this.subscriptions.get(e.type);if(!t)return;for(const n of t)n._recvChange(e)}}registerSystem(e,t,n){return n=n||[],"function"==typeof t&&(t=new t(this,...n)),this.systems.has(e)||this.systems.set(e,new Set),this.systems.get(e).add(t),t}runSystems(e){const t=this.systems.get(e);if(t)for(const e of t)e._preUpdate(),e.update(this.currentTick),e._postUpdate(),e.lastTick=this.currentTick,0!==e.changes.length&&(e.changes=[])}_entityUpdated(e){this.config.trackChanges&&this.updatedEntities.add(e)}_addEntityComponent(e,t){this.entitiesByComponent[e].add(t.id)}_deleteEntityComponent(e){this.entitiesByComponent[e.type].delete(e._meta.entityId)}_clearIndexes(e){for(const t of this.queries)t._removeEntity(e);this.updatedEntities.delete(e)}updateIndexes(){for(const e of this.updatedEntities)this._updateIndexesEntity(e);this.updatedEntities.clear()}_updateIndexesEntity(e){for(const t of this.queries)t.update(e)}}},function(e,t){e.exports=class{constructor(e,t,n){this.world=e,this.type=t,this.klass=this.world.componentTypes[this.type],this.pool=[],this.targetSize=n,this.active=0,this.spinUp(n)}get(e,t){let n;return n=0===this.pool.length?new this.klass(this.world):this.pool.pop(),n._setup(e,t),this.active++,n}release(e){e._reset(),this.pool.push(e),this.active--}cleanup(){if(this.pool.length>2*this.targetSize){const e=this.pool.length-this.targetSize,t=Math.max(Math.min(20,e),Math.floor(e/4));for(let e=0;e<t;e++)this.pool.pop()}}spinUp(e){for(let t=0;t<e;t++){const e=new this.klass(this.world);this.pool.push(e)}this.targetSize=Math.max(this.targetSize,this.pool.length)}}},function(e,t,n){const r=n(7);e.exports=class{constructor(e,t){this.world=e,this.pool=[],this.destroyed=[],this.worldEntity=class extends r{},this.worldEntity.prototype.world=this.world,this.spinUp(t),this.targetSize=t}destroy(e){this.destroyed.push(e)}get(e,t=!1){let n;return n=0===this.pool.length?new this.worldEntity:this.pool.pop(),n._setup(e,t),n}release(){for(;this.destroyed.length>0;){const e=this.destroyed.pop();this.pool.push(e)}}cleanup(){if(this.pool.length>2*this.targetSize){const e=this.pool.length-this.targetSize,t=Math.max(Math.min(20,e),Math.floor(e/4));for(let e=0;e<t;e++)this.pool.pop()}}spinUp(e){for(let t=0;t<e;t++){const e=new this.worldEntity;this.pool.push(e)}this.targetSize=Math.max(this.targetSize,this.pool.length)}}},function(e,t,n){const r=n(13);class i extends r{init(){this.destroyQuery=this.createQuery({includeApeDestroy:!0}).fromAll("ApeDestroy").persist()}update(){const e=this.destroyQuery.execute();for(const t of e)t.destroy()}}e.exports=function(e){e.registerTags("ApeDestroy"),e.registerSystem("ApeCleanup",i)}},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var l,u=[],c=!1,h=-1;function d(){c&&l&&(c=!1,l.length?u=l.concat(u):h=-1,u.length&&p())}function p(){if(!c){var e=s(d);c=!0;for(var t=u.length;t;){for(l=u,u=[];++h<t;)l&&l[h].run();h=-1,t=u.length}l=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new f(e,t)),1!==u.length||c||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"TYPE_TEXT",(function(){return C})),n.d(r,"TYPE_NEWLINE",(function(){return T})),n.d(r,"TYPE_FG",(function(){return E})),n.d(r,"TYPE_BG",(function(){return S})),n.d(r,"measure",(function(){return k})),n.d(r,"tokenize",(function(){return A}));var i={Game:null,animationFrameID:null,gameEventEmitter:null,document:null,window:null},o=n(15),a=n(0),s=n(5),l=n(6);
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
class u extends l.a{constructor(){super(),this._ctx=document.createElement("canvas").getContext("2d")}getContainer(){return this._ctx.canvas}setOptions(e){super.setOptions(e);const t=`${e.fontStyle?e.fontStyle+" ":""} ${e.fontSize}px ${e.fontFamily}`;this._ctx.font=t,this._updateSize(),this._ctx.font=t,this._ctx.textAlign="center",this._ctx.textBaseline="middle"}clear(){this._ctx.fillStyle=this._options.bg,this._ctx.fillRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height)}eventToPosition(e,t){const n=this._ctx.canvas,r=n.getBoundingClientRect();return e-=r.left,t-=r.top,e*=n.width/r.width,t*=n.height/r.height,e<0||t<0||e>=n.width||t>=n.height?[-1,-1]:this._normalizedEventToPosition(e,t)}}var c=n(4);
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */class h extends u{constructor(){super(),this._spacingX=0,this._spacingY=0,this._hexSize=0}draw(e,t){const[n,r,i,o,a]=e,s=[(n+1)*this._spacingX,r*this._spacingY+this._hexSize];if(this._options.transpose&&s.reverse(),t&&(this._ctx.fillStyle=a,this._fill(s[0],s[1])),!i)return;this._ctx.fillStyle=o;const l=[].concat(i);for(let e=0;e<l.length;e++)this._ctx.fillText(l[e],s[0],Math.ceil(s[1]))}computeSize(e,t){this._options.transpose&&(e+=t,e-=t=e-t);return[Math.floor(e/this._spacingX)-1,Math.floor((t-2*this._hexSize)/this._spacingY+1)]}computeFontSize(e,t){this._options.transpose&&(e+=t,e-=t=e-t);const n=2*e/((this._options.width+1)*Math.sqrt(3))-1,r=t/(2+1.5*(this._options.height-1));let i=Math.min(n,r);const o=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;const a=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=o;const s=a/100;i=Math.floor(i)+1;const l=2*i/(this._options.spacing*(1+s/Math.sqrt(3)));return Math.ceil(l)-1}_normalizedEventToPosition(e,t){let n;this._options.transpose?(e+=t,e-=t=e-t,n=this._ctx.canvas.width):n=this._ctx.canvas.height;const r=n/this._options.height;return t=Math.floor(t/r),Object(c.mod)(t,2)?(e-=this._spacingX,e=1+2*Math.floor(e/(2*this._spacingX))):e=2*Math.floor(e/(2*this._spacingX)),[e,t]}_fill(e,t){const n=this._hexSize,r=this._options.border,i=this._ctx;i.beginPath(),this._options.transpose?(i.moveTo(e-n+r,t),i.lineTo(e-n/2+r,t+this._spacingX-r),i.lineTo(e+n/2-r,t+this._spacingX-r),i.lineTo(e+n-r,t),i.lineTo(e+n/2-r,t-this._spacingX+r),i.lineTo(e-n/2+r,t-this._spacingX+r),i.lineTo(e-n+r,t)):(i.moveTo(e,t-n+r),i.lineTo(e+this._spacingX-r,t-n/2+r),i.lineTo(e+this._spacingX-r,t+n/2-r),i.lineTo(e,t+n-r),i.lineTo(e-this._spacingX+r,t+n/2-r),i.lineTo(e-this._spacingX+r,t-n/2+r),i.lineTo(e,t-n+r)),i.fill()}_updateSize(){const e=this._options,t=Math.ceil(this._ctx.measureText("W").width);let n,r;this._hexSize=Math.floor(e.spacing*(e.fontSize+t/Math.sqrt(3))/2),this._spacingX=this._hexSize*Math.sqrt(3)/2,this._spacingY=1.5*this._hexSize,e.transpose?(n="height",r="width"):(n="width",r="height"),this._ctx.canvas[n]=Math.ceil((e.width+1)*this._spacingX),this._ctx.canvas[r]=Math.ceil((e.height-1)*this._spacingY+2*this._hexSize)}}
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */class d extends u{constructor(){super(),this._spacingX=0,this._spacingY=0,this._canvasCache={}}setOptions(e){super.setOptions(e),this._canvasCache={}}draw(e,t){d.cache?this._drawWithCache(e):this._drawNoCache(e,t)}_drawWithCache(e){const[t,n,r,i,o]=e,a=""+r+i+o;let s;if(a in this._canvasCache)s=this._canvasCache[a];else{const e=this._options.border;s=document.createElement("canvas");const t=s.getContext("2d");if(s.width=this._spacingX,s.height=this._spacingY,t.fillStyle=o,t.fillRect(e,e,s.width-e,s.height-e),r){t.fillStyle=i,t.font=this._ctx.font,t.textAlign="center",t.textBaseline="middle";const e=[].concat(r);for(let n=0;n<e.length;n++)t.fillText(e[n],this._spacingX/2,Math.ceil(this._spacingY/2))}this._canvasCache[a]=s}this._ctx.drawImage(s,t*this._spacingX,n*this._spacingY)}_drawNoCache(e,t){const[n,r,i,o,a]=e;if(t){const e=this._options.border;this._ctx.fillStyle=a,this._ctx.fillRect(n*this._spacingX+e,r*this._spacingY+e,this._spacingX-e,this._spacingY-e)}if(!i)return;this._ctx.fillStyle=o;const s=[].concat(i);for(let e=0;e<s.length;e++)this._ctx.fillText(s[e],(n+.5)*this._spacingX,Math.ceil((r+.5)*this._spacingY))}computeSize(e,t){return[Math.floor(e/this._spacingX),Math.floor(t/this._spacingY)]}computeFontSize(e,t){const n=Math.floor(e/this._options.width);let r=Math.floor(t/this._options.height);const i=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;const o=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=i;const a=o/100*r/n;return a>1&&(r=Math.floor(r/a)),Math.floor(r/this._options.spacing)}_normalizedEventToPosition(e,t){return[Math.floor(e/this._spacingX),Math.floor(t/this._spacingY)]}_updateSize(){const e=this._options,t=Math.ceil(this._ctx.measureText("W").width);this._spacingX=Math.ceil(e.spacing*t),this._spacingY=Math.ceil(e.spacing*e.fontSize),e.forceSquareRatio&&(this._spacingX=this._spacingY=Math.max(this._spacingX,this._spacingY)),this._ctx.canvas.width=e.width*this._spacingX,this._ctx.canvas.height=e.height*this._spacingY}}d.cache=!0;
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
class p extends u{constructor(){super(),this._colorCanvas=document.createElement("canvas")}draw(e,t){const[n,r,i,o,a]=e,s=this._options.tileWidth,l=this._options.tileHeight;if(t&&(this._options.tileColorize?this._ctx.clearRect(n*s,r*l,s,l):(this._ctx.fillStyle=a,this._ctx.fillRect(n*s,r*l,s,l))),!i)return;const u=[].concat(i),c=[].concat(o),h=[].concat(a);for(let e=0;e<u.length;e++){const t=this._options.tileMap[u[e]];if(!t)throw new Error(`Char "${u[e]}" not found in tileMap`);if(this._options.tileColorize){const i=this._colorCanvas,o=i.getContext("2d");o.globalCompositeOperation="source-over",o.clearRect(0,0,s,l);const a=c[e],u=h[e];o.drawImage(this._options.tileSet,t[0],t[1],s,l,0,0,s,l),"transparent"!==a&&(o.fillStyle=a,o.globalCompositeOperation="source-atop",o.fillRect(0,0,s,l)),"transparent"!==u&&(o.fillStyle=u,o.globalCompositeOperation="destination-over",o.fillRect(0,0,s,l)),this._ctx.drawImage(i,n*s,r*l,s,l)}else this._ctx.drawImage(this._options.tileSet,t[0],t[1],s,l,n*s,r*l,s,l)}}computeSize(e,t){return[Math.floor(e/this._options.tileWidth),Math.floor(t/this._options.tileHeight)]}computeFontSize(){throw new Error("Tile backend does not understand font size")}_normalizedEventToPosition(e,t){return[Math.floor(e/this._options.tileWidth),Math.floor(t/this._options.tileHeight)]}_updateSize(){const e=this._options;this._ctx.canvas.width=e.width*e.tileWidth,this._ctx.canvas.height=e.height*e.tileHeight,this._colorCanvas.width=e.tileWidth,this._colorCanvas.height=e.tileHeight}}var f=n(2);
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */class m extends l.a{constructor(){super(),this._uniforms={};try{this._gl=this._initWebGL()}catch(e){alert(e.message)}}static isSupported(){return!!document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0})}getContainer(){return this._gl.canvas}setOptions(e){super.setOptions(e),this._updateSize();const t=this._options.tileSet;t&&"complete"in t&&!t.complete?t.addEventListener("load",()=>this._updateTexture(t)):this._updateTexture(t)}draw(e,t){const n=this._gl,r=this._options,[i,o,a,s,l]=e,u=n.canvas.height-(o+1)*r.tileHeight;if(n.scissor(i*r.tileWidth,u,r.tileWidth,r.tileHeight),t&&(r.tileColorize?n.clearColor(0,0,0,0):n.clearColor(...w(l)),n.clear(n.COLOR_BUFFER_BIT)),!a)return;const c=[].concat(a),h=[].concat(l),d=[].concat(s);n.uniform2fv(this._uniforms.targetPosRel,[i,o]);for(let e=0;e<c.length;e++){const t=this._options.tileMap[c[e]];if(!t)throw new Error(`Char "${c[e]}" not found in tileMap`);n.uniform1f(this._uniforms.colorize,r.tileColorize?1:0),n.uniform2fv(this._uniforms.tilesetPosAbs,t),r.tileColorize&&(n.uniform4fv(this._uniforms.tint,w(d[e])),n.uniform4fv(this._uniforms.bg,w(h[e]))),n.drawArrays(n.TRIANGLE_STRIP,0,4)}}clear(){const e=this._gl;e.clearColor(...w(this._options.bg)),e.scissor(0,0,e.canvas.width,e.canvas.height),e.clear(e.COLOR_BUFFER_BIT)}computeSize(e,t){return[Math.floor(e/this._options.tileWidth),Math.floor(t/this._options.tileHeight)]}computeFontSize(){throw new Error("Tile backend does not understand font size")}eventToPosition(e,t){const n=this._gl.canvas,r=n.getBoundingClientRect();return e-=r.left,t-=r.top,e*=n.width/r.width,t*=n.height/r.height,e<0||t<0||e>=n.width||t>=n.height?[-1,-1]:this._normalizedEventToPosition(e,t)}_initWebGL(){const e=document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0});window.gl=e;const t=function(e,t,n){const r=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(r)||"");const i=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(i,n),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(i)||"");const o=e.createProgram();if(e.attachShader(o,r),e.attachShader(o,i),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS))throw new Error(e.getProgramInfoLog(o)||"");return o}(e,y,v);return e.useProgram(t),function(e){const t=new Float32Array([0,0,1,0,0,1,1,1]),n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0)}(e),g.forEach(n=>this._uniforms[n]=e.getUniformLocation(t,n)),this._program=t,e.enable(e.BLEND),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.enable(e.SCISSOR_TEST),e}_normalizedEventToPosition(e,t){return[Math.floor(e/this._options.tileWidth),Math.floor(t/this._options.tileHeight)]}_updateSize(){const e=this._gl,t=this._options,n=[t.width*t.tileWidth,t.height*t.tileHeight];e.canvas.width=n[0],e.canvas.height=n[1],e.viewport(0,0,n[0],n[1]),e.uniform2fv(this._uniforms.tileSize,[t.tileWidth,t.tileHeight]),e.uniform2fv(this._uniforms.targetSize,n)}_updateTexture(e){!function(e,t){const n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t)}(this._gl,e)}}const g=["targetPosRel","tilesetPosAbs","tileSize","targetSize","colorize","bg","tint"],y="\n#version 300 es\n\nin vec2 tilePosRel;\nout vec2 tilesetPosPx;\n\nuniform vec2 tilesetPosAbs;\nuniform vec2 tileSize;\nuniform vec2 targetSize;\nuniform vec2 targetPosRel;\n\nvoid main() {\n    vec2 targetPosPx = (targetPosRel + tilePosRel) * tileSize;\n    vec2 targetPosNdc = ((targetPosPx / targetSize)-0.5)*2.0;\n    targetPosNdc.y *= -1.0;\n\n    gl_Position = vec4(targetPosNdc, 0.0, 1.0);\n    tilesetPosPx = tilesetPosAbs + tilePosRel * tileSize;\n}".trim(),v="\n#version 300 es\nprecision highp float;\n\nin vec2 tilesetPosPx;\nout vec4 fragColor;\nuniform sampler2D image;\nuniform bool colorize;\nuniform vec4 bg;\nuniform vec4 tint;\n\nvoid main() {\n    fragColor = vec4(0, 0, 0, 1);\n\n    vec4 texel = texelFetch(image, ivec2(tilesetPosPx), 0);\n\n    if (colorize) {\n        texel.rgb = tint.a * tint.rgb + (1.0-tint.a) * texel.rgb;\n        fragColor.rgb = texel.a*texel.rgb + (1.0-texel.a)*bg.rgb;\n        fragColor.a = texel.a + (1.0-texel.a)*bg.a;\n    } else {\n        fragColor = texel;\n    }\n}".trim();const _={};function w(e){if(!(e in _)){let t;if("transparent"===e)t=[0,0,0,0];else if(e.indexOf("rgba")>-1){t=(e.match(/[\d.]+/g)||[]).map(Number);for(let e=0;e<3;e++)t[e]=t[e]/255}else t=f.fromString(e).map(e=>e/255),t.push(1);_[e]=t}return _[e]}var b=n(10);
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */const x=/%([bc]){([^}]*)}/g,C=0,T=1,E=2,S=3;function k(e,t){const n={width:0,height:1},r=A(e,t);let i=0;for(let e=0;e<r.length;e++){const t=r[e];switch(t.type){case C:i+=t.value.length;break;case T:n.height++,n.width=Math.max(n.width,i),i=0;break;case E:case S:break;default:throw new Error("unknown token type")}}return n.width=Math.max(n.width,i),n}function A(e,t){const n=[];let r=0;e.replace(x,(function(t,i,o,a){const s=e.substring(r,a);return s.length&&n.push({type:C,value:s}),n.push({type:"c"===i?E:S,value:o.trim()}),r=a+t.length,""}));const i=e.substring(r);return i.length&&n.push({type:C,value:i}),function(e,t){t||(t=1/0);let n=0,r=0,i=-1;for(;n<e.length;){const o=e[n];if(o.type===T&&(r=0,i=-1),o.type!==C){n++;continue}for(;0===r&&" "===o.value.charAt(0);)o.value=o.value.substring(1);const a=o.value.indexOf("\n");if(-1!==a){o.value=O(e,n,a,!0);const t=o.value.split("");for(;t.length&&" "===t[t.length-1];)t.pop();o.value=t.join("")}if(o.value.length){if(r+o.value.length>t){let a=-1;for(;;){const e=o.value.indexOf(" ",a+1);if(-1===e)break;if(r+e>t)break;a=e}if(-1!==a)o.value=O(e,n,a,!0);else if(-1!==i){const t=e[i],r=t.value.lastIndexOf(" ");t.value=O(e,i,r,!0),n=i}else o.value=O(e,n,t-r,!1)}else r+=o.value.length,-1!==o.value.indexOf(" ")&&(i=n);n++}else e.splice(n,1)}e.push({type:T});let o=null;for(let t=0;t<e.length;t++){const n=e[t];switch(n.type){case C:o=n;break;case T:if(o){const e=o.value.split("");for(;e.length&&" "===e[e.length-1];)e.pop();o.value=e.join("")}o=null;break;case E:case S:break;default:throw new Error("Unknown token type")}}return e.pop(),e}(n,t)}function O(e,t,n,r){const i={type:T},o={type:C,value:e[t].value.substring(n+(r?1:0))};return e.splice(t+1,0,i,o),e[t].value.substring(0,n)}
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */const P={4:[[0,-1],[1,0],[0,1],[-1,0]],8:[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]],6:[[-1,-1],[1,-1],[2,0],[1,1],[-1,1],[-2,0]]},I={hex:h,rect:d,tile:p,"tile-gl":m,term:b.a},M={width:80,height:25,transpose:!1,layout:"rect",fontSize:15,spacing:1,border:0,forceSquareRatio:!1,fontFamily:"monospace",fontStyle:"",fg:"#ccc",bg:"#000",tileWidth:32,tileHeight:32,tileMap:{},tileSet:null,tileColorize:!1};class G{constructor(e={}){this._data={},this._dirty=!1,this._options={},e=Object.assign({},M,e),this.setOptions(e),this.DEBUG=this.DEBUG.bind(this)}DEBUG(e,t,n){const r=[this._options.bg,this._options.fg];this.draw(e,t,null,null,r[n%r.length])}clear(){this._data={},this._dirty=!0}setOptions(e){if(Object.assign(this._options,e),e.width||e.height||e.fontSize||e.fontFamily||e.spacing||e.layout){if(e.layout){const t=I[e.layout];this._backend=new t}this._backend.setOptions(this._options),this._dirty=!0}return this}getOptions(){return this._options}getContainer(){return this._backend.getContainer()}computeSize(e,t){return this._backend.computeSize(e,t)}computeFontSize(e,t){return this._backend.computeFontSize(e,t)}computeTileSize(e,t){return[Math.floor(e/this._options.width),Math.floor(t/this._options.height)]}eventToPosition(e){let t,n;return"touches"in e?(t=e.touches[0].clientX,n=e.touches[0].clientY):(t=e.clientX,n=e.clientY),this._backend.eventToPosition(t,n)}draw(e,t,n,r,i){r||(r=this._options.fg),i||(i=this._options.bg);const o=`${e},${t}`;this._data[o]=[e,t,n,r,i],!0!==this._dirty&&(this._dirty||(this._dirty={}),this._dirty[o]=!0)}drawText(e,t,n,r){let i=null,o=null,a=e,s=t,l=1;r||(r=this._options.width-e);const u=A(n,r);for(;u.length;){const t=u.shift();let n=!1,r=!1,c=!1,h=!1;switch(t.type){case C:for(let e=0;e<t.value.length;e++){const l=t.value.charCodeAt(e),u=t.value.charAt(e);if("term"===this._options.layout){const e=l>>8;if(17===e||e>=46&&e<=159||e>=172&&e<=215||l>=43360&&l<=43391){this.draw(a+0,s,u,i,o),this.draw(a+1,s,"\t",i,o),a+=2;continue}}c=l>65280&&l<65377||l>65500&&l<65512||l>65518,n=32===u.charCodeAt(0)||12288===u.charCodeAt(0),!h||c||n||a++,c&&!r&&a++,this.draw(a++,s,u,i,o),r=n,h=c}break;case E:i=t.value||null;break;case S:o=t.value||null;break;case T:a=e,s++,l++;break;default:throw new Error("Unknown text type")}}return l}drawWithCache(){if(this._dirty){if(!0===this._dirty){this._backend.clear();for(const e in this._data)this._draw(e,!1)}else for(const e in this._dirty)this._draw(e,!0);this._dirty=!1}}_draw(e,t){const n=this._data[e];n[4]!==this._options.bg&&(t=!0),this._backend.draw(n,t)}}G.Rect=d,G.Hex=h,G.Tile=p,G.TileGL=m,G.Term=b.a;
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
class L{constructor(){this.heap=[],this.timestamp=0}lessThan(e,t){return e.key===t.key?e.timestamp<t.timestamp:e.key<t.key}shift(e){this.heap=this.heap.map(({key:t,value:n,timestamp:r})=>({key:t+e,value:n,timestamp:r}))}len(){return this.heap.length}push(e,t){this.timestamp+=1;const n=this.len();this.heap.push({value:e,timestamp:this.timestamp,key:t}),this.updateUp(n)}pop(){if(0===this.len())throw new Error("no element to pop");const e=this.heap[0];return this.len()>1?(this.heap[0]=this.heap.pop(),this.updateDown(0)):this.heap.pop(),e}find(e){for(let t=0;t<this.len();t++)if(e===this.heap[t].value)return this.heap[t];return null}remove(e){let t=null;for(let n=0;n<this.len();n++)e===this.heap[n].value&&(t=n);if(null===t)return!1;if(this.len()>1){const n=this.heap.pop();return n.value!==e&&(this.heap[t]=n,this.updateDown(t)),!0}return this.heap.pop(),!0}parentNode(e){return Math.floor((e-1)/2)}leftChildNode(e){return 2*e+1}rightChildNode(e){return 2*e+2}existNode(e){return e>=0&&e<this.heap.length}swap(e,t){const n=this.heap[e];this.heap[e]=this.heap[t],this.heap[t]=n}minNode(e){const t=e.filter(this.existNode.bind(this));let n=t[0];for(const e of t)this.lessThan(this.heap[e],this.heap[n])&&(n=e);return n}updateUp(e){if(0===e)return;const t=this.parentNode(e);this.existNode(t)&&this.lessThan(this.heap[e],this.heap[t])&&(this.swap(e,t),this.updateUp(t))}updateDown(e){const t=this.leftChildNode(e),n=this.rightChildNode(e);if(!this.existNode(t))return;const r=this.minNode([e,t,n]);r!==e&&(this.swap(e,r),this.updateDown(r))}debugPrint(){console.log(this.heap)}}
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */class D{constructor(){this._time=0,this._events=new L}getTime(){return this._time}clear(){return this._events=new L,this}add(e,t){this._events.push(e,t)}get(){if(!this._events.len())return null;const{key:e,value:t}=this._events.pop();return e>0&&(this._time+=e,this._events.shift(-e)),t}getEventTime(e){const t=this._events.find(e);if(t){const{key:e}=t;return e}}remove(e){return this._events.remove(e)}}
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */class j{constructor(){this._queue=new D,this._repeat=[],this._current=null}getTime(){return this._queue.getTime()}add(e,t){return t&&this._repeat.push(e),this}getTimeOf(e){return this._queue.getEventTime(e)}clear(){return this._queue.clear(),this._repeat=[],this._current=null,this}remove(e){const t=this._queue.remove(e),n=this._repeat.indexOf(e);return-1!==n&&this._repeat.splice(n,1),this._current===e&&(this._current=null),t}next(){return this._current=this._queue.get(),this._current}}
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */class F{constructor(e,t={}){this._lightPasses=e,this._options=Object.assign({topology:8},t)}_getCircle(e,t,n){let r,i,o,a=[];switch(this._options.topology){case 4:i=1,o=[0,1],r=[P[8][7],P[8][1],P[8][3],P[8][5]];break;case 6:r=P[6],i=1,o=[-1,1];break;case 8:r=P[4],i=2,o=[-1,1];break;default:throw new Error("Incorrect topology for FOV computation")}let s=e+o[0]*n,l=t+o[1]*n;for(let e=0;e<r.length;e++)for(let t=0;t<n*i;t++)a.push([s,l]),s+=r[e][0],l+=r[e][1];return a}}
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
const N=[[-1,0,0,1],[0,-1,1,0],[0,-1,-1,0],[-1,0,0,-1],[1,0,0,-1],[0,1,-1,0],[0,1,1,0],[1,0,0,1]];
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */var R={DiscreteShadowcasting:class extends F{compute(e,t,n,r){if(r(e,t,0,1),!this._lightPasses(e,t))return;const i=[];let o,a,s,l,u;for(let c=1;c<=n;c++){const n=this._getCircle(e,t,c),h=360/n.length;for(let e=0;e<n.length;e++)if(s=n[e][0],l=n[e][1],o=h*(e-.5),a=o+h,u=!this._lightPasses(s,l),this._visibleCoords(Math.floor(o),Math.ceil(a),u,i)&&r(s,l,c,1),2===i.length&&0===i[0]&&360===i[1])return}}_visibleCoords(e,t,n,r){if(e<0){const i=this._visibleCoords(0,t,n,r),o=this._visibleCoords(360+e,360,n,r);return i||o}let i=0;for(;i<r.length&&r[i]<e;)i++;if(i===r.length)return n&&r.push(e,t),!0;let o=0;if(i%2){for(;i<r.length&&r[i]<t;)i++,o++;return 0!==o&&(n&&(o%2?r.splice(i-o,o,t):r.splice(i-o,o)),!0)}for(;i<r.length&&r[i]<t;)i++,o++;return(e!==r[i-o]||1!==o)&&(n&&(o%2?r.splice(i-o,o,e):r.splice(i-o,o,e,t)),!0)}}
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */,PreciseShadowcasting:class extends F{compute(e,t,n,r){if(r(e,t,0,1),!this._lightPasses(e,t))return;let i,o,a,s,l,u,c=[];for(let h=1;h<=n;h++){let n=this._getCircle(e,t,h),d=n.length;for(let e=0;e<d;e++)if(i=n[e][0],o=n[e][1],s=[e?2*e-1:2*d-1,2*d],l=[2*e+1,2*d],a=!this._lightPasses(i,o),u=this._checkVisibility(s,l,a,c),u&&r(i,o,h,u),2==c.length&&0==c[0][0]&&c[1][0]==c[1][1])return}}_checkVisibility(e,t,n,r){if(e[0]>t[0]){return(this._checkVisibility(e,[e[1],e[1]],n,r)+this._checkVisibility([0,1],t,n,r))/2}let i=0,o=!1;for(;i<r.length;){let t=r[i],n=t[0]*e[1]-e[0]*t[1];if(n>=0){0!=n||i%2||(o=!0);break}i++}let a=r.length,s=!1;for(;a--;){let e=r[a],n=t[0]*e[1]-e[0]*t[1];if(n>=0){0==n&&a%2&&(s=!0);break}}let l,u=!0;if((i==a&&(o||s)||o&&s&&i+1==a&&a%2||i>a&&i%2)&&(u=!1),!u)return 0;let c=a-i+1;if(c%2)if(i%2){let e=r[i];l=(t[0]*e[1]-e[0]*t[1])/(e[1]*t[1]),n&&r.splice(i,c,t)}else{let t=r[a];l=(t[0]*e[1]-e[0]*t[1])/(e[1]*t[1]),n&&r.splice(i,c,e)}else{if(!(i%2))return n&&r.splice(i,c,e,t),1;{let e=r[i],t=r[a];l=(t[0]*e[1]-e[0]*t[1])/(e[1]*t[1]),n&&r.splice(i,c)}}return l/((t[0]*e[1]-e[0]*t[1])/(e[1]*t[1]))}},RecursiveShadowcasting:class extends F{compute(e,t,n,r){r(e,t,0,1);for(let i=0;i<N.length;i++)this._renderOctant(e,t,N[i],n,r)}compute180(e,t,n,r,i){i(e,t,0,1);let o=(r-1+8)%8,a=(r-2+8)%8,s=(r+1+8)%8;this._renderOctant(e,t,N[a],n,i),this._renderOctant(e,t,N[o],n,i),this._renderOctant(e,t,N[r],n,i),this._renderOctant(e,t,N[s],n,i)}compute90(e,t,n,r,i){i(e,t,0,1);let o=(r-1+8)%8;this._renderOctant(e,t,N[r],n,i),this._renderOctant(e,t,N[o],n,i)}_renderOctant(e,t,n,r,i){this._castVisibility(e,t,1,1,0,r+1,n[0],n[1],n[2],n[3],i)}_castVisibility(e,t,n,r,i,o,a,s,l,u,c){if(!(r<i))for(let h=n;h<=o;h++){let n=-h-1,d=-h,p=!1,f=0;for(;n<=0;){n+=1;let m=e+n*a+d*s,g=t+n*l+d*u,y=(n-.5)/(d+.5),v=(n+.5)/(d-.5);if(!(v>r)){if(y<i)break;if(n*n+d*d<o*o&&c(m,g,h,1),p){if(!this._lightPasses(m,g)){f=v;continue}p=!1,r=f}else!this._lightPasses(m,g)&&h<o&&(p=!0,this._castVisibility(e,t,h+1,r,y,o,a,s,l,u,c),f=v)}}if(p)break}}}};
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
Math.sqrt(3),Math.sqrt(3);
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
class H{constructor(e,t,n,r={}){this._toX=e,this._toY=t,this._passableCallback=n,this._options=Object.assign({topology:8},r),this._dirs=P[this._options.topology],8===this._options.topology&&(this._dirs=[this._dirs[0],this._dirs[2],this._dirs[4],this._dirs[6],this._dirs[1],this._dirs[3],this._dirs[5],this._dirs[7]])}_getNeighbors(e,t){const n=[];for(let r=0;r<this._dirs.length;r++){const i=this._dirs[r],o=e+i[0],a=t+i[1];this._passableCallback(o,a)&&n.push([o,a])}return n}}
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */var $={Dijkstra:class extends H{constructor(e,t,n,r){super(e,t,n,r),this._computed={},this._todo=[],this._add(e,t,null)}compute(e,t,n){const r=e+","+t;if(r in this._computed||this._compute(e,t),!(r in this._computed))return;let i=this._computed[r];for(;null!==i;)n(i.x,i.y),i=i.prev}_compute(e,t){for(;this._todo.length>0;){const n=this._todo.shift();if(n.x===e&&n.y===t)return;const r=this._getNeighbors(n.x,n.y);for(let e=0;e<r.length;e++){const t=r[e],i=t[0],o=t[1];i+","+o in this._computed||this._add(i,o,n)}}}_add(e,t,n){const r={x:e,y:t,prev:n};this._computed[e+","+t]=r,this._todo.push(r)}}
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */,AStar:class extends H{constructor(e,t,n,r,i={}){super(e,t,n,i),this.todo=[],this.done={},this.weightCallback=r}compute(e,t,n){for(this.todo=[],this.done={},this.fromX=e,this.fromY=t,this._add(this._toX,this._toY,null);this.todo.length>0;){const n=this.todo.shift(),r=n.x+","+n.y;if(r in this.done)continue;if(this.done[r]=n,n.x===e&&n.y===t)break;const i=this._getNeighbors(n.x,n.y);for(let e=0;e<i.length;e++){const t=i[e],r=t[0],o=t[1];r+","+o in this.done||this._add(r,o,n)}}let r=this.done[e+","+t];if(null!=r)for(;null!=r;)n(r.x,r.y),r=r.prev}_add(e,t,n){const r=this.weightCallback(e,t),i={x:e,y:t,prev:n,g:null!==n?n.g+1:0,h:r},o=i.g+i.h;for(let e=0;e<this.todo.length;e++){const t=this.todo[e],n=t.g+t.h;if(o<n||o===n&&r<t.h)return void this.todo.splice(e,0,i)}this.todo.push(i)}_distance(e,t){const n=Math.abs(e-this.fromX),r=Math.abs(t-this.fromY);switch(this._options.topology){case 4:return Math.abs(e-this.fromX)+Math.abs(t-this.fromY);case 6:return r+Math.max(0,(n-r)/2);case 8:return Math.max(Math.abs(e-this.fromX),Math.abs(t-this.fromY));default:return 0}}},ReverseAStar:class{constructor(e,t){this._goalCallback=e,this._passableCallback=t,this._dirs=P[8],this._dirs=[this._dirs[0],this._dirs[2],this._dirs[4],this._dirs[6],this._dirs[1],this._dirs[3],this._dirs[5],this._dirs[7]]}compute(e,t,n){let r,i;for(this.todo=[],this.done={},this.fromX=e,this.fromY=t,this.add(this.fromX,this.fromY,null);this.todo.length>0;){const e=this.todo.shift(),t=e.x+","+e.y;if(t in this.done)continue;if(this.done[t]=e,this._goalCallback(e.x,e.y)){r=e.x,i=e.y;break}const n=this.getNeighbors(e.x,e.y);for(let t=0;t<n.length;t++){const r=n[t],i=r[0],o=r[1];i+","+o in this.done||this.add(i,o,e)}}let o=this.done[r+","+i];if(null!=o)for(;null!=o;)n(o.x,o.y),o=o.prev}add(e,t,n){const r=this.distance(e,t),i={x:e,y:t,prev:n,g:null!==n?n.g+1:0,h:r},o=i.g+i.h;for(let e=0;e<this.todo.length;e++){const t=this.todo[e],n=t.g+t.h;if(o<n||o===n&&r<t.h)return void this.todo.splice(e,0,i)}this.todo.push(i)}getNeighbors(e,t){const n=[];for(let r=0;r<this._dirs.length;r++){const i=this._dirs[r],o=e+i[0],a=t+i[1];this._passableCallback(o,a)&&n.push([o,a])}return n}distance(e,t){return Math.max(Math.abs(e-this.fromX),Math.abs(t-this.fromY))}}};
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
class z{constructor(e,t={}){this._reflectivityCallback=e,this._options={},t=Object.assign({passes:1,emissionThreshold:100,range:10},t),this._lights={},this._reflectivityCache={},this._fovCache={},this.setOptions(t)}setOptions(e){return Object.assign(this._options,e),(null==e?void 0:e.range)&&this.reset(),this}setFOV(e){return this._fov=e,this._fovCache={},this}setLight(e,t,n){const r=e+","+t;return n?this._lights[r]="string"==typeof n?f.fromString(n):n:delete this._lights[r],this}clearLights(){this._lights={}}reset(){return this._reflectivityCache={},this._fovCache={},this}compute(e){const t={};let n={};const r={};for(const e in this._lights){const t=this._lights[e];n[e]=[0,0,0],f.add_(n[e],t)}for(let e=0;e<this._options.passes;e++)this._emitLight(n,r,t),e+1!==this._options.passes&&(n=this._computeEmitters(r,t));for(const t in r){const n=t.split(",");e(parseInt(n[0]),parseInt(n[1]),r[t])}return this}_emitLight(e,t,n){for(const r in e){const i=r.split(","),o=parseInt(i[0]),a=parseInt(i[1]);this._emitLightFromCell(o,a,e[r],t),n[r]=1}return this}_computeEmitters(e,t){const n={};for(const r in e){if(r in t)continue;const i=e[r];let o;if(r in this._reflectivityCache)o=this._reflectivityCache[r];else{const e=r.split(","),t=parseInt(e[0]),n=parseInt(e[1]);o=this._reflectivityCallback(t,n),this._reflectivityCache[r]=o}if(0===o)continue;const a=[0,0,0];let s=0;for(let e=0;e<3;e++){const t=Math.round(i[e]*o);a[e]=t,s+=t}s>this._options.emissionThreshold&&(n[r]=a)}return n}_emitLightFromCell(e,t,n,r){const i=e+","+t;let o;o=i in this._fovCache?this._fovCache[i]:this._updateFOV(e,t);for(const e in o){const t=o[e];let i;e in r?i=r[e]:(i=[0,0,0],r[e]=i);for(let e=0;e<3;e++)i[e]+=Math.round(n[e]*t)}return this}_updateFOV(e,t){const n=e+","+t,r={};this._fovCache[n]=r;const i=this._options.range;return this._fov.compute(e,t,i,function(e,t,n,o){const a=o*(1-n/i);0!==a&&(r[e+","+t]=a)}.bind(this)),r}}
/**!
 * Copyright (c) 2012-now(), Ondrej Zara
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 	* Redistributions of source code must retain the above copyright notice,
 * 	  this list of conditions and the following disclaimer.
 * 	* Redistributions in binary form must reproduce the above copyright notice,
 * 	  this list of conditions and the following disclaimer in the documentation
 * 	  and/or other materials provided with the distribution.
 * 	* Neither the name of Ondrej Zara nor the names of its contributors may be used
 * 	  to endorse or promote products derived from this software without specific
 * 	  prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */var W,U,B,q,V,K,X,Y,Q,Z;!function(e){e[e.Physical=0]="Physical",e[e.Fire=1]="Fire",e[e.Electric=2]="Electric",e[e.Water=3]="Water",e[e.Ice=4]="Ice",e[e.Nature=5]="Nature"}(W||(W={})),function(e){e[e.weak=2]="weak",e[e.normal=1]="normal",e[e.strong=.5]="strong",e[e.nullified=0]="nullified"}(U||(U={})),function(e){e[e.Default=0]="Default",e[e.RemoveFromWorld=1]="RemoveFromWorld"}(B||(B={})),function(e){e[e.Player=0]="Player",e[e.OnePass=1]="OnePass",e[e.TwoPass=2]="TwoPass"}(q||(q={})),function(e){e[e.Gameplay=0]="Gameplay",e[e.OpeningCinematic=1]="OpeningCinematic",e[e.WinCinematic=2]="WinCinematic",e[e.LoseCinematic=3]="LoseCinematic",e[e.PauseMenu=4]="PauseMenu",e[e.InventoryMenu=5]="InventoryMenu",e[e.SpellMenu=6]="SpellMenu"}(V||(V={})),function(e){e[e.HealSelf=0]="HealSelf",e[e.DamageScroll=1]="DamageScroll",e[e.WildDamageScroll=2]="WildDamageScroll",e[e.ClairvoyanceScroll=3]="ClairvoyanceScroll",e[e.ConfuseScroll=4]="ConfuseScroll",e[e.HasteSelf=5]="HasteSelf",e[e.SlowOther=6]="SlowOther"}(K||(K={})),function(e){e[e.DamageOther=0]="DamageOther",e[e.WildDamage=1]="WildDamage",e[e.Effect=2]="Effect",e[e.Passive=3]="Passive",e[e.HealSelf=4]="HealSelf",e[e.HealOther=5]="HealOther"}(X||(X={})),function(e){e[e.OnFire=0]="OnFire",e[e.Frozen=1]="Frozen",e[e.Paralyzed=2]="Paralyzed"}(Y||(Y={})),function(e){e[e.LoadLevel=0]="LoadLevel",e[e.Door=1]="Door",e[e.GiveItems=2]="GiveItems",e[e.GiveSpells=3]="GiveSpells"}(Q||(Q={})),function(e){e[e.Event=0]="Event",e[e.Fire=1]="Fire",e[e.ShallowWater=2]="ShallowWater",e[e.DeepWater=3]="DeepWater",e[e.Mud=4]="Mud"}(Z||(Z={}));var J=n(1);function ee(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function te(e){throw new Error("Should be unreachable")}const ne=new Set;let re=null,ie=null;var oe,ae={init:function(){if(null===i.window||void 0===i.window||null===i.Game||void 0===i.Game||null===i.Game.canvas)throw new Error("Cannot init input without the globals initialized");i.window.addEventListener("keydown",(function(e){e.preventDefault(),ne.add(e.key)})),i.window.addEventListener("mousedown",(function(e){e.preventDefault(),re=e})),i.Game.canvas.addEventListener("mousemove",(function(e){e.preventDefault(),ie=e}))},isDown:function(e){return ne.has(e)},pressKey:function(e){ne.add(e)},pressMouse:function(){re=new MouseEvent("mousedown")},getFirstKeyPressed:function(){return Object(J.get)([...ne.values()],"[0]",null)},getLeftMouseDown:function(){if(null===i.Game||void 0===i.Game||null===i.Game.display||null===re)return null;const e=i.Game.display.eventToPosition(re);return e[0]<0||e[1]<0?null:i.Game.gameCamera.screenToWorld(e[0],e[1])},getMousePosition:function(){if(null===i.Game||void 0===i.Game||null===i.Game.display||null===ie)return null;const e=i.Game.display.eventToPosition(ie);return i.Game.gameCamera.screenToWorld(e[0],e[1])},clearInputs:function(){re=null,ne.clear()}},se=n(16),le=n(17),ue=n(18);
/**!
 * Adapted from GOAPy (https://github.com/flags/GOAPy)
 *
 * Original License:
 *
 * The MIT License (MIT)
 *
 * Copyright (c) 2014 Luke Martin (flags)
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
function ce(e,t){const n=new Set(e);for(const e of t)n.delete(e);return n}function he(e,t){const n=new Set;let r=0;for(const i in t){const o=t[i];-1!==o&&(o!==e[i]&&(r+=1),n.add(i))}for(const i in e){if(n.has(i))continue;const o=e[i];-1!==o&&(o!==t[i]&&(r+=1))}return r}function de(e,t){for(const n in t){if(-1!==t[n]&&e[n]!==t[n])return!1}return!0}function pe(e,t){const n=Object.values(t);for(let t=0;t<n.length;t++){const r=n[t];if(e.state===r.state&&e.name===r.name)return!0}return!1}function fe(e,t,n=""){return e.nodeID+=1,e.nodes[e.nodeID]={state:t,f:0,g:0,h:0,p_id:null,id:e.nodeID,name:n},e.nodes[e.nodeID]}function me(e,t,n,r,i){const o={nodes:{},nodeID:0,goal:t,actions:n,reactions:r,weightTable:i,actionNodes:{},oList:{},cList:{}},a=fe(o,e,"start");a.g=0,a.h=he(e,t),a.f=a.g+a.h,o.oList[a.id]=a;for(const e in n)o.actionNodes[e]=fe(o,n[e],e);return function(e){let t=null;const n=e.cList,r=e.oList;for(;Object.keys(r).length>0;){const i={node:null,f:9e6},o=Object.values(r);for(let e=0;e<o.length;e++){const t=o[e];(null===i.node||t.f<i.f)&&(i.node=t.id,i.f=t.f)}if(null===i.node)return;if(t=e.nodes[i.node],delete r[t.id],de(t.state,e.goal)){const n=[];for(;null!==t.p_id;)n.push(t),t=e.nodes[t.p_id];return Object(J.reverse)(n),n}n[t.id]=t;const a=[],s=Object.keys(e.actionNodes);for(let n=0;n<s.length;n++){const r=s[n];if(!de(t.state,e.actionNodes[r].state))continue;e.nodeID+=1;const i=Object.assign({},t);i.state=Object.assign({},t.state),i.id=e.nodeID,i.name=r;for(const t in e.reactions[r]){const n=e.reactions[r][t];-1!==n&&(i.state[t]=n)}e.nodes[i.id]=i,a.push(i)}for(let i=0;i<a.length;i++){const o=a[i],s=t.g+e.weightTable[o.name],l=pe(o,r),u=pe(o,n);l&&s<o.g&&delete r[o],u&&s<o.g&&delete n[o.id],l||u||(o.g=s,o.h=he(o.state,e.goal),o.f=o.g+o.h,o.p_id=t.id,r[o.id]=o)}}return[]}(o)}class ge{constructor(...e){this.startState=null,this.goalState=null,this.actionList=null,this.values={};for(let t=0;t<e.length;t++)this.values[e[t]]=-1}state(e={}){const t=Object.assign({},this.values);return Object.assign(t,e),t}setStartState(e={}){const t=ce(new Set(Object.keys(e)),new Set(Object.keys(this.values)));if(t.size>0)throw new Error("Invalid states for world start state: "+Array.from(t.values()));this.startState=this.state(e)}setGoalState(e={}){const t=ce(new Set(Object.keys(e)),new Set(Object.keys(this.values)));if(t.size>0)throw new Error("Invalid states for world goal state: "+[...t]);this.goalState=this.state(e)}setActionList(e){this.actionList=e}getActionList(){return this.actionList}calculate(){if(null===this.actionList)throw new Error("Can't calculate path with no actionList");if(null===this.startState)throw new Error("Can't calculate path with no startState");if(null===this.goalState)throw new Error("Can't calculate path with no goalState");const e={};for(const t in this.actionList.conditions)e[t]=Object.assign({},this.actionList.conditions[t]);const t={};for(const e in this.actionList.reactions)t[e]=Object.assign({},this.actionList.reactions[e]);return me(this.startState,this.goalState,e,t,Object.assign({},this.actionList.weights))}}class ye{constructor(){this.conditions={},this.reactions={},this.weights={}}addCondition(e,t={}){e in this.weights||(this.weights[e]=1),e in this.conditions?Object.assign(this.conditions[e],t):this.conditions[e]=t}addReaction(e,t={}){if(!(e in this.conditions))throw new Error(`Trying to add reaction "${e}" without matching condition.`);e in this.reactions?Object.assign(this.reactions[e],t):this.reactions[e]=t}setWeight(e,t){if(!(e in this.conditions))throw new Error(`Trying to set weight "${e}" without matching condition.`);this.weights[e]=t}}function ve(e,t=oe.Default){if(null===i.document)throw new Error("Global document object is null");if(null===i.Game)throw new Error("Global Game object is null");const n=i.document.getElementById("log");if(null===n)throw new Error("Can't find log list element");const r=document.createElement("div"),o=document.createElement("p"),a=document.createElement("p");for(o.innerHTML=""+e,t===oe.Tutorial?r.className="tutorial":t===oe.Critical?(r.className="critical",a.innerHTML=`<small>Turn: ${i.Game.getTurnNumber()}</small>`):a.innerHTML=`<small>Turn: ${i.Game.getTurnNumber()}</small>`,r.appendChild(o),r.appendChild(a),n.appendChild(r);n.children.length>100;)n.children[0].remove();n.scrollTop=n.scrollHeight}!function(e){e[e.Default=0]="Default",e[e.Tutorial=1]="Tutorial",e[e.Critical=2]="Critical"}(oe||(oe={}));class _e{constructor(){this.pageSize=15,this.currentSelection=0,this.currentPage=0,this.allowedKeys=new Set(["ArrowDown","ArrowUp","Enter"])}resetState(){this.currentSelection=0,this.currentPage=0}draw(e){if(null===i.Game)throw new Error("Global Game object is null");if(null===i.Game.display)throw new Error("Cannot draw InventoryMenu when display is null");for(let e=0;e<58;e++)for(let t=0;t<38;t++)0===e||0===t||57===e||37===t||19===t?i.Game.display.draw(e,t,"1","grey","grey"):i.Game.display.draw(e,t,"1","black","black");i.Game.display.drawText(2,1,"%c{white}%b{black}Player Inventory");const t=Math.floor(this.currentSelection/this.pageSize)*this.pageSize,n=Math.min(t+this.pageSize,e.length);for(let r=t;r<n;r++){const n=e[r];let o;o=r===this.currentSelection?`%c{white}%b{grey}${n.displayName} (${n.count})`:`%c{white}%b{black}${n.displayName} (${n.count})`,i.Game.display.drawText(2,r-t+3,o)}t>0&&i.Game.display.drawText(27,2,"%c{white}%b{black}▲▲▲"),n<e.length&&i.Game.display.drawText(27,18,"%c{white}%b{black}▼▼▼");const r=e[this.currentSelection];void 0!==r&&i.Game.display.drawText(2,21,"%c{white}%b{black}"+r.description)}handleInput(e){if(null===i.gameEventEmitter)throw new Error("Global gameEventEmitter is null");return ae.isDown("Enter")?(i.gameEventEmitter.emit("ui.select"),e[this.currentSelection]):(ae.isDown("ArrowUp")&&this.currentSelection>0&&(i.gameEventEmitter.emit("ui.cursorMove"),this.currentSelection--),ae.isDown("ArrowDown")&&this.currentSelection<e.length-1&&(i.gameEventEmitter.emit("ui.cursorMove"),this.currentSelection++),null)}}class we{constructor(){this.pageSize=15,this.currentSelection=0,this.allowedKeys=new Set(["ArrowDown","ArrowUp","Enter"])}resetState(){this.currentSelection=0}draw(e){if(null===i.Game)throw new Error("Global Game object is null");if(null===i.Game.display)throw new Error("Cannot draw InventoryMenu when display is null");for(let e=0;e<58;e++)for(let t=0;t<38;t++)0===e||0===t||57===e||37===t||19===t?i.Game.display.draw(e,t,"1","grey","grey"):i.Game.display.draw(e,t,"1","black","black");i.Game.display.drawText(2,1,"%c{white}%b{black}Spells");const t=Math.floor(this.currentSelection/this.pageSize)*this.pageSize,n=Math.min(t+this.pageSize,e.length);for(let r=t;r<n;r++){const n=e[r];let o;o=r===this.currentSelection?"%c{white}%b{grey} "+n.displayName:"%c{white}%b{black} "+n.displayName,i.Game.display.drawText(2,r-t+3,o);let a="%c{white}%b{black}";switch(n.type){case X.DamageOther:case X.WildDamage:a+="dmg: "+n.value;break;case X.Effect:a+="turns: "+n.value;break;case X.HealSelf:case X.HealOther:a+="health: "+n.value;break;case X.Passive:break;default:te(n.type)}i.Game.display.drawText(25,r+3,a),i.Game.display.drawText(40,r-t+3,"%c{white}%b{black}count: "+n.count)}t>0&&i.Game.display.drawText(27,2,"%c{white}%b{black}▲▲▲"),n<e.length&&i.Game.display.drawText(27,18,"%c{white}%b{black}▼▼▼");const r=e[this.currentSelection];void 0!==r&&i.Game.display.drawText(2,21,"%c{white}%b{black}"+r.description)}handleInput(e){if(null===i.gameEventEmitter)throw new Error("Global gameEventEmitter is null");return ae.isDown("Enter")?(i.gameEventEmitter.emit("ui.select"),Le[e[this.currentSelection].id]):(ae.isDown("ArrowUp")&&this.currentSelection>0&&(i.gameEventEmitter.emit("ui.cursorMove"),this.currentSelection--),ae.isDown("ArrowDown")&&this.currentSelection<e.length-1&&(i.gameEventEmitter.emit("ui.cursorMove"),this.currentSelection++),null)}}class be{constructor(){this.state="selection",this.currentSelection=0,this.allowedSelectionKeys=new Set(["ArrowDown","ArrowUp","Enter","Escape"])}resetState(){this.state="selection",this.currentSelection=0}draw(e){if(null===i.Game)throw new Error("Global Game object is null");if(null===i.Game.display)throw new Error("Cannot draw InventoryMenu when display is null");const t=e.length+6+4;for(let e=0;e<58;e++)for(let n=0;n<t;n++)0===e||0===n||57===e||n===t-1?i.Game.display.draw(e,n,"1","grey","grey"):i.Game.display.draw(e,n,"1","black","black");i.Game.display.drawText(2,1,"%c{white}%b{black} Keyboard Bindings"),i.Game.display.drawText(2,3,"%c{white}%b{black} Use the arrow keys to select a binding, and enter to change it. Use Escape to exit");for(let t=0;t<e.length;t++){const n=e[t].key;t===this.currentSelection?"selection"===this.state?i.Game.display.drawText(2,t+7,"%c{white}%b{grey} "+e[t].description+": "+n):i.Game.display.drawText(2,t+7,"%c{white}%b{grey} "+e[t].description+":"):i.Game.display.drawText(2,t+7,"%c{white}%b{black} "+e[t].description+": "+n)}}handleInput(e){if(null===i.gameEventEmitter)throw new Error("Global gameEventEmitter is null");if("selection"===this.state){if(ae.isDown("Escape"))return void i.gameEventEmitter.emit("ui.select");ae.isDown("ArrowUp")&&this.currentSelection>0&&(i.gameEventEmitter.emit("ui.cursorMove"),this.currentSelection--),ae.isDown("ArrowDown")&&this.currentSelection<e.length-1&&(i.gameEventEmitter.emit("ui.cursorMove"),this.currentSelection++),ae.isDown("Enter")&&(i.gameEventEmitter.emit("ui.select"),this.state="change")}else if("change"===this.state){i.gameEventEmitter.emit("ui.select");const t=ae.getFirstKeyPressed();null!==t&&(e[this.currentSelection].key=t,this.state="selection")}}}function xe(e,t){if(null===e.value)throw new Error("Item does not have a healing value");const n=_n(t);if(null===n)throw new Error(`Trying to heal entity ${t.id} without any hp data`);if(n.hp>=n.maxHp){if("player"===t.id)ve("You are already at full health.");else{ve(t.getOne(Mt).name+" tries and fails to take a health potion")}return!1}return Cn(t.getOne(Ft),e.value),!0}function Ce(e,t,n){var r;const o=e.getOne(tn),a=e.getOne(nn),s=e.tags.has("blocks");if(void 0===o)return!1;if(void 0!==a&&a.wet){if(a.wet=!1,a.turnsLeft=0,a.update(),e===(null===(r=i.Game)||void 0===r?void 0:r.player))ve("You were not set on fire because you were wet");else{ve(e.getOne(Mt).name+" was not set on fire because it was wet")}return!1}!1!==o.onFire||s||(e.addComponent({type:"TriggerTypeComponent",triggerType:Z.Fire}),e.addComponent({type:"FireTriggerComponent",effectTurns:5,effectDamage:5,damage:15})),e.tags.has("sentient")?o.turnsLeft=null!=n?n:ee(3,6):o.turnsLeft=1e3;const l=e.getOne(Ft);return o.fireDamage=void 0!==t?t:void 0!==l?Math.max(1,Math.round(.0625*l.maxHp)):3,o.onFire=!0,o.update(),!0}function Te(e,t){var n;const r=e.getOne(tn);void 0!==r&&r.onFire&&(r.onFire=!1,r.turnsLeft=0,r.fireDamage=0,r.update(),e===(null===(n=i.Game)||void 0===n?void 0:n.player)&&ve("The water doused you")),void 0===t&&(t=10);const o=e.getOne(nn);return void 0!==o&&(!1===o.wet||o.turnsLeft<t)&&(o.wet=!0,o.turnsLeft=t,o.update(),!0)}function Ee(e,t,n,r){if(void 0!==e.statusEffect&&s.a.getUniform()<=n.ailmentSusceptibility)switch(e.statusEffect){case Y.OnFire:Ce(t,Math.round(.0625*r.maxHp),ee(3,6));break;case Y.Frozen:case Y.Paralyzed:throw new Error("Not implemented");default:te(e.statusEffect)}}function Se(e,t,n,r,i,o){var a;if(null===e.value)throw new Error("Item does not have a value for castDamageSpell");const s=St(n,r,i,o);if(null===s)return ve("Canceled casting"),!1;const l=s.getOne(Mt);if(void 0===s.getOne(Ft)&&void 0!==l)return ve(l.name+" isn't attack-able"),!1;xn(s,e.value,!1,null!==(a=e.damageType)&&void 0!==a?a:W.Physical);const u=wn(s),c=_n(s);return null===u||null===c||Ee(e,s,u,c),!0}function ke(e,t,n,r){if(null===e.value||void 0===e.damageType)throw new Error("Item has missing data");const i=t.getOne(Pt);if(void 0===i)throw new Error("can't call castWildDamageSpell with a user without a position");let o;do{o=st(n,r,i,16)}while(o===t);if(null===o)return"player"===t.id&&ve("No target is close enough to use the scroll"),!1;xn(o,e.value,!1,e.damageType);const a=wn(o),s=_n(o);return null===a||null===s||Ee(e,o,a,s),!0}function Ae(e,t,n,r,i,o){if(null===e.value)throw new Error("Item does not have a value");const a=St(n,r,i,o);if(null===a)return ve("Canceled casting"),!1;if(void 0===a.getOne(qt))return ve("Canceled casting"),!1;a.addComponent({type:"ConfusedAIComponent",turnsLeft:e.value});const s=a.getOne(Mt);return void 0!==s&&ve(s.name+" is now confused"),!0}function Oe(){if(null===i.Game)throw new Error("Global game object is null");return ve("You have been granted Clairvoyance"),ut(i.Game.map),!0}function Pe(e,t){if(null===e.value)throw new Error("Item does not have a value");const n=t.getComponents(Ht);for(const e of n)if("Haste"===e.name)return ve("You are already hasted"),!1;return t.addComponent({type:"SpeedEffectComponent",name:"Haste",stat:"speed",modifierType:"multiply",turnsLeft:e.value,value:2}),!0}function Ie(e,t,n,r,i,o){if(null===e.value)throw new Error("Item does not have a value");const a=St(n,r,i,o);if(null===a)return ve("Canceled casting"),!1;const s=a.getOne(Rt),l=a.getOne(Mt);if(void 0===l)throw new Error(a.id+" is missing a display name");if(void 0===s)return ve(l.name+" isn't slow-able"),!1;const u=a.getComponents(Ht);for(const e of u)if("Slow"===e.name)return ve(l.name+" is already slowed"),!1;return ve("Spell hits and slows "+l.name),a.addComponent({type:"SpeedEffectComponent",name:"Slow",stat:"speed",modifierType:"multiply",turnsLeft:e.value,value:.5}),!0}function Me(e,t,n,r,o,a,s,l){if(null===i.Game)throw new Error("Global game object is null");if(void 0===e.areaOfEffect)throw new Error("areaOfEffect cannot be null for castWall");for(let t=0;t<e.areaOfEffect.width;t++)for(let i=0;i<e.areaOfEffect.height;i++){let e,u;switch(s){default:case 0:e=a.x+t,u=a.y+i;break;case 90:e=a.x+i,u=a.y+t;break;case 180:e=a.x+t,u=a.y-i;break;case 270:e=a.x-i,u=a.y+t}const{blocks:c,entity:h}=it(r,o,e,u);!0===c&&null===h||dn(n,l,e,u)}return!0}const Ge={health_potion_weak:{displayName:"Weak Potion of Healing",description:"Potion that restores a small amount of health",value:25,type:K.HealSelf,useFunc:xe},health_potion:{displayName:"Potion of Healing",description:"Potion that restores a some health",value:50,type:K.HealSelf,useFunc:xe},health_potion_strong:{displayName:"Strong Potion of Healing",description:"Potion that restores a large amount of health",value:100,type:K.HealSelf,useFunc:xe},lightning_scroll_weak:{displayName:"Weak Scroll of Lightning Bolt",description:"Conjure a lightning bolt that damages a target with lightning damage",value:20,type:K.DamageScroll,damageType:W.Electric,useFunc:Se},lightning_scroll:{displayName:"Scroll of Lightning",description:"Conjure a lightning bolt that damages a target with lightning damage",value:50,type:K.DamageScroll,damageType:W.Electric,useFunc:Se},lightning_scroll_strong:{displayName:"Strong Scroll of Lightning",description:"Conjure a lightning bolt that damages a target with lightning damage",value:100,type:K.DamageScroll,damageType:W.Electric,useFunc:Se},fireball_scroll_weak:{displayName:"Weak Scroll of Fire",description:"Conjure a ball of fire that damages a target with fire damage",value:20,type:K.DamageScroll,damageType:W.Fire,useFunc:Se,statusEffect:Y.OnFire},fireball_scroll:{displayName:"Scroll of Fire",description:"Conjure a ball of fire that damages a target with fire damage",value:50,type:K.DamageScroll,damageType:W.Fire,useFunc:Se,statusEffect:Y.OnFire},fireball_scroll_strong:{displayName:"Strong Scroll of Fire",description:"Conjure a ball of fire that damages a target with fire damage",value:100,type:K.DamageScroll,damageType:W.Fire,useFunc:Se,statusEffect:Y.OnFire},lightning_scroll_weak_wild:{displayName:"Weak Scroll of Wild Lightning",description:"Summons a lightning bolt that's beyond your control and attacks randomly with lightning damage",value:50,type:K.WildDamageScroll,damageType:W.Electric,useFunc:ke},lightning_scroll_wild:{displayName:"Scroll of Wild Lightning",description:"Summons a lightning bolt that's beyond your control and attacks randomly with lightning damage",value:100,type:K.WildDamageScroll,damageType:W.Electric,useFunc:ke},lightning_scroll_strong_wild:{displayName:"Strong Scroll of Wild Lightning",description:"Summons a lightning bolt that's beyond your control and attacks randomly with lightning damage",value:150,type:K.WildDamageScroll,damageType:W.Electric,useFunc:ke},fireball_scroll_weak_wild:{displayName:"Weak Scroll of Wild Fire",description:"Summons a ball of fire that's beyond your control and attacks randomly with fire damage",value:50,type:K.WildDamageScroll,damageType:W.Fire,useFunc:ke,statusEffect:Y.OnFire},fireball_scroll_wild:{displayName:"Scroll of Wild Fire",description:"Summons a ball of fire that's beyond your control and attacks randomly with fire damage",value:100,type:K.WildDamageScroll,damageType:W.Fire,useFunc:ke,statusEffect:Y.OnFire},fireball_scroll_strong_wild:{displayName:"Strong Scroll of Wild Fire",description:"Summons a ball of fire that's beyond your control and attacks randomly with fire damage",value:150,type:K.WildDamageScroll,damageType:W.Fire,useFunc:ke,statusEffect:Y.OnFire},confuse_scroll:{displayName:"Scroll of Confuse Enemy",description:"Your target loses control of their actions",value:8,type:K.ConfuseScroll,useFunc:Ae},clairvoyance_scroll:{displayName:"Scroll of Clairvoyance",description:"Use sensory magics to learn the layout of the whole map",value:null,type:K.ClairvoyanceScroll,useFunc:Oe},haste_potion_weak:{displayName:"Weak Potion of Haste",description:"Haste gives you more actions per turn",value:5,type:K.HasteSelf,useFunc:Pe},slow_poison_weak:{displayName:"Weak Poison of Slow",description:"Only allow your target to take one action per two turns",value:5,type:K.SlowOther,useFunc:Ie}},Le={lightning_bolt:{id:"lightning_bolt",displayName:"Lightning Bolt",description:"Send a bolt of lighting hurtling towards your foes",value:20,type:X.DamageOther,damageType:W.Electric,useFunc:Se},wild_lightning_bolt:{id:"wild_lightning_bolt",displayName:"Wild Lightning Bolt",description:"Summons a lightning bolt that's beyond your control and attacks randomly with lightning damage",value:30,type:X.WildDamage,damageType:W.Electric,useFunc:ke},fireball:{id:"fireball",displayName:"Fireball",description:"Hurl a ball of fire",value:20,type:X.DamageOther,damageType:W.Fire,useFunc:Se,statusEffect:Y.OnFire},wild_fireball:{id:"wild_fireball",displayName:"Wild Fireball",description:"Summons a ball of fire that's beyond your control and attacks randomly",value:30,type:X.WildDamage,damageType:W.Fire,useFunc:ke},confuse:{id:"confuse",displayName:"Confuse",description:"Your target loses control of their actions",value:8,type:X.DamageOther,useFunc:Ae},clairvoyance:{id:"clairvoyance",displayName:"Clairvoyance",description:"Use sensory magics to learn the layout of the whole map",value:null,type:X.Passive,useFunc:Oe},lesser_heal:{id:"lesser_heal",displayName:"Lesser Heal",description:"Heals a small amount of hit points",value:25,type:X.HealSelf,useFunc:xe},heal:{id:"heal",displayName:"Heal",description:"Heals a good amount of health",value:50,type:X.HealSelf,useFunc:xe},greater_heal:{id:"greater_heal",displayName:"Greater Heal",description:"Gives a large amount of health",value:100,type:X.HealSelf,useFunc:xe},heal_other:{id:"heal_other",displayName:"Heal Other",description:"Heals someone else for a small amount of hit points",value:25,type:X.HealOther,useFunc:function(e,t,n,r,i,o){if(null===e.value)throw new Error("Item does not have a value for castDamageSpell");const a=St(n,r,i,o);if(null===a)return ve("Canceled casting"),!1;const s=a.getOne(Mt),l=a.getOne(Ft);return void 0===l?(ve(s.name+" isn't healable"),!1):(Cn(l,e.value),!0)}},lesser_haste:{id:"lesser_haste",displayName:"Lesser Haste",description:"Haste gives you more actions per turn",value:10,type:X.Effect,useFunc:Pe},lesser_slow:{id:"lesser_slow",displayName:"Lesser Slow",description:"Only allow your target to take one action per two turns",value:10,type:X.DamageOther,useFunc:Ie},fire_wall:{id:"fire_wall",displayName:"Wall of Fire",description:"Conjure a wall of flame that damages all who walk through it",value:10,type:X.DamageOther,damageType:W.Fire,areaOfEffect:{width:1,height:6},useFunc:function(e,t,n,r,i,o,a){return Me(e,0,n,r,i,o,a,"fire_effect")}},ice_wall:{id:"ice_wall",displayName:"Wall of Ice",description:"Conjure a wall of ice that blocks foe's path",value:null,type:X.DamageOther,areaOfEffect:{width:1,height:6},useFunc:function(e,t,n,r,i,o,a){return Me(e,0,n,r,i,o,a,"ice_wall")}},combust:{id:"combust",displayName:"Combust",description:"Doesn't do much damage, but is guaranteed to light something on fire",value:5,type:X.DamageOther,useFunc:function(e,t,n,r,i,o){const a=St(n,r,i,o);return null===a?(ve("Canceled casting"),!1):(Ce(a),!0)}},rain:{id:"rain",displayName:"Rain",description:"Calls a storm which makes everything wet",value:15,type:X.Passive,useFunc:function(e,t,n,r,i){if(null===e.value)throw new Error("value cannot be null for castRain");const o=n.entities.values();for(const t of o)Te(t,e.value);for(let e=0;e<30;e++){const{x:e,y:t}=lt(r,i);dn(n,"puddle",e,t)}return!0}},silence:{id:"silence",displayName:"Silence",description:"Removes the target's ability to cast spells for a number of turns",value:3,type:X.DamageOther,useFunc:function(e,t,n,r,i,o){if(null===e.value)throw new Error("Item does not have a value for castDamageSpell");const a=St(n,r,i,o);if(null===a)return ve("Canceled casting"),!1;const s=a.getOne(Mt),l=a.getOne(Bt),u=a.getOne(rn);return void 0===u&&void 0!==l?(ve(s.name+" is immune to silence effects"),!1):void 0===u?(ve(s.name+" cannot be silenced because it doesn't know any spells"),!1):(ve(s.name+" is silenced"),u.silenced=!0,u.turnsLeft=e.value,u.update(),!0)}}};function De(e){const t=[];for(const[n,r]of e.inventory){const e=Ge[n];t.push({id:n,displayName:e.displayName,description:e.description,type:e.type,count:r,value:e.value})}return t}function je(e,t){return e.inventory.has(t)}function Fe(e,t,n=1){if(null===i.Game)throw new Error("Global Game object is null");if(null===i.gameEventEmitter)throw new Error("Global gameEventEmitter object is null");if(!(t in Ge))throw new Error(t+" is not a valid item id");if(je(e,t)){const r=e.inventory.get(t)+n;if(100===r)return!1;e.inventory.set(t,r)}else e.inventory.set(t,n);return e.entity===i.Game.player&&(i.gameEventEmitter.emit("tutorial.inventory"),Ge[t].type===K.WildDamageScroll&&i.gameEventEmitter.emit("tutorial.wildSpells")),!0}function Ne(e,t){if(!je(e,t))throw new Error(`Item ${t} not in inventory`);const n=e.inventory.get(t)-1;0===n?e.inventory.delete(t):e.inventory.set(t,n)}function Re(e){return function(t,n,r){var i;const o=r.getOne(Bt);if(void 0===o)return!1;const a=r.getOne(rn);return!0!==(null==a?void 0:a.silenced)&&(null!==(i=o.knownSpells.get(e))&&void 0!==i?i:-1)>0}}const He={targetPositionKnown:{resolver:function(e,t,n){const r=n.getOne(qt);return!0===(null==r?void 0:r.knowsTargetPosition)}},targetInLineOfSight:{resolver:function(e,t,n){const r=n.getOne(qt);return!0===(null==r?void 0:r.hasTargetInSight)}},nextToTarget:{resolver:function(e,t,n){const r=n.getOne(qt);if(void 0===r||null===r.target)throw new Error(`Entity ${n.id} is missing a target`);const i=n.getOne(Pt),o=r.target.getOne(Pt);if(void 0===i||void 0===o)throw new Error(`Entity ${n.id} is missing data for resolveNextToTarget`);return at(i,o)<1.5}},lowHealth:{resolver:function(e,t,n){const r=_n(n),i=n.getOne(qt);return null!==r&&void 0!==i&&r.hp/r.maxHp<=i.lowHealthThreshold}},hasHealingItem:{resolver:function(e,t,n){const r=n.getOne(jt);return void 0!==r&&De(r).filter(e=>e.type===K.HealSelf).length>0}},hasSelfHealingSpell:{resolver:function(e,t,n){const r=n.getOne(Bt);return void 0!==r&&En(r).filter(e=>e.type===X.HealSelf&&e.count>0).length>0}},hasOtherHealingSpell:{resolver:function(e,t,n){const r=n.getOne(Bt);return void 0!==r&&En(r).filter(e=>e.type===X.HealOther&&e.count>0).length>0}},hasAliveAllies:{resolver:function(e,t,n){const r=n.getOne(Pt),i=e.createQuery().fromAll(Pt,qt,Ft).execute();for(const e of i){if(e.id===n.id)continue;const t=e.getOne(Pt),i=e.getOne(Ft);if(at(t,r)<12&&i.hp>0)return!0}return!1}},allyLowHealth:{resolver:function(e,t,n){const r=n.getOne(Pt),i=n.getOne(qt),o=e.createQuery().fromAll(Pt,qt,Ft).execute();let a=null,s=null;for(const e of o){if(e===i.target||e===n)continue;const t=e.getOne(Ft),o=e.getOne(Pt),l=e.getOne(qt),u=t.hp/t.maxHp<=l.lowHealthThreshold;at(r,o)<10&&u&&(null===a||t.hp<s.hp)&&(a=o,s=t)}return null!==a}},inDangerousArea:{resolver:function(e,t,n){const r=n.getOne(Pt),i=[[r.x,r.y]];for(let e=0;e<P[8].length;e++){const t=P[8][e],n=r.x+t[0],o=r.y+t[1];i.push([n,o])}for(let e=0;e<i.length;e++){const n=i[e],r=rt(t,n[0],n[1]);for(let e=0;e<r.length;e++){const t=r[e],n=t.getOne(tn);if(void 0!==t.getOne(an)||void 0!==n&&n.onFire&&!t.tags.has("sentient"))return!0}}return!1}},targetKilled:{resolver:function(e,t,n){const r=n.getOne(qt);return void 0!==r&&null===r.target}},afraid:{resolver:function(e,t,n){const r=n.getOne(Kt);return void 0!==r&&r.fear>=r.fearThreshold}},cowering:{resolver:function(e,t,n){var r,i;const o=n.getOne(Kt),a=n.getOne(Pt);return void 0!==o&&void 0!==a&&(a.x===(null===(r=o.runAwayTarget)||void 0===r?void 0:r.x)&&a.y===(null===(i=o.runAwayTarget)||void 0===i?void 0:i.y))}},atDesiredDistance:{resolver:function(e,t,n){const r=n.getOne(qt);if(void 0===r||null===r.target)throw new Error(`Entity ${n.id} is missing a target`);const i=n.getOne(Pt),o=r.target.getOne(Pt);if(void 0===i||void 0===o)throw new Error(`Entity ${n.id} is missing data for resolveNextToTarget`);return Math.floor(at(i,o))===r.desiredDistanceToTarget}},atFallbackPosition:{resolver:function(e,t,n){const r=n.getOne(Xt);return void 0!==r&&!0===r.isAtFallbackPosition}}};for(const e in Le){He["hasCastsFor_"+e]={resolver:Re(e)}}function $e(e,t,n,r,o,a,s,l=!0){const u=new $.AStar(a.x,a.y,mt(o),function(e,t,n,r){return function(e,o){var a;if(null===i.Game)throw new Error("Global game object is null");const s=[];for(let r=0;r<P[8].length;r++){const i=P[8][r],a=e+i[0],l=o+i[1];it(t,n,a,l).blocks||s.push([a,l])}let l=Math.max(Math.abs(e-r.x),Math.abs(o-r.y));if(e!==r.x||o!==r.y){const t=rt(n,e,o);for(let e=0;e<t.length;e++){const n=t[e].getOne(on);if(void 0!==n)switch(n.triggerType){case Z.Fire:l+=20;break;case Z.ShallowWater:l+=2;break;case Z.DeepWater:case Z.Mud:l+=7;break;case Z.Event:break;default:te(n.triggerType)}}for(let e=0;e<s.length;e++){const t=s[e],r=rt(n,t[0],t[1]);for(let e=0;e<r.length;e++){void 0!==r[e].getOne(an)&&(l+=5)}}}return!0===(null===(a=i.Game)||void 0===a?void 0:a.debugPathfinding)&&(i.Game.map[o][e].pathfindingCost=l.toString(10)),l}}(0,t,n,o),{topology:8}),c=[];return u.compute(o.x,o.y,(function(e,t){c.push([e,t])})),c.shift(),l&&c.pop(),c.length>0?c.slice(0,s):null}function ze(e,t,n,r){if(null===r.target)throw new Error("Cannot perform chaseAction without a target");const i=r.entity.getOne(Rt),o=r.entity.getOne(Pt),a=r.target.getOne(Pt);if(void 0===i||void 0===o)throw new Error("Missing data for "+r.entity.id);if(void 0===a)throw new Error("Missing data for "+r.target.id);const s=$e(0,t,n,r.entity,o,a,i.maxTilesPerMove);return null===s?new yt(!0):new vt(s,e,t,n)}function We(e,t,n,r){const i=r.entity.getOne(Pt),o=r.entity.getOne(Bt),a=r.entity.getOne(Mt);if(void 0===i)throw new Error("No position on AI for healAllyAction");if(void 0===o)throw new Error("No spells on AI for healAllyAction");if(void 0===a)throw new Error(`Entity ${r.entity.id} is missing DisplayNameComponent`);const s=En(o).filter(e=>e.type===X.HealOther).sort((e,t)=>e.value-t.value)[0],l=e.createQuery().fromAll(Pt,qt,Ft).execute();let u=null,c=null;for(const e of l){const t=e.getOne(Ft),n=e.getOne(Pt),r=t.hp/t.maxHp;at(i,n)<10&&(null===u||r<c)&&(u=n,c=r)}if(null===u)throw new Error("Should never get here, there's a bug in goal allyLowHealth");return ve(`${a.name} casted ${s.displayName}`),new Ct(s.id,e,t,n,u)}function Ue(e){return function(t,n,r,i){if(null===i.target)throw new Error("Cannot cast spell without a target");const o=i.entity.getOne(Bt),a=i.entity.getOne(Mt);if(void 0===o)throw new Error(`No spells on ${i.entity.id} for castSpellAction`);if(void 0===a)throw new Error(`Entity ${i.entity.id} is missing DisplayNameComponent`);if(-1===En(o).map(e=>e.id).indexOf(e))throw new Error(`${a.name} does not know spell ${e}`);const s=i.target.getOne(Pt);if(void 0===s)throw new Error(`Target entity ${i.target.id} is missing PositionComponent`);return new Ct(e,t,n,r,s)}}function Be(e){return function(t,n){var r;if(null===n.target)return 1;const i=n.target.getOne(Ft),o=null!==(r=Le[e].value)&&void 0!==r?r:1;return Math.max(1,i.hp-o)}}const qe={wander:{preconditions:{targetPositionKnown:!1},postconditions:{targetPositionKnown:!0},updateFunction:function(e,t,n,r){var i,o;let a=!0,l=null,u=0,c=0,h=null!==(i=s.a.getItem([0,1,2,3,4,5,6,7]))&&void 0!==i?i:0;const d=r.entity.getOne(Pt);do{h=null!==(o=s.a.getItem([0,1,2,3,4,5,6,7]))&&void 0!==o?o:0,u=d.x+P[8][h][0],c=d.y+P[8][h][1],({blocks:a,entity:l}=it(t,n,u,c))}while(!0===a||null!==l);return new vt([[u,c]],e,t,n)},weight:()=>1},guard:{preconditions:{targetPositionKnown:!1},postconditions:{targetPositionKnown:!0},updateFunction:()=>new yt(!0),weight:()=>1},patrol:{preconditions:{targetPositionKnown:!1},postconditions:{targetPositionKnown:!0},updateFunction:function(e,t,n,r){const i=r.entity.getOne(Pt),o=r.entity.getOne(Yt);if(void 0===o||void 0===i)throw new Error("Cannot patrol without a patrolState or position");if(null===o.patrolTarget)throw new Error("Null patrol target for entity "+r.entity.id);let a=o.patrolTarget.getOne(Pt),s=$e(0,t,n,r.entity,i,a,2);if(null===s){const e=o.patrolTarget.getOne(Qt);if(void 0===e)throw new Error("Missing patrol link on node "+o.patrolTarget.id);if(o.patrolTarget=e.next,null===o.patrolTarget)return new yt(!0);a=o.patrolTarget.getOne(Pt),s=$e(0,t,n,r.entity,i,a,2)}return null===s?new yt(!0):new vt(s,e,t,n)},weight:()=>1},chase:{preconditions:{targetPositionKnown:!0,targetInLineOfSight:!1},postconditions:{targetInLineOfSight:!0},updateFunction:ze,weight:()=>1},standby:{preconditions:{targetPositionKnown:!0,atDesiredDistance:!0,hasAliveAllies:!0,targetKilled:!1},postconditions:{targetKilled:!0},updateFunction:()=>new yt(!0),weight:function(e,t){if(null===t.target)throw new Error("Cannot find standbyWeight without a target");const n=t.target.getOne(Ft);if(void 0===n)throw new Error("target is missing a HitPointsComponent");const r=t.entity.getOne(Bt);if(void 0!==r){const e=En(r);for(let t=0;t<e.length;t++){const r=e[t];if(r.type===X.DamageOther&&r.count>0)return n.hp}}return 1}},reposition:{preconditions:{targetPositionKnown:!0,atDesiredDistance:!1,hasAliveAllies:!0,targetKilled:!1},postconditions:{atDesiredDistance:!0},updateFunction:function(e,t,n,r){if(null===r.target)throw new Error("Cannot perform chaseAction without a target");const i=r.entity.getOne(Pt),o=r.target.getOne(Pt),a=r.entity.getOne(Rt);if(void 0===i||void 0===a||void 0===o)throw new Error("Missing data when trying to reposition");const s=new $.ReverseAStar((e,t)=>{const n=at({x:e,y:t},o);return Math.floor(n)===r.desiredDistanceToTarget},mt(i));let l=[];return s.compute(i.x,i.y,(function(e,t){l.splice(0,0,[e,t])})),0===l.length?new yt(!0):(l.shift(),l=l.slice(0,a.maxTilesPerMove),new vt(l,e,t,n))},weight:()=>1},useHealingItem:{preconditions:{lowHealth:!0,hasHealingItem:!0},postconditions:{lowHealth:!1},updateFunction:function(e,t,n,r){const i=r.entity.getOne(jt),o=r.entity.getOne(Mt);if(void 0===i)throw new Error("No inventory on owner for AI for useHealingItemAction");if(void 0===o)throw new Error(`Entity ${r.entity.id} is missing DisplayNameComponent`);const a=De(i).filter(e=>e.type===K.HealSelf).sort((e,t)=>e.value-t.value)[0];return ve(`${o.name} used a ${a.displayName}`),new xt(a.id,e,t,n)},weight:()=>1},useHealingSpell:{preconditions:{lowHealth:!0,hasSelfHealingSpell:!0},postconditions:{lowHealth:!1},updateFunction:function(e,t,n,r){const i=r.entity.getOne(Bt),o=r.entity.getOne(Mt);if(void 0===i)throw new Error("No spells on owner for AI for useHealingSpellAction");if(void 0===o)throw new Error(`Entity ${r.entity.id} is missing DisplayNameComponent`);const a=En(i).filter(e=>e.type===X.HealSelf).sort((e,t)=>e.value-t.value)[0];return ve(`${o.name} casted ${a.displayName}`),new Ct(a.id,e,t,n)},weight:()=>1},healAlly:{preconditions:{allyLowHealth:!0,hasOtherHealingSpell:!0},postconditions:{allyLowHealth:!1},updateFunction:We,weight:()=>1},goToEnemy:{preconditions:{targetPositionKnown:!0,nextToTarget:!1},postconditions:{nextToTarget:!0},updateFunction:ze,weight:function(e,t){if(null===t.target)return 1;const n=t.entity.getOne(Pt),r=t.target.getOne(Pt);if(void 0===n||void 0===r)throw new Error("no position data for ai");return at(n,r)}},meleeAttack:{preconditions:{nextToTarget:!0,targetKilled:!1},postconditions:{targetKilled:!0},updateFunction:function(e,t,n,r){if(null===r.target)throw new Error("Cannot perform meleeAttackAction without a target");return new _t(r.target)},weight:function(e,t){if(null===t.target)return 1;const n=t.target.getOne(Ft),r=wn(t.entity);return Math.max(1,n.hp-r.strength)}},goToSafePosition:{preconditions:{inDangerousArea:!0},postconditions:{inDangerousArea:!1},updateFunction:function(e,t,n,r){const i=r.entity.getOne(Pt),o=r.entity.getOne(Rt);if(void 0===i||void 0===o)throw new Error("Missing data when trying to run away");const a=new $.ReverseAStar((t,n)=>!function(e,t,n,r){const i=new Set;i.add(`${n},${r}`);for(let e=0;e<P[8].length;e++){const t=P[8][e],o=n+t[0],a=r+t[1];i.add(`${o},${a}`)}const o=e.entities.values();for(const e of o){if(e===t)continue;const n=e.getOne(Pt);if(void 0!==n&&i.has(`${n.x},${n.y}`)){const t=e.getOne(tn);if(void 0!==e.getOne(an)||void 0!==t)return!0}}return!1}(e,r.entity,t,n),mt(i));let s=[];return a.compute(i.x,i.y,(function(e,t){s.splice(0,0,[e,t])})),0===s.length?new yt(!0):(s.shift(),s=s.slice(0,o.maxTilesPerMove),new vt(s,e,t,n))},weight:()=>1},runAway:{preconditions:{afraid:!0,cowering:!1},postconditions:{afraid:!1,cowering:!0},updateFunction:function(e,t,n,r){const i=r.entity.getOne(Pt),o=r.entity.getOne(Kt),a=r.entity.getOne(Rt);if(void 0===i||void 0===o||void 0===a)throw new Error("Missing data when trying to run away");let s=[];if(null===o.runAwayTarget){let e=0;do{o.runAwayTarget=lt(t,n),s=$e(0,t,n,r.entity,i,o.runAwayTarget,a.maxTilesPerMove),e++}while(null===s||e<5)}else s=$e(0,t,n,r.entity,i,o.runAwayTarget,a.maxTilesPerMove,!1);return null===s?new yt(!0):(s[s.length-1][0]===o.runAwayTarget.x&&s[s.length-1][1]===o.runAwayTarget.y&&(o.fear=0,o.runAwayTarget=null),new vt(s,e,t,n))},weight:()=>1},goToFallbackPosition:{preconditions:{atFallbackPosition:!1},postconditions:{atFallbackPosition:!0},updateFunction:()=>new yt(!0),weight:()=>1}};for(const e in Le){const t=Le[e],n="hasCastsFor_"+e,r="castSpell_"+e;t.type===X.DamageOther||t.type===X.WildDamage?qe[r]={preconditions:{[n]:!0,targetInLineOfSight:!0,targetKilled:!1},postconditions:{targetKilled:!0},updateFunction:Ue(e),weight:Be(e)}:t.type===X.HealSelf?qe[r]={preconditions:{lowHealth:!0,[n]:!0},postconditions:{lowHealth:!1},updateFunction:Ue(e),weight:()=>1}:t.type===X.HealOther&&(qe[r]={preconditions:{allyLowHealth:!0,[n]:!0},postconditions:{allyLowHealth:!1},updateFunction:We,weight:()=>1})}function Ve(e){var t;const n=e.getOne(qt),r=e.getOne(Kt),i=null===(t=n.target)||void 0===t?void 0:t.getOne(Pt);return function(t,o,a,s){void 0!==i&&t===i.x&&o===i.y&&s>0&&(void 0!==r&&!1===n.knowsTargetPosition&&(r.fear+=function(e){const t=e.getOne(qt),n=e.getOne(Wt);if(null===t.target)throw new Error("Should set target here");const r=t.target.getOne(Wt);return void 0===n||void 0===r?1:Math.max(r.level-n.level,0)}(e),r.update()),n.knowsTargetPosition=!0,n.hasTargetInSight=!0,n.update())}}function Ke(e){return function(t,n){if(null===i.Game)throw new Error("Global game object is null");return e.x===t&&e.y===n||!1===function(e,t,n,r){if(0===t.length)throw new Error("Bad map data");if(n<0||r<0||n>=t[0].length||r>=t.length||t[r][n].blocksSight)return!0;const i=e.createQuery().fromAll(Pt,"blocksSight").execute();for(const e of i){const t=e.getOne(Pt);if(t.x===n&&t.y===r)return!0}return!1}(i.Game.ecs,i.Game.map,t,n)}}function Xe(e){const t=new Set,n=new ye;for(const r of e){const e=qe[r];if(void 0===e)throw new Error(r+" is not a valid action");const i=Object.keys(e.preconditions),o=Object.keys(e.postconditions);for(let e=0;e<i.length;e++)t.add(i[e]);for(let e=0;e<o.length;e++)t.add(o[e]);n.addCondition(r,e.preconditions),n.addReaction(r,e.postconditions)}const r=new ge(...t.values());return r.setActionList(n),{planner:r,goals:t}}function Ye(e,t,n){var r,o;const a=n.entity.getOne(Mt);if(void 0===a)throw new Error(`Entity ${n.entity.id} is missing a DisplayNameComponent`);const s=function(e,t,n){const r={};for(const i of n.goals){const o=He[i];r[i]=o.resolver(e,t,n.entity)}return r}(e,t,n),l=n.entity.getOne(Vt);if(void 0!==l&&!1===s.targetInLineOfSight&&n.knowsTargetPosition&&(l.turnsWithTargetOutOfSight++,l.turnsWithTargetOutOfSight===l.loseTrackAfterNTurns&&(n.knowsTargetPosition=!1,l.turnsWithTargetOutOfSight=0,s.targetPositionKnown=!1,ve(a.name+" lost track of you")),l.update()),Object(J.isEqual)(n.previousWorldState,s))return n.currentAction;!1===n.previousWorldState.targetPositionKnown&&!0===s.targetPositionKnown&&ve(a.name+" saw you");const u=Object.keys(n.planner.actionList.reactions);for(let t=0;t<u.length;t++){const o=u[t],a=qe[o];if(void 0!==a){const t=a.weight(e,n);n.planner.actionList.setWeight(o,t),!0===(null===(r=i.Game)||void 0===r?void 0:r.debugAI)&&console.log(`${n.entity.id}, action ${o} weight ${t}`)}}n.planner.setStartState(s);const c=[];let h;"attack"===n.currentOrder&&c.push({targetKilled:!0}),n.goals.has("lowHealth")&&!0===s.lowHealth&&c.push({lowHealth:!1}),n.goals.has("allyLowHealth")&&!0===s.allyLowHealth&&c.push({allyLowHealth:!1}),n.goals.has("inDangerousArea")&&!0===s.inDangerousArea&&c.push({inDangerousArea:!1}),"fallback"===n.currentOrder&&n.goals.has("atFallbackPosition")&&c.push({atFallbackPosition:!0}),n.goals.has("afraid")&&!0===s.afraid&&c.push({cowering:!0});do{h=c.pop(),n.planner.setGoalState(h);const e=n.planner.calculate();n.currentAction=Object(J.get)(e,"['0'].name",null)}while(c.length>0&&null===n.currentAction);return!0===(null===(o=i.Game)||void 0===o?void 0:o.debugAI)&&console.log(`${n.entity.id}, goal ${JSON.stringify(h)} currentAction ${n.currentAction}`),n.previousWorldState=s,n.currentAction}function Qe(e,t,n,r){const o=t.getOne(qt);if(void 0!==t.getOne(Zt))return function(e,t,n,r){var o,a;const l=t.getOne(Zt);if(void 0===l)throw new Error(`Entity ${t.id} is missing a ConfusedAIComponent`);const u=t.getOne(Pt),c=t.getOne(Mt);if(void 0===u||void 0===c)throw new Error(`Entity ${t.id} is missing a data`);if(l.turnsLeft--,l.turnsLeft>0){let t=!0,i=0,c=0,h=null!==(o=s.a.getItem([0,1,2,3,4,5,6,7]))&&void 0!==o?o:0;do{h=null!==(a=s.a.getItem([0,1,2,3,4,5,6,7]))&&void 0!==a?a:0,i=u.x+P[8][h][0],c=u.y+P[8][h][1],({blocks:t}=it(n,r,i,c))}while(!0===t);return l.update(),new vt([[i,c]],e,n,r)}return l.destroy(),t===i.Game.player?ve("You are no longer confused"):ve(c.name+" is no longer confused"),new yt(!0)}(e,t,n,r);if(void 0!==o)return function(e,t,n,r){const i=t.getOne(qt),o=t.getOne(Pt);if(void 0===o||void 0===i)throw new Error(`Entity ${t.id} is missing a position component`);new R.PreciseShadowcasting(Ke(o)).compute(o.x,o.y,i.sightRange,Ve(t));const a=Ye(e,r,i);return i.hasTargetInSight=!1,null!==a?qe[a].updateFunction(e,n,r,i):new yt(!0)}(e,t,n,r);throw new Error("Missing AI state on entity "+t.id)}const Ze={forrest_001:se,durdwin_001:le,dev_room:ue},Je={780:{name:"Gravestone",char:"ߡ",fgColor:"white",bgColor:"brown",fgColorExplored:"white",bgColorExplored:"black",blocks:!0,blocksSight:!1,reflectivity:.18},964:{name:"grass",char:".",fgColor:"green",bgColor:"white",fgColorExplored:"white",bgColorExplored:"rgb(50, 50, 50)",blocks:!1,blocksSight:!1,reflectivity:.18},980:{name:"A stove",char:"⌻",fgColor:"black",bgColor:"brown",fgColorExplored:"white",bgColorExplored:"black",blocks:!0,blocksSight:!1,reflectivity:.18},1048:{name:"A wall",char:"",fgColor:"#352620",bgColor:"#352620",fgColorExplored:"black",bgColorExplored:"black",blocks:!0,blocksSight:!0,reflectivity:.18},1165:{name:"A tree",char:"⏃",fgColor:"lightgreen",bgColor:"darkgreen",fgColorExplored:"grey",bgColorExplored:"black",blocks:!0,blocksSight:!0,reflectivity:.18},1543:{name:"bed",char:"▃",fgColor:"gold",bgColor:"white",fgColorExplored:"white",bgColorExplored:"black",blocks:!0,blocksSight:!1,reflectivity:.18},2710:{name:"A table",char:"Π",fgColor:"tan",bgColor:"brown",fgColorExplored:"white",bgColorExplored:"black",blocks:!0,blocksSight:!1,reflectivity:.18},2869:{name:"A chair",char:"п",fgColor:"black",bgColor:"brown",fgColorExplored:"white",bgColorExplored:"black",blocks:!0,blocksSight:!1,reflectivity:.18},2936:{name:"A cabinet",char:"⌹",fgColor:"black",bgColor:"brown",fgColorExplored:"white",bgColorExplored:"black",blocks:!0,blocksSight:!1,reflectivity:.18}};Object.freeze(Je);const et=new Map([[28,"water"],[32,"shallow_water"],[900,"mud"],[831,"tall_grass"]]);class tt{constructor(e,t,n,r,i,o,a,s,l=!1,u=!1){this.pathfindingCost="0",this.name=e,this.char=t,this.fgColor=n,this.bgColor=r,this.fgColorExplored=i,this.bgColorExplored=o,this.blocks=a,this.blocksSight=s,this.visible=l,this.explored=u,this.reflectivity=.18,this.lightingColor=r}isVisibleAndLit(){return this.visible&&"rgb(50, 50, 50)"!==this.lightingColor}}function nt(e,t){if(void 0===e.properties||0===e.properties.length)return null;const n=e.properties.filter(e=>e.name===t);return 0===n.length?null:n[0].value}function rt(e,t,n){var r;return null!==(r=e.get(`${t},${n}`))&&void 0!==r?r:[]}function it(e,t,n,r){if(0===e.length)throw new Error("Bad map data");if(n<0||r<0||n>=e[0].length||r>=e.length||e[r][n].blocks)return{entity:null,blocks:!0};const i=t.get(`${n},${r}`);if(void 0===i)return{entity:null,blocks:!1};let o;for(const e of i)(void 0===o||void 0!==o&&!o.tags.has("blocks")&&e.tags.has("blocks"))&&(o=e);return void 0!==o?{entity:o,blocks:o.tags.has("blocks")}:{entity:null,blocks:!1}}function ot(e,t,n,r){if(n>e._options.width||n<0||r>e._options.height||r<0)return;let i="",o="";t.blocks?t.isVisibleAndLit()?(i=t.fgColor,o=t.bgColor):t.explored?t.explored&&!t.isVisibleAndLit()&&(i=t.fgColorExplored,o=t.bgColorExplored):(i="black",o="black"):t.isVisibleAndLit()?(i=t.fgColor,o=Object(f.toRGB)(Object(f.multiply)(Object(f.fromString)(t.bgColor),Object(f.fromString)(t.lightingColor)))):t.explored?(i="rgb(50, 50, 50)",o="rgb(50, 50, 50)"):(i="black",o="black"),"black"===i&&"black"===o||e.draw(n,r,t.char,i,o)}function at(e,t){const n=t.x-e.x,r=t.y-e.y;return Math.sqrt(n**2+r**2)}function st(e,t,n,r){const i=e.createQuery().fromAll(Pt,Ft,qt).execute(),o=[];for(const e of i){const t=e.getOne(Pt);t!==n&&at(n,t)<=r&&o.push(e)}return o.length>0?s.a.getItem(o):null}function lt(e,t){const n=e[0].length,r=e.length;let i,o=!1,a=0,s=0;do{a=ee(0,n),s=ee(0,r),({entity:i,blocks:o}=it(e,t,a,s))}while(null!==i||!0===o);return{x:a,y:s}}function ut(e,t=!1,n=!1){for(let r=0;r<e.length;r++)for(let i=0;i<e[r].length;i++)e[r][i].explored=!0,t&&(e[r][i].visible=!0),n&&(e[r][i].lightingColor="white")}function ct(e,t){const n=e.getOne(tn);if(void 0!==n){const r=t.getOne(an);if(void 0===r)throw new Error("Fire trigger is missing its data");if(!Ce(e,Math.max(n.fireDamage,r.effectDamage),Math.max(n.turnsLeft,r.effectTurns)))return;xn(e,r.damage,!1,W.Fire)}}function ht(e,t){if(null===i.gameEventEmitter)throw new Error("Global gameEventEmitter object is null");const n=t.getOne(sn),r=e.getOne(It);if(void 0===n)throw new Error(`Event trigger ${t.id} is missing a EventTriggerComponent`);if(void 0===r)throw new Error(`Actor ${e.id} is missing a TypeComponent`);"player"===r.entityType&&i.gameEventEmitter.emit(n.event)}function dt(e){void 0!==e.getOne(Rt)&&e.addComponent({type:"SpeedEffectComponent",stat:"maxTilesPerMove",modifierType:"multiply",turnsLeft:1,value:.1})}function pt(e){var t;Te(e,10);const n=e.getOne(nn);void 0!==n&&!1===n.wet&&e===(null===(t=i.Game)||void 0===t?void 0:t.player)&&ve("You are now wet from stepping in the water")}function ft(e){var t;Te(e,20);const n=e.getOne(nn);void 0!==n&&!1===n.wet&&e===(null===(t=i.Game)||void 0===t?void 0:t.player)&&ve("You are now wet from stepping in the water");void 0!==e.getOne(Rt)&&e.addComponent({type:"SpeedEffectComponent",stat:"maxTilesPerMove",modifierType:"multiply",turnsLeft:1,value:.1})}function mt(e){return function(t,n){if(null===i.Game)throw new Error("Global game object is null");if(e.x===t&&e.y===n)return!0;const{blocks:r}=it(i.Game.map,i.Game.entityMap,t,n);return!r}}function gt(e,t,n,r,i){if(at(t,e)<2*n){const o=new $.AStar(t.x,t.y,mt(e),function(e){return function(t,n){return Math.max(Math.abs(t-e.x),Math.abs(n-e.y))}}(e),{topology:8});if(t.y>=r.length||t.x>=r[0].length)return null;if(!0===it(r,i,t.x,t.y).blocks)return null;const a=[];return o.compute(e.x,e.y,(function(e,t){a.push([e,t])})),0===a.length||a.length>n?null:(a.shift(),0===a.length?null:a)}return null}class yt{constructor(e){this.usesTurn=e}usedTurn(){return this.usesTurn}isFinished(){return!0}execute(){}}class vt{constructor(e,t,n,r){this.tilesMoved=0,this.usesTurn=!0,this.done=!1,this.path=e,this.ecs=t,this.map=n,this.entityMap=r}usedTurn(){return!0}isFinished(){return this.done}execute(e,t){var n;const r=this.path[0],{blocks:i}=it(this.map,this.entityMap,r[0],r[1]);if(!0===i)return void(this.done=!0);const o=t.getOne(Pt);if(void 0===o)throw new Error(`Entity ${t.id} does not have a position for GoToLocationCommand`);o.x=r[0],o.y=r[1],o.update(),this.tilesMoved++,this.path.shift();const a=t.getOne(tn),s=null!==(n=this.entityMap.get(`${o.x},${o.y}`))&&void 0!==n?n:[];for(let e=0;e<s.length;e++){const n=s[e],r=n.getOne(on),i=n.getOne(tn);if(void 0!==a&&!0===a.onFire&&void 0!==i&&!1===i.onFire&&Math.random()>=.5&&Ce(n,a.fireDamage,ee(3,6)),void 0!==r)switch(r.triggerType){case Z.Event:ht(t,n);break;case Z.Fire:ct(t,n);break;case Z.ShallowWater:pt(t);break;case Z.DeepWater:ft(t);break;case Z.Mud:dt(t);break;default:te(r.triggerType)}}const l=bn(t);(null!==l&&l.maxTilesPerMove<=this.tilesMoved||0===this.path.length)&&(this.done=!0)}}class _t{constructor(e){this.interacted=!0,this.target=e}usedTurn(){return this.interacted}isFinished(){return!0}execute(e,t){const n=t.getOne($t),r=this.target.getOne(ln),o=this.target.getOne(Ft);if(void 0===r){if(void 0!==o&&void 0!==n)return function(e,t){var n;const r=e.getOne(Wt),i=wn(e),o=e.getOne(Mt),a=t.getOne(Wt),l=t.getOne(Mt);if(null===i)throw new Error("Cannot attack damage without a StatsComponent");let u=Math.round(i.strength),c=!1;s.a.getUniform()<=i.criticalChance&&(u=Math.ceil(u*i.criticalDamageMultiplier),c=!0);if(u>0){const e=null!==(n=null==a?void 0:a.experienceGiven)&&void 0!==n?n:0;xn(t,u,c,W.Physical)&&void 0!==r&&(r.experience+=e,r.update())}else void 0!==o&&void 0!==l&&ve(`${o.name} attacks ${l.name}, but it's too weak!`)}(t,this.target),void(this.interacted=!0);this.interacted=!1}else{switch(r.interactableType){case Q.Door:!function(e,t){if(null===i.gameEventEmitter)throw new Error("Global gameEventEmitter object is null");i.gameEventEmitter.emit("door.open"),t.destroy()}(0,this.target);break;case Q.GiveItems:!function(e,t){const n=e.getOne(jt),r=t.getOne(jt);if(null===i.Game)throw new Error("Global game object is null");if(null===i.gameEventEmitter)throw new Error("Global gameEventEmitter object is null");if(void 0===n||void 0===r)throw new Error(`Missing inventory on ${e.id} or ${t.id}`);{const o=De(r);if(o.length>0){for(let e=0;e<o.length;e++){const t=o[e];ve("Found a "+Ge[t.id].displayName),Fe(n,t.id,t.count),Ne(r,t.id)}const a=t.getOne(It);e===i.Game.player&&"chest"===(null==a?void 0:a.entityType)&&i.gameEventEmitter.emit("chest.open"),"dropped_item"===(null==a?void 0:a.entityType)&&t.destroy()}else ve("Empty")}}(t,this.target);break;case Q.GiveSpells:!function(e,t){var n;const r=t.getOne(Bt);if(void 0===r)throw new Error(`Entity ${t.id} is missing a SpellsComponent`);for(const[t,o]of r.knownSpells.entries()){const r=Tn(e,t,o);e===(null===(n=i.Game)||void 0===n?void 0:n.player)&&ve(r?"You learned a new spell: "+Le[t].displayName:"You already know "+Le[t].displayName)}}(t,this.target);break;case Q.LoadLevel:!function(e,t){const n=t.getOne(un),r=t.getOne(It);if(void 0===n)throw new Error("No level name has been set for load");if(null===i.Game)throw new Error("Global game object is null");if(null===i.gameEventEmitter)throw new Error("Global gameEventEmitter object is null");i.Game.loadLevel(n.levelName),"load_door"===(null==r?void 0:r.entityType)&&i.gameEventEmitter.emit("door.open")}(0,this.target);break;default:te(r.interactableType)}this.interacted=!0}}}class wt{usedTurn(){return!1}isFinished(){return!0}execute(){if(null===i.Game)throw new Error("Global Game object is null");if(null===i.gameEventEmitter)throw new Error("Global gameEventEmitter is null");i.gameEventEmitter.emit("ui.openInventory"),i.Game.state=V.InventoryMenu}}class bt{usedTurn(){return!1}isFinished(){return!0}execute(){if(null===i.Game)throw new Error("Global Game object is null");if(null===i.gameEventEmitter)throw new Error("Global gameEventEmitter is null");i.gameEventEmitter.emit("ui.openSpells"),i.Game.state=V.SpellMenu}}class xt{constructor(e,t,n,r,i,o){this.didUseItem=!0,this.itemID=e,this.target=i,this.map=n,this.ecs=t,this.entityMap=r,this.rotation=o}usedTurn(){return this.didUseItem}isFinished(){return!0}execute(e,t){const n=t.getOne(jt);if(void 0===n)throw new Error("Cannot use an item without an inventory");if(!je(n,this.itemID))throw new Error(`Cannot use ${this.itemID}, not in inventory`);const r=Ge[this.itemID];if(r.useFunc(r,t,this.ecs,this.map,this.entityMap,this.target,this.rotation))return Ne(n,this.itemID),void(this.didUseItem=!0);this.didUseItem=!1}}class Ct{constructor(e,t,n,r,i,o){this.didUseSpell=!1,this.spellID=e,this.ecs=t,this.map=n,this.entityMap=r,this.target=i,this.rotation=o}usedTurn(){return this.didUseSpell}isFinished(){return!0}execute(e,t){var n,r;const o=t.getOne(Bt);if(void 0===o||!1===o.knownSpells.has(this.spellID))return;const a=Le[this.spellID];if((null!==(n=o.knownSpells.get(this.spellID))&&void 0!==n?n:-1)<1)return this.didUseSpell=!1,void(t===(null===(r=i.Game)||void 0===r?void 0:r.player)&&ve("You don't have enough casts to use "+a.displayName));if(this.didUseSpell=a.useFunc(a,t,this.ecs,this.map,this.entityMap,this.target,this.rotation),this.didUseSpell){!function(e,t){if(!e.knownSpells.has(t))throw new Error(`Item ${t} not in inventory`);const n=e.knownSpells.get(t)-1;n>-1&&e.knownSpells.set(t,n);e.update()}(t.getOne(Bt),a.id)}}}class Tt{usedTurn(){return!1}isFinished(){return!0}execute(e,t){const n=t.getOne(Jt);if(void 0!==n){switch(n.reticleRotation){case 0:n.reticleRotation=90;break;case 90:n.reticleRotation=180;break;case 180:n.reticleRotation=270;break;case 270:n.reticleRotation=0}n.update()}}}var Et;function St(e,t,n,r){const i=rt(n,r.x,r.y);if(r.x>=t[0].length||r.y>=t.length||!1===t[r.y][r.x].visible)return null;const o=i.filter(e=>{const t=e.getOne(Ft),n=e.getOne(ln);return void 0!==t||void 0!==n}).sort((e,t)=>{const n=e.getOne(qt),r=t.getOne(qt);return void 0!==n&&void 0===r?-1:void 0===n&&void 0===r?0:void 0===n&&void 0!==r||void 0!==n&&void 0!==r?1:-1})[0];return null!=o?o:null}function kt(e){if(e.state!==Et.Target)throw new Error("Cannot get reticle outside of targeting state");const t=[],n=ae.getMousePosition();if(null===n)return t;if(null!==e.spellForTarget){const r=Le[e.spellForTarget.id];if(void 0!==r.areaOfEffect)for(let i=0;i<r.areaOfEffect.width;i++)for(let o=0;o<r.areaOfEffect.height;o++)switch(e.reticleRotation){case 0:t.push({x:n.x+i,y:n.y+o});break;case 90:t.push({x:n.x+o,y:n.y+i});break;case 180:t.push({x:n.x+i,y:n.y-o});break;case 270:t.push({x:n.x-o,y:n.y+i})}else t.push({x:n.x,y:n.y})}else t.push({x:n.x,y:n.y});return t}!function(e){e[e.Combat=0]="Combat",e[e.Target=1]="Target"}(Et||(Et={}));const At={[W.Physical]:U.normal,[W.Fire]:U.normal,[W.Electric]:U.normal,[W.Water]:U.normal,[W.Nature]:U.normal,[W.Ice]:U.normal},Ot={[W.Physical]:U.normal,[W.Fire]:U.strong,[W.Electric]:U.weak,[W.Water]:U.strong,[W.Nature]:U.normal,[W.Ice]:U.weak};class Pt extends a.Component{}Pt.typeName="PositionComponent",Pt.properties={x:0,y:0};class It extends a.Component{}It.typeName="TypeComponent",It.properties={entityType:"player"};class Mt extends a.Component{}Mt.typeName="DisplayNameComponent",Mt.properties={name:"player"};class Gt extends a.Component{}Gt.typeName="GraphicsComponent",Gt.properties={char:"",bgColor:null,fgColor:null};class Lt extends a.Component{}Lt.typeName="ChestGraphicsComponent",Lt.properties={char:"*",bgColor:"white",fgColor:"brown",emptyColor:"purple"};class Dt extends a.Component{}Dt.typeName="LightingComponent",Dt.properties={color:"white",range:10,lightingType:q.OnePass};class jt extends a.Component{}jt.typeName="InventoryComponent",jt.properties={inventory:new Map};class Ft extends a.Component{}Ft.typeName="HitPointsComponent",Ft.properties={hp:100,maxHp:100,onDeath:B.Default};class Nt extends a.Component{}Nt.typeName="HitPointsEffectComponent",Nt.properties={name:"",stat:"hp",modifierType:"add",turnsLeft:0,value:0};class Rt extends a.Component{}Rt.typeName="SpeedComponent",Rt.properties={speed:10,maxTilesPerMove:7};class Ht extends a.Component{}Ht.typeName="SpeedEffectComponent",Ht.properties={name:"",stat:"speed",modifierType:"add",turnsLeft:0,value:0};class $t extends a.Component{}$t.typeName="StatsComponent",$t.properties={strength:5,defense:1,criticalChance:.05,criticalDamageMultiplier:1.5,ailmentSusceptibility:.1};class zt extends a.Component{}zt.typeName="StatsEffectComponent",zt.properties={name:"",stat:"strength",modifierType:"add",turnsLeft:0,value:0};class Wt extends a.Component{}Wt.typeName="LevelComponent",Wt.properties={level:1,experience:0,experienceGiven:0};class Ut extends a.Component{}W.Physical,W.Fire,W.Electric,W.Water,W.Ice,W.Nature,Ut.typeName="DamageAffinityComponent",Ut.properties={[W.Physical]:U.normal,[W.Fire]:U.normal,[W.Electric]:U.normal,[W.Water]:U.normal,[W.Nature]:U.normal,[W.Ice]:U.normal};class Bt extends a.Component{}Bt.typeName="SpellsComponent",Bt.properties={knownSpells:null};class qt extends a.Component{}qt.typeName="PlannerAIComponent",qt.properties={target:a.EntityRef,sightRange:7,planner:null,previousWorldState:{},currentAction:null,currentOrder:"attack",goals:null,actions:null,lowHealthThreshold:.25,desiredDistanceToTarget:1,knowsTargetPosition:!1,hasTargetInSight:!1};class Vt extends a.Component{}Vt.typeName="LoseTargetAIComponent",Vt.properties={turnsWithTargetOutOfSight:0,loseTrackAfterNTurns:10};class Kt extends a.Component{}Kt.typeName="FearAIComponent",Kt.properties={fear:0,fearThreshold:10,runAwayTarget:null,isCowering:!1};class Xt extends a.Component{}Xt.typeName="FallbackAIComponent",Xt.properties={isAtFallbackPosition:!1,fallbackPosition:a.EntityRef};class Yt extends a.Component{}Yt.typeName="PatrolAIComponent",Yt.properties={patrolTarget:a.EntityRef};class Qt extends a.Component{}Qt.typeName="PatrolPathComponent",Qt.properties={next:a.EntityRef};class Zt extends a.Component{}Zt.typeName="ConfusedAIComponent",Zt.properties={turnsLeft:0};class Jt extends a.Component{}Jt.typeName="InputHandlingComponent",Jt.properties={state:Et.Combat,reticleRotation:0,keyCommands:[],itemForTarget:null,spellForTarget:null};class en extends a.Component{}en.typeName="FreezableComponent",en.properties={frozen:!1,turnsLeft:0};class tn extends a.Component{}tn.typeName="FlammableComponent",tn.properties={onFire:!1,fireDamage:0,turnsLeft:1};class nn extends a.Component{}nn.typeName="WetableComponent",nn.properties={wet:!1,turnsLeft:0};class rn extends a.Component{}rn.typeName="SilenceableComponent",rn.properties={silenced:!1,turnsLeft:0};class on extends a.Component{}on.typeName="TriggerTypeComponent",on.properties={triggerType:null};class an extends a.Component{}an.typeName="FireTriggerComponent",an.properties={effectTurns:0,effectDamage:0,damage:0};class sn extends a.Component{}sn.typeName="EventTriggerComponent",sn.properties={event:""};class ln extends a.Component{}ln.typeName="InteractableTypeComponent",ln.properties={interactableType:Q.Door};class un extends a.Component{}un.typeName="LoadLevelComponent",un.properties={levelName:""};class cn extends a.Component{}cn.typeName="RemoveAfterNTurnsComponent",cn.properties={turnsLeft:0};const hn={door:{staticallyKnownComponents:{tags:["blocks","blocksSight"],c:{DisplayNameComponent:{name:"Door"},TypeComponent:{entityType:"door"},GraphicsComponent:{char:"ᢂ",fgColor:"white",bgColor:"brown"},InteractableTypeComponent:{interactableType:Q.Door}}}},load_door:{staticallyKnownComponents:{tags:["blocks","blocksSight","drawAfterSeen"],c:{DisplayNameComponent:{name:"Door to new area"},TypeComponent:{entityType:"load_door"},GraphicsComponent:{char:"ᢂ",fgColor:"white",bgColor:"black"},InteractableTypeComponent:{interactableType:Q.LoadLevel}}}},stairs:{staticallyKnownComponents:{tags:["blocks","drawAfterSeen"],c:{DisplayNameComponent:{name:"Stairs"},TypeComponent:{entityType:"stairs"},GraphicsComponent:{char:"ᝐ",fgColor:"white",bgColor:"black"},InteractableTypeComponent:{interactableType:Q.LoadLevel}}}},chest:{addInventory:!0,staticallyKnownComponents:{tags:["blocks","drawAfterSeen"],c:{DisplayNameComponent:{name:"Chest"},TypeComponent:{entityType:"chest"},ChestGraphicsComponent:{char:"*",fgColor:"white",bgColor:"brown",emptyColor:"purple"},InteractableTypeComponent:{interactableType:Q.GiveItems},FlammableComponent:{onFire:!1,fireDamage:0,turnsLeft:0}}}},crate:{addInventory:!0,staticallyKnownComponents:{tags:["blocks"],c:{TypeComponent:{entityType:"crate"},DisplayNameComponent:{name:"Wooden Crate"},GraphicsComponent:{char:"☒",fgColor:"white",bgColor:"brown"},HitPointsComponent:{hp:5,maxHp:5,onDeath:B.RemoveFromWorld},DamageAffinityComponent:{[W.Physical]:U.normal,[W.Fire]:U.weak,[W.Electric]:U.normal,[W.Water]:U.strong,[W.Nature]:U.normal,[W.Ice]:U.strong},FlammableComponent:{onFire:!1,fireDamage:0,turnsLeft:0}}}},barrel:{addInventory:!0,staticallyKnownComponents:{tags:["blocks"],c:{TypeComponent:{entityType:"barrel"},DisplayNameComponent:{name:"Wooden Barrel"},GraphicsComponent:{char:"⌭",fgColor:"white",bgColor:"brown"},HitPointsComponent:{hp:5,maxHp:5,onDeath:B.RemoveFromWorld},DamageAffinityComponent:{[W.Physical]:U.normal,[W.Fire]:U.weak,[W.Electric]:U.normal,[W.Water]:U.strong,[W.Nature]:U.normal,[W.Ice]:U.strong},FlammableComponent:{onFire:!1,fireDamage:0,turnsLeft:0}}}},dead_body:{staticallyKnownComponents:{c:{TypeComponent:{entityType:"dead_body"},DisplayNameComponent:{name:"Dead Body"},GraphicsComponent:{char:"%",fgColor:"black",bgColor:"red"}}}},lantern:{staticallyKnownComponents:{tags:["blocks"],c:{TypeComponent:{entityType:"lantern"},DisplayNameComponent:{name:"Small Lantern"},GraphicsComponent:{char:"ᛡ",fgColor:"black",bgColor:"yellow"},LightingComponent:{color:"yellow",range:4,lightingType:q.TwoPass}}}},campfire:{staticallyKnownComponents:{c:{TypeComponent:{entityType:"campfire"},DisplayNameComponent:{name:"Small Campfire"},GraphicsComponent:{char:"ж",fgColor:"black",bgColor:"orange"},LightingComponent:{color:"orange",range:6,lightingType:q.TwoPass},TriggerTypeComponent:{triggerType:Z.Fire},FireTriggerComponent:{effectTurns:3,effectDamage:3,damage:10}}}},fire_effect:{staticallyKnownComponents:{c:{TypeComponent:{entityType:"fire_effect"},DisplayNameComponent:{name:"Fire"},GraphicsComponent:{char:"ж",fgColor:"black",bgColor:"orange"},LightingComponent:{color:"orange",range:4,lightingType:q.TwoPass},RemoveAfterNTurnsComponent:{turnsLeft:5},TriggerTypeComponent:{triggerType:Z.Fire},FireTriggerComponent:{effectTurns:5,effectDamage:5,damage:15}}}},ice_wall:{staticallyKnownComponents:{tags:["blocks","blocksSight"],c:{TypeComponent:{entityType:"ice_wall"},DisplayNameComponent:{name:"Ice Wall"},GraphicsComponent:{char:"⁂",fgColor:"black",bgColor:"lightblue"},HitPointsComponent:{hp:100,maxHp:100,onDeath:B.RemoveFromWorld},DamageAffinityComponent:{[W.Physical]:U.normal,[W.Fire]:U.weak,[W.Electric]:U.normal,[W.Water]:U.strong,[W.Nature]:U.strong,[W.Ice]:U.nullified}}}},dropped_item:{addInventory:!0,staticallyKnownComponents:{c:{TypeComponent:{entityType:"dropped_item"},DisplayNameComponent:{name:"Dropped Item"},GraphicsComponent:{char:"!",fgColor:"white",bgColor:"brown"},InteractableTypeComponent:{interactableType:Q.GiveItems}}}},magic_shrine:{staticallyKnownComponents:{tags:["blocks","blocksSight"],c:{TypeComponent:{entityType:"magic_shrine"},DisplayNameComponent:{name:"Magicka Shrine"},GraphicsComponent:{char:"۞",fgColor:"black",bgColor:"gold"},InteractableTypeComponent:{interactableType:Q.GiveSpells}}}},event_trigger:{staticallyKnownComponents:{c:{TypeComponent:{entityType:"event_trigger"},TriggerTypeComponent:{triggerType:Z.Event}}}},shallow_water:{staticallyKnownComponents:{c:{TypeComponent:{entityType:"shallow_water"},DisplayNameComponent:{name:"Water"},GraphicsComponent:{char:"~",fgColor:"blue",bgColor:"lightblue"},TriggerTypeComponent:{triggerType:Z.ShallowWater},FreezableComponent:{frozen:!1,turnsLeft:0}}}},puddle:{staticallyKnownComponents:{c:{TypeComponent:{entityType:"puddle"},DisplayNameComponent:{name:"Puddle"},GraphicsComponent:{char:".",fgColor:"blue",bgColor:"lightblue"},TriggerTypeComponent:{triggerType:Z.ShallowWater},FreezableComponent:{frozen:!1,turnsLeft:0},RemoveAfterNTurnsComponent:{turnsLeft:25}}}},water:{staticallyKnownComponents:{c:{TypeComponent:{entityType:"water"},DisplayNameComponent:{name:"Deep Water"},GraphicsComponent:{char:"~",fgColor:"lightblue",bgColor:"blue"},TriggerTypeComponent:{triggerType:Z.DeepWater},FreezableComponent:{frozen:!1,turnsLeft:0}}}},mud:{staticallyKnownComponents:{c:{TypeComponent:{entityType:"mud"},DisplayNameComponent:{name:"Mud"},GraphicsComponent:{char:".",fgColor:"tan",bgColor:"brown"},TriggerTypeComponent:{triggerType:Z.Mud},FreezableComponent:{frozen:!1,turnsLeft:0}}}},tall_grass:{staticallyKnownComponents:{c:{TypeComponent:{entityType:"tall_grass"},DisplayNameComponent:{name:"Tall Grass"},GraphicsComponent:{char:"ᗐ",fgColor:"green",bgColor:null},FlammableComponent:{onFire:!1,fireDamage:0,turnsLeft:0},WetableComponent:{wet:!1,turnsLeft:0},HitPointsComponent:{hp:10,maxHp:10,onDeath:B.RemoveFromWorld}}}},player:{addInventory:!0,addInput:!0,spells:[["fireball",10],["lesser_heal",5]],staticallyKnownComponents:{id:"player",tags:["blocks","input","sentient"],c:{TypeComponent:{entityType:"player"},DisplayNameComponent:{name:"The Player"},GraphicsComponent:{char:"@",fgColor:"blue",bgColor:null},LightingComponent:{color:"white",range:7,lightingType:q.Player},HitPointsComponent:{hp:100,maxHp:100,onDeath:B.Default},SpeedComponent:{speed:10,maxTilesPerMove:7},StatsComponent:{strength:5,defense:1,criticalChance:.05,criticalDamageMultiplier:1.5,ailmentSusceptibility:.1},LevelComponent:{level:1,experience:0,experienceGiven:0},DamageAffinityComponent:At,FlammableComponent:{onFire:!1,fireDamage:0,turnsLeft:0},FreezableComponent:{frozen:!1,turnsLeft:0},WetableComponent:{wet:!1,turnsLeft:0},SilenceableComponent:{silenced:!1,turnsLeft:0}}}},goblin:{addInventory:!0,addPlannerAI:!0,sightRange:7,lowHealthThreshold:.5,desiredDistanceToTarget:1,actions:["wander","chase","goToEnemy","meleeAttack"],inventoryPool:[{itemID:"health_potion_weak",probability:.25}],staticallyKnownComponents:{tags:["blocks","sentient"],c:{TypeComponent:{entityType:"goblin"},DisplayNameComponent:{name:"Goblin"},GraphicsComponent:{char:"G",fgColor:"green",bgColor:null},LoseTargetAIComponent:{turnsWithTargetOutOfSight:0,loseTrackAfterNTurns:6},SpeedComponent:{speed:10,maxTilesPerMove:5},HitPointsComponent:{hp:30,maxHp:30,onDeath:B.Default},StatsComponent:{strength:3,defense:1,criticalChance:.05,criticalDamageMultiplier:1.5,ailmentSusceptibility:.1},LevelComponent:{level:3,experience:0,experienceGiven:50},DamageAffinityComponent:At,FlammableComponent:{onFire:!1,fireDamage:0,turnsLeft:0},FreezableComponent:{frozen:!1,turnsLeft:0},WetableComponent:{wet:!1,turnsLeft:0}}}},goblin_brute:{addInventory:!0,addPlannerAI:!0,sightRange:10,desiredDistanceToTarget:1,actions:["guard","chase","useHealingItem","goToEnemy","goToSafePosition","meleeAttack"],inventoryPool:[{itemID:"health_potion_weak",probability:.25},{itemID:"health_potion",probability:.1}],staticallyKnownComponents:{tags:["blocks","sentient"],c:{TypeComponent:{entityType:"goblin_brute"},DisplayNameComponent:{name:"Goblin Brute"},GraphicsComponent:{char:"G",fgColor:"green",bgColor:"red"},LoseTargetAIComponent:{turnsWithTargetOutOfSight:0,loseTrackAfterNTurns:6},SpeedComponent:{speed:10,maxTilesPerMove:5},HitPointsComponent:{hp:100,maxHp:100,onDeath:B.Default},StatsComponent:{strength:7,defense:4,criticalChance:.05,criticalDamageMultiplier:1.5,ailmentSusceptibility:.1},LevelComponent:{level:10,experience:0,experienceGiven:500},DamageAffinityComponent:At,FlammableComponent:{onFire:!1,fireDamage:0,turnsLeft:0},FreezableComponent:{frozen:!1,turnsLeft:0},WetableComponent:{wet:!1,turnsLeft:0}}}},rat:{addPlannerAI:!0,sightRange:5,lowHealthThreshold:.5,desiredDistanceToTarget:1,actions:["wander","chase","goToEnemy","meleeAttack","runAway"],staticallyKnownComponents:{tags:["blocks","sentient"],c:{TypeComponent:{entityType:"rat"},DisplayNameComponent:{name:"Rat"},GraphicsComponent:{char:"r",fgColor:"brown",bgColor:null},LoseTargetAIComponent:{turnsWithTargetOutOfSight:0,loseTrackAfterNTurns:6},FearAIComponent:{fear:0,isAfraidThreshold:10,isCowering:!1},SpeedComponent:{speed:10,maxTilesPerMove:4},HitPointsComponent:{hp:10,maxHp:10,onDeath:B.Default},StatsComponent:{strength:2,defense:1,criticalChance:.05,criticalDamageMultiplier:1.5,ailmentSusceptibility:.1},LevelComponent:{level:1,experience:0,experienceGiven:10},DamageAffinityComponent:At,FlammableComponent:{onFire:!1,fireDamage:0,turnsLeft:0},FreezableComponent:{frozen:!1,turnsLeft:0},WetableComponent:{wet:!1,turnsLeft:0}}}},water_sprite:{addPlannerAI:!0,sightRange:9,lowHealthThreshold:.5,desiredDistanceToTarget:1,actions:["wander","chase","goToEnemy","meleeAttack"],staticallyKnownComponents:{tags:["blocks","sentient"],c:{TypeComponent:{entityType:"water_sprite"},DisplayNameComponent:{name:"Water Sprite"},GraphicsComponent:{char:"s",fgColor:"white",bgColor:"blue"},LoseTargetAIComponent:{turnsWithTargetOutOfSight:0,loseTrackAfterNTurns:6},FearAIComponent:{fear:0,isAfraidThreshold:10,isCowering:!1},SpeedComponent:{speed:10,maxTilesPerMove:7},HitPointsComponent:{hp:10,maxHp:10,onDeath:B.Default},StatsComponent:{strength:2,defense:1,criticalChance:.05,criticalDamageMultiplier:1.5,ailmentSusceptibility:.1},LevelComponent:{level:1,experience:0,experienceGiven:10},DamageAffinityComponent:Ot,FreezableComponent:{frozen:!1,turnsLeft:0}}}},bandit:{addInventory:!0,addPlannerAI:!0,sightRange:10,lowHealthThreshold:.5,desiredDistanceToTarget:1,actions:["guard","chase","useHealingItem","goToEnemy","goToSafePosition","runAway","meleeAttack"],inventoryPool:[{itemID:"health_potion_weak",probability:.25}],staticallyKnownComponents:{tags:["blocks","sentient"],c:{TypeComponent:{entityType:"bandit"},DisplayNameComponent:{name:"Bandit"},GraphicsComponent:{char:"b",fgColor:"brown",bgColor:null},LoseTargetAIComponent:{turnsWithTargetOutOfSight:0,loseTrackAfterNTurns:6},FearAIComponent:{fear:0,isAfraidThreshold:30,isCowering:!1},SpeedComponent:{speed:10,maxTilesPerMove:5},HitPointsComponent:{hp:30,maxHp:30,onDeath:B.Default},StatsComponent:{strength:2,defense:1,criticalChance:.05,criticalDamageMultiplier:1.5,ailmentSusceptibility:.1},LevelComponent:{level:1,experience:0,experienceGiven:10},DamageAffinityComponent:At,FlammableComponent:{onFire:!1,fireDamage:0,turnsLeft:0},FreezableComponent:{frozen:!1,turnsLeft:0},WetableComponent:{wet:!1,turnsLeft:0}}}},bandit_mage:{addInventory:!0,addPlannerAI:!0,sightRange:8,lowHealthThreshold:.5,desiredDistanceToTarget:5,spells:[["fireball",3],["lesser_heal",1]],actions:["wander","chase","standby","reposition","useHealingItem","useHealingSpell","goToEnemy","goToSafePosition","runAway","meleeAttack"],inventoryPool:[{itemID:"health_potion_weak",probability:.25}],staticallyKnownComponents:{tags:["blocks","sentient"],c:{TypeComponent:{entityType:"bandit_mage"},DisplayNameComponent:{name:"Bandit Mage"},GraphicsComponent:{char:"b",fgColor:"blue",bgColor:null},LoseTargetAIComponent:{turnsWithTargetOutOfSight:0,loseTrackAfterNTurns:6},FearAIComponent:{fear:0,isAfraidThreshold:30,isCowering:!1},SpeedComponent:{speed:10,maxTilesPerMove:5},HitPointsComponent:{hp:30,maxHp:30,onDeath:B.Default},StatsComponent:{strength:2,defense:1,criticalChance:.05,criticalDamageMultiplier:1.5,ailmentSusceptibility:.1},LevelComponent:{level:5,experience:0,experienceGiven:10},DamageAffinityComponent:At,FlammableComponent:{onFire:!1,fireDamage:0,turnsLeft:0},FreezableComponent:{frozen:!1,turnsLeft:0},WetableComponent:{wet:!1,turnsLeft:0},SilenceableComponent:{silenced:!1,turnsLeft:0}}}},bandit_white_mage:{addInventory:!0,addPlannerAI:!0,sightRange:8,lowHealthThreshold:.4,desiredDistanceToTarget:5,spells:[["heal_other",2]],actions:["wander","chase","standby","reposition","useHealingItem","useHealingSpell","healAlly","goToEnemy","goToSafePosition","runAway","meleeAttack"],staticallyKnownComponents:{tags:["blocks","sentient"],c:{TypeComponent:{entityType:"bandit_white_mage"},DisplayNameComponent:{name:"Bandit White Mage"},GraphicsComponent:{char:"b",fgColor:"white",bgColor:"blue"},LoseTargetAIComponent:{turnsWithTargetOutOfSight:0,loseTrackAfterNTurns:6},FearAIComponent:{fear:0,isAfraidThreshold:30,isCowering:!1},SpeedComponent:{speed:10,maxTilesPerMove:5},HitPointsComponent:{hp:30,maxHp:30,onDeath:B.Default},StatsComponent:{strength:2,defense:1,criticalChance:.05,criticalDamageMultiplier:1.5,ailmentSusceptibility:.1},LevelComponent:{level:5,experience:0,experienceGiven:10},DamageAffinityComponent:At,FlammableComponent:{onFire:!1,fireDamage:0,turnsLeft:0},FreezableComponent:{frozen:!1,turnsLeft:0},WetableComponent:{wet:!1,turnsLeft:0},SilenceableComponent:{silenced:!1,turnsLeft:0}}}}};for(const e in hn){const t=hn[e];if(void 0!==t.spells&&void 0!==t.actions)for(let e=0;e<t.spells.length;e++){const n=t.spells[e];t.actions.push("castSpell_"+n[0])}}function dn(e,t,n,r,i){var o,a,l;if(!(t in hn))throw new Error(t+" is not valid object id");let u=ee(1,2147483647);u&=u;const c=null!=i?i:`${t}-${u.toString(16)}`,h=hn[t],d=e.createEntity(Object(J.assignIn)({},{id:c},h.staticallyKnownComponents));if(null!==n&&null!==r&&!1===d.has(Pt)&&d.addComponent({type:"PositionComponent",x:n,y:r}),void 0!==h.spells&&!1===d.has(Bt)){const e=new Map;h.spells.forEach(t=>e.set(t[0],t[1])),d.addComponent({type:"SpellsComponent",knownSpells:e})}if(!0===(null==h?void 0:h.addInventory)&&!1===d.has(jt)){const e=new Map;if(void 0!==h.inventoryPool)for(let t=0;t<h.inventoryPool.length;t++)s.a.getUniform()<=h.inventoryPool[t].probability&&e.set(h.inventoryPool[t].itemID,1);d.addComponent({type:"InventoryComponent",inventory:e})}if(!0===(null==h?void 0:h.addInput)&&!1===d.has(Jt)){const e=[{key:"i",description:"Inventory",command:new wt},{key:"m",description:"Spell Menu",command:new bt},{key:"r",description:"Rotate Target Reticle",command:new Tt},{key:"x",description:"Do Nothing",command:new yt(!0)}];d.addComponent({type:"InputHandlingComponent",state:Et.Combat,reticleRotation:0,keyCommands:e,itemForTarget:null,spellForTarget:null})}if(!0===(null==h?void 0:h.addPlannerAI)&&void 0!==h.actions){const t=new Set(h.actions),{goals:n,planner:r}=Xe(t);d.addComponent({type:"PlannerAIComponent",sightRange:null!==(o=null==h?void 0:h.sightRange)&&void 0!==o?o:5,desiredDistanceToTarget:null!==(a=null==h?void 0:h.desiredDistanceToTarget)&&void 0!==a?a:1,planner:r,target:e.getEntity("player"),previousWorldState:{},currentAction:null,currentOrder:"attack",goals:n,actions:t,lowHealthThreshold:null!==(l=h.lowHealthThreshold)&&void 0!==l?l:.25,knowsTargetPosition:!1,hasTargetInSight:!1})}return d}class pn extends a.System{init(){this.mainQuery=this.createQuery().fromAll(Pt).persist()}update(){var e;if(null===i.Game)throw new Error("Global game object is null");const t=this.mainQuery.execute();i.Game.entityMap.clear();for(const n of t){const t=n.getOne(Pt),r=`${t.x},${t.y}`,o=null!==(e=i.Game.entityMap.get(r))&&void 0!==e?e:[];o.push(n),i.Game.entityMap.set(r,o)}}}class fn extends a.System{init(){this.query=this.createQuery().fromAll(cn).persist()}update(){const e=this.query.execute();for(const t of e){const e=t.getOne(cn);e.turnsLeft--,0===e.turnsLeft?t.destroy():e.update()}}}class mn extends a.System{init(){this.mainQuery=this.createQuery().fromAll(Ft).persist()}generateUpdateFearVisibilityCallback(e){const t=e.getOne(Wt);return function(e,n){if(void 0===t)return;const r=rt(i.Game.entityMap,e,n);for(const e of r){const n=e.getOne(Kt),r=e.getOne(Wt);void 0!==n&&void 0!==r&&(n.fear+=Math.max(t.level-r.level+5,1),n.update())}}}actorDeath(e){if(null===i.gameEventEmitter)throw new Error("Global gameEventEmitter object is null");const t=e.getOne(Mt);void 0!==t&&(ve(t.name+" has been killed"),t.name="Remains of a "+t.name,t.update()),e.removeTag("blocks"),e.removeTag("blocksSight");const n=e.getOne(Gt);void 0!==n&&(n.char="%",n.fgColor="black",n.bgColor="red",n.update());const r=e.getOne(Pt);if(void 0===r)throw new Error("Position data missing on dead body");new R.PreciseShadowcasting(Ke(r)).compute(r.x,r.y,10,this.generateUpdateFearVisibilityCallback(e));const o=[Ft,$t,Rt,qt,Vt,Kt,ln,tn,nn,on,an];for(let t=0;t<o.length;t++){const n=e.getOne(o[t]);void 0!==n&&e.removeComponent(n)}const a=e.getOne(jt),s=e.getOne(Pt);if(void 0!==a&&void 0!==s&&a.inventory.size>0){i.gameEventEmitter.emit("tutorial.pickUpItem");dn(this.world,"dropped_item",s.x,s.y).getOne(jt).inventory=a.inventory}e.removeComponent(e.getOne(jt))}removeDeath(e){if(null===i.gameEventEmitter)throw new Error("Global gameEventEmitter object is null");const t=e.getOne(jt),n=e.getOne(Pt);if(void 0!==t&&void 0!==n&&t.inventory.size>0){i.gameEventEmitter.emit("tutorial.pickUpItem");dn(this.world,"dropped_item",n.x,n.y).getOne(jt).inventory=t.inventory}const r=e.getOne(It);"crate"===(null==r?void 0:r.entityType)&&i.gameEventEmitter.emit("crate.break"),"barrel"===(null==r?void 0:r.entityType)&&i.gameEventEmitter.emit("barrel.break"),this.world.removeEntity(e)}update(){const e=this.mainQuery.execute();for(const t of e){const e=t.getOne(Ft);if(void 0===e)throw new Error("hp missing in death system "+t.id);if(e.hp<=0)switch(e.onDeath){case B.Default:this.actorDeath(t);break;case B.RemoveFromWorld:this.removeDeath(t);break;default:te(e.onDeath)}}}}class gn extends a.System{init(){this.subscribe("SpeedComponent")}update(){var e;if(null===i.Game)throw new Error("Game object is null");for(let t=0;t<this.changes.length;t++){const n=this.changes[t],r=this.world.getEntity(n.entity);switch(n.op){case"add":if(r===(null===(e=i.Game)||void 0===e?void 0:e.player))continue;i.Game.scheduler.add(n.entity,!0);break;case"destroy":i.Game.scheduler.remove(n.entity);break;case"change":case"addRef":case"deleteRef":break;default:throw new Error(`${n.entity}: Unknown change operation ${n.op}`)}}}}class yn extends a.System{init(){this.mainQuery=this.createQuery().fromAll(Wt).persist()}update(){const e=this.mainQuery.execute();for(const t of e){const e=t.getOne(Wt),n=50+150*e.level;if(e.experience>=n){e.level+=1,e.experience=0,e.update();const n=t.getOne(Ft),r=t.getOne($t),o=_n(t),a=wn(t);void 0!==n&&null!==o&&(n.hp=o.maxHp,n.update()),void 0!==r&&null!==a&&(r.strength++,r.defense++,r.update()),null!==i.Game&&t===i.Game.player&&ve(`You reached level ${e.level}!`)}}}}function vn(e,t){const n=Object(J.cloneDeep)(t);switch(e.modifierType){case"add":n[e.stat]+=e.value;break;case"multiply":n[e.stat]*=e.value;break;default:throw new Error("Bad StatisticEffect type "+e.modifierType)}return n}function _n(e){const t=e.getComponents(Nt),n=e.getOne(Ft);if(void 0===n)return null;if(0===t.size)return n;let r=Object(J.pick)(n,"hp","maxHp");return t.forEach(e=>{r=vn(e,r)}),r.maxHp<=0&&(r.maxHp=1),n.hp>r.maxHp&&(n.hp=r.maxHp,r.hp=r.maxHp),r}function wn(e){const t=e.getComponents(zt),n=e.getOne($t);if(void 0===n)return null;if(0===t.size)return n;let r=Object(J.pick)(n,"strength","defense","criticalChance","criticalDamageMultiplier","ailmentSusceptibility");return t.forEach(e=>{r=vn(e,r)}),r}function bn(e){const t=e.getComponents(Ht),n=e.getOne(Rt);if(void 0===n)return null;if(0===t.size)return n;let r=Object(J.pick)(n,"speed","maxTilesPerMove");return t.forEach(e=>{r=vn(e,r)}),r.maxTilesPerMove=Math.max(1,r.maxTilesPerMove),r.speed=Math.max(1,r.speed),r}function xn(e,t,n,r){const i=e.getOne(Mt),o=e.getOne(Ft);if(void 0===o)throw new Error("Cannot take damage without a HitPointsComponent");const a=wn(e),s=function(e){const t=e.getOne(Ut),n=e.getOne(nn);if(void 0===t)return null;if(void 0===n)return t;const r=Object(J.pick)(t,W.Physical,W.Fire,W.Electric,W.Water,W.Ice,W.Nature);return n.wet&&r[W.Electric]!==U.strong&&(r[W.Electric]=U.weak),r}(e);if(null!==a&&null!==s?(t*=s[r],t=Math.max(1,t-a.defense)):null===a&&null!==s?(t*=s[r],t=Math.max(1,t)):null!==a&&(t=Math.max(1,t-a.defense)),t>0){o.hp-=t,o.update();const n=e.getOne(qt);void 0!==n&&!1===n.knowsTargetPosition&&(n.knowsTargetPosition=!0,n.update())}return n&&void 0!==i?ve(`CRITICAL! ${i.name} takes ${t} of ${W[r]} damage.`,oe.Critical):void 0!==i&&ve(`${i.name} takes ${t} ${W[r]} damage.`),o.hp<=0}function Cn(e,t){const n=_n(e.entity);null!==n&&(e.hp+=t,e.hp>n.maxHp&&(e.hp=n.maxHp),e.update())}function Tn(e,t,n){if(null===i.Game)throw new Error("Global Game object is null");if(null===i.gameEventEmitter)throw new Error("Global gameEventEmitter object is null");if(!(t in Le))throw new Error(t+" is not a valid spell id");const r=e.getOne(Bt);return void 0!==r&&!0!==r.knownSpells.has(t)&&(e===i.Game.player&&(i.gameEventEmitter.emit("tutorial.spellMenu"),Le[t].type===X.WildDamage&&i.gameEventEmitter.emit("tutorial.wildSpells")),r.knownSpells.set(t,n),r.update(),!0)}function En(e){return[...e.knownSpells.entries()].map(([e,t])=>({id:e,count:t,displayName:Le[e].displayName,description:Le[e].description,type:Le[e].type,value:Le[e].value,damageType:Le[e].damageType,statusEffect:Le[e].statusEffect,areaOfEffect:Le[e].areaOfEffect}))}class Sn extends j{add(e,t){var n;const r=i.Game.ecs.getEntity(e);if(void 0===r)throw new Error(`Unknown entity ${e} in scheduler`);const o=bn(r),a=null!==(n=null==o?void 0:o.speed)&&void 0!==n?n:10;return this._queue.add(e,1/a),super.add(e,t)}next(){var e;if(null!==this._current&&-1!==this._repeat.indexOf(this._current)){const t=i.Game.ecs.getEntity(this._current);if(void 0===t)throw new Error(`Unknown entity ${this._current} in scheduler`);const n=bn(t),r=null!==(e=null==n?void 0:n.speed)&&void 0!==e?e:10;this._queue.add(this._current,1/r)}return super.next()}}var kn=n(3);const An={},On={forrest_001:"forrestTheme",durdwin_001:"caveTheme"},Pn={id:null,sound:null};function In(){An.uiClick.play()}function Mn(){An.uiRollover.play()}function Gn(){An.bookFlip.play()}function Ln(){An.bookFlip2.play()}function Dn(){An.handleLeather2.play()}function jn(){An.handleLeather.play()}function Fn(){An.ping.play()}function Nn(){An.doorOpening.play()}function Rn(){An.chestOpening.play()}function Hn(){An.boxBreaking.play()}function $n(e){const t=An[On[e]];Pn.sound!==t&&(null!==Pn.id&&null!==Pn.sound&&Pn.sound.fade(.8,0,3e3,Pn.id),Pn.sound=t,Pn.id=t.play(),Pn.sound.fade(0,.8,3e3,Pn.id))}function zn(){null!==Pn.id&&null!==Pn.sound&&Pn.sound.pause(Pn.id)}function Wn(){null!==Pn.id&&null!==Pn.sound&&Pn.sound.play(Pn.id)}class Un{constructor(){this.x=0,this.y=0,this.following=null}follow(e){this.following=e}update(e){if(null===this.following)return;const t=this.following.getOne(Pt);void 0!==t&&(this.x=Math.floor(t.x-29),this.y=Math.floor(t.y-16),this.x=Math.max(0,Math.min(this.x,e.length)),this.y=Math.max(0,Math.min(this.y,e[0].length)))}worldToScreen(e,t){return{x:e-this.x,y:t-this.y}}screenToWorld(e,t){return{x:e+this.x,y:t+this.y}}}const Bn={movement:!1,attack:!1,inventory:!1,pickUpItem:!1,spellMenu:!1,spellTargeting:!1,wildSpells:!1};function qn(){Bn.movement||(ve("Move by clicking where you want to go.",oe.Tutorial),Bn.movement=!0)}function Vn(){Bn.attack||(ve("Click on an enemy when next to it to attack",oe.Tutorial),Fn(),Bn.attack=!0)}function Kn(){Bn.inventory||(ve("Use i to open your inventory",oe.Tutorial),Fn(),Bn.inventory=!0)}function Xn(){Bn.spellMenu||(ve("Press m to open your spells",oe.Tutorial),Fn(),Bn.spellMenu=!0)}function Yn(){Bn.pickUpItem||(ve("Click on a dropped item to pick it up",oe.Tutorial),Fn(),Bn.pickUpItem=!0)}function Qn(){Bn.spellTargeting||(ve("Left click on an enemy to target it, click elsewhere to cancel",oe.Tutorial),Fn(),Bn.spellTargeting=!0)}function Zn(){Bn.wildSpells||(ve("Wild spells will randomly target an enemy within range. Use them carefully.",oe.Tutorial),Fn(),Bn.wildSpells=!0)}function Jn(e,t,n){let r=i.Game.map[t.y][t.x].lightingColor;const o=rt(e,t.x,t.y);if(o.length>0)for(let e=0;e<o.length;e++){const t=o[e];if(t.id===n)continue;const i=t.getOne(Gt);if(void 0!==i&&null!==i.bgColor){r=i.bgColor;break}}return r}class er extends a.System{init(){this.graphicsQuery=this.createQuery().fromAll(Gt,Pt).not("input").persist()}draw(e,t,n){if(i.Game.map[t.y][t.x].isVisibleAndLit()){const{x:r,y:o}=i.Game.gameCamera.worldToScreen(t.x,t.y),a=e.getOne(tn),s=e.getOne(nn);let l=n.bgColor;void 0!==a&&!0===a.onFire?l="red":void 0!==s&&!0===s.wet&&(l="blue"),i.Game.display.draw(r,o,n.char,n.fgColor,l)}}drawWithTransparency(e,t,n,r){if(i.Game.map[t.y][t.x].isVisibleAndLit()){const o=e.getOne(tn),a=e.getOne(nn);let s;s=void 0!==o&&!0===o.onFire?"red":void 0!==a&&!0===a.wet?"blue":Jn(i.Game.entityMap,t,r);const{x:l,y:u}=i.Game.gameCamera.worldToScreen(t.x,t.y);i.Game.display.draw(l,u,n.char,n.fgColor,s)}}drawAfterSeen(e,t){if(i.Game.map[e.y][e.x].explored){const{x:n,y:r}=i.Game.gameCamera.worldToScreen(e.x,e.y);i.Game.display.draw(n,r,t.char,t.fgColor,t.bgColor)}}update(){if(null===i.Game)throw new Error("Global game is null");const e=this.graphicsQuery.execute();for(const t of e){const e=t.getOne(Gt),n=t.getOne(Pt);if(void 0===e||void 0===n)throw new Error("missing data for draw system for "+t.id);!0===t.tags.has("drawAfterSeen")?this.drawAfterSeen(n,e):null===e.bgColor?this.drawWithTransparency(t,n,e,t.id):this.draw(t,n,e)}}}class tr extends a.System{init(){this.chestGraphics=this.createQuery().fromAll(Lt,Pt,jt).persist()}update(){if(null===i.Game)throw new Error("Global game is null");const e=this.chestGraphics.execute();for(const t of e){const e=t.getOne(Pt);if(i.Game.map[e.y][e.x].explored){const n=t.getOne(Lt),r=De(t.getOne(jt)).length>0?n.bgColor:n.emptyColor,{x:o,y:a}=i.Game.gameCamera.worldToScreen(e.x,e.y);i.Game.display.draw(o,a,n.char,n.fgColor,r)}}}}class nr extends a.System{init(){this.query=this.createQuery().fromAll(Pt,jt,"input").persist()}update(){if(null===i.Game)throw new Error("Global game is null");const e=this.query.execute();for(const t of e){const e=t.getOne(Pt),n=t.getOne(Jt),r=bn(t),o=t.getOne(Gt);if(null===r||void 0===n||void 0===o)throw new Error("Player missing speed or input data");if(i.Game.map[e.y][e.x].isVisibleAndLit()){const a=t.getOne(tn),s=t.getOne(nn),{x:l,y:u}=i.Game.gameCamera.worldToScreen(e.x,e.y);let c;if(c=void 0!==a&&!0===a.onFire?"red":void 0!==s&&!0===s.wet?"lightblue":Jn(i.Game.entityMap,e,t.id),i.Game.display.draw(l,u,o.char,o.fgColor,c),n.state===Et.Combat){const t=ae.getMousePosition();if(null===t)return;const n=i.Game.map[t.y][t.x];if(void 0!==n&&!n.explored)return;if(at(e,t)<40){const n=gt(e,t,r.maxTilesPerMove,i.Game.map,i.Game.entityMap);if(null===n)return;for(let e=0;e<n.length;e++){const t=n[e],{x:r,y:o}=i.Game.gameCamera.worldToScreen(t[0],t[1]);i.Game.display.draw(r,o,"","yellow","yellow")}}}else if(n.state===Et.Target){const e=kt(n);for(let t=0;t<e.length;t++){if(e[t].x>=i.Game.map[0].length||e[t].y>=i.Game.map.length||!1===i.Game.map[e[t].y][e[t].x].visible)return;const{x:n,y:r}=i.Game.gameCamera.worldToScreen(e[t].x,e[t].y);i.Game.display.draw(n,r,"X","black","yellow")}}}}}}function rr(e){return function(t,n){return t<0||n<0||n>=e.length||t>=e[n].length||e[n][t].blocksSight?0:e[n][t].reflectivity}}class ir extends a.System{init(){this.mainQuery=this.createQuery().fromAll(Dt,Pt).persist()}computePlayerLighting(e,t){new R.PreciseShadowcasting(Ke(e)).compute(e.x,e.y,60,(function(e,n){e<0||n<0||n>=i.Game.map.length||e>=i.Game.map[n].length||(i.Game.map[n][e].explored=!0,i.Game.map[n][e].visible=!0,i.Game.map[n][e].lightingColor=t.color)}))}computePlayerIndoorLighting(e,t){new R.PreciseShadowcasting(Ke(e)).compute(e.x,e.y,50,(function(e,t){e<0||t<0||t>=i.Game.map.length||e>=i.Game.map[t].length||(i.Game.map[t][e].visible=!0)}));const n=new R.PreciseShadowcasting(Ke(e)),r=new z(rr(i.Game.map),{range:t.range,passes:2});r.setFOV(n),r.setLight(e.x,e.y,t.color),r.compute((function(e,t,n){e<0||t<0||t>=i.Game.map.length||e>=i.Game.map[t].length||(i.Game.map[t][e].lightingColor=Object(f.toRGB)(Object(f.add)(Object(f.fromString)(i.Game.map[t][e].lightingColor),n)),i.Game.map[t][e].explored=!0)}))}computeReflectivityLighting(e,t){const n=new R.PreciseShadowcasting(Ke(e)),r=new z(rr(i.Game.map),{range:t.range,passes:2});r.setFOV(n),r.setLight(e.x,e.y,t.color),r.compute((function(e,t,n){e<0||t<0||t>=i.Game.map.length||e>=i.Game.map[t].length||(i.Game.map[t][e].lightingColor=Object(f.toRGB)(Object(f.add)(Object(f.fromString)(i.Game.map[t][e].lightingColor),n)))})),i.Game.map[e.y][e.x].lightingColor=t.color}update(){if(null===i.Game)throw new Error("Missing properties on global Game object required for lighting");if(i.Game.isLightingEnabled){!function(e){for(let t=0;t<e.length;t++)for(let n=0;n<e[t].length;n++)e[t][n].visible=!1,e[t][n].lightingColor="rgb(50, 50, 50)"}(i.Game.map);const e=this.mainQuery.execute();for(const t of e){const e=t.getOne(Pt),n=t.getOne(Dt);switch(n.lightingType){case q.Player:this.computePlayerLighting(e,n);break;case q.OnePass:throw new Error("not implemented");case q.TwoPass:this.computeReflectivityLighting(e,n);break;default:te(n.lightingType)}}}else ut(i.Game.map,!0,!0)}}class or extends a.System{init(){this.mainQuery=this.createQuery().fromAll(Ft,tn).persist()}update(){const e=this.mainQuery.execute();for(const t of e){const e=t.getOne(tn);if(!0===e.onFire){if(xn(t,e.fireDamage,!1,W.Fire),e.turnsLeft--,e.turnsLeft<=0)e.onFire=!1,e.fireDamage=0,!1===t.tags.has("blocks")&&t.has(on)&&(t.removeComponent(t.getOne(on)),t.removeComponent(t.getOne(an)));else{const e=t.getOne(Pt);if(void 0!==e){const t=new Set([`${e.x-1},${e.y}`,`${e.x},${e.y-1}`,`${e.x-1},${e.y-1}`,`${e.x+1},${e.y}`,`${e.x},${e.y+1}`,`${e.x+1},${e.y+1}`,`${e.x+1},${e.y-1}`,`${e.x-1},${e.y+1}`]),n=this.world.entities.values();for(const e of n){const n=e.getOne(Pt);void 0!==n&&(t.has(`${n.x},${n.y}`)&&Math.random()>=.8&&Ce(e))}}}if(e.update(),null===i.Game)continue;if(t===i.Game.player)ve(`You took ${e.fireDamage} damage from being on fire`);else{const n=t.getOne(Mt);if(void 0===n)continue;ve(`${n.name} took ${e.fireDamage} damage from being on fire`)}}}}}class ar extends a.System{init(){this.mainQuery=this.createQuery().fromAll(nn).persist()}update(){const e=this.mainQuery.execute();for(const t of e){const e=t.getOne(nn);e.turnsLeft>0?(e.turnsLeft--,e.update()):e.turnsLeft<=0&&(e.wet=!1,e.update())}}}class sr extends a.System{init(){this.mainQuery=this.createQuery().fromAll(rn).persist()}update(){const e=this.mainQuery.execute();for(const t of e){const e=t.getOne(rn);e.turnsLeft>0?(e.turnsLeft--,e.update()):e.turnsLeft<=0&&(e.silenced=!1,e.update())}}}class lr extends a.System{init(){this.hitPointsEffectQuery=this.createQuery().fromAll(Nt).persist()}update(){const e=this.hitPointsEffectQuery.execute();for(const t of e){const e=t.getComponents(Nt);for(const n of e)n.turnsLeft-=1,0===n.turnsLeft?(t.removeComponent(n),n.destroy()):n.update()}}}class ur extends a.System{init(){this.statsEffectQuery=this.createQuery().fromAll(zt).persist()}update(){const e=this.statsEffectQuery.execute();for(const t of e){const e=t.getComponents(zt);for(const n of e)n.turnsLeft-=1,0===n.turnsLeft?(t.removeComponent(n),n.destroy()):n.update()}}}class cr extends a.System{init(){this.speedEffectQuery=this.createQuery().fromAll(Ht).persist()}update(){const e=this.speedEffectQuery.execute();for(const t of e){const e=t.getComponents(Ht);for(const n of e)n.turnsLeft--,0===n.turnsLeft?(t.removeComponent(n),n.destroy()):n.update()}}}i.gameEventEmitter=new o.EventEmitter;function hr(){null!==i.Game&&null!==i.Game.display&&null!==i.window&&i.Game.display.setOptions({fontSize:Math.max(Math.floor(i.window.innerHeight/40),12)})}i.window=window,i.document=document,i.Game=new class{constructor(){if(null===i.window)throw new Error("Global window cannot be null");if(null===i.document)throw new Error("Global document cannot be null");if(this.state=V.OpeningCinematic,this.canvas=null,this.display=null,this.currentActor=null,this.currentCommand=null,this.scheduler=new Sn,this.map=[],this.entityMap=new Map,this.totalTurns=1,this.processAI=!0,this.processCommands=!0,this.isLightingEnabled=!0,this.debugPathfinding=!1,this.display=new G({width:58,height:38,fontSize:Math.max(Math.floor(i.window.innerHeight/40),12),forceSquareRatio:!0}),this.canvas=this.display.getContainer(),null===this.canvas)throw new Error("this.canvas cannot be null");const e=i.document.getElementById("canvas");if(null===e)throw new Error("this.canvas cannot be null");e.prepend(this.canvas);const t=i.document.getElementById("loading");if(null===t||null===t.parentNode)throw new Error("this.canvas cannot be null");t.parentNode.removeChild(t),i.window.addEventListener("resize",Object(J.debounce)(hr,300),{once:!1}),this.keyBindingMenu=new be,this.inventoryMenu=new _e,this.spellSelectionMenu=new we,this.gameCamera=new Un,this.ecs=new a.World({trackChanges:!0,entityPool:100,cleanupPools:!0})}reset(){if(null===i.document)throw new Error("Global document cannot be null");this.ecs.entities.forEach(e=>{this.ecs.removeEntity(e)}),this.currentActor=null,this.player=dn(this.ecs,"player",1,1),this.map=[],this.totalTurns=1,this.loadLevel("forrest_001"),this.scheduler.add(this.player.id,!0),this.gameCamera.follow(this.player);const e=i.document.getElementById("log");null!==e&&(e.innerHTML="")}async startGameplay(){if(null===i.gameEventEmitter)throw new Error("Global gameEventEmitter cannot be null");null!==this.display&&this.display.drawText(28,22,"%c{white}Loading Sounds");try{await async function(){await Promise.all([new Promise((function(e,t){An.uiClick=new kn.Howl({src:["bin/sounds/click.mp3"],onload:e,onloaderror:t})})),new Promise((function(e,t){An.uiRollover=new kn.Howl({src:["bin/sounds/rollover.mp3"],onload:e,onloaderror:t})})),new Promise((function(e,t){An.bookFlip=new kn.Howl({src:["bin/sounds/book_flip.mp3"],onload:e,onloaderror:t})})),new Promise((function(e,t){An.bookFlip2=new kn.Howl({src:["bin/sounds/book_flip2.mp3"],onload:e,onloaderror:t})})),new Promise((function(e,t){An.handleLeather=new kn.Howl({src:["bin/sounds/handle_small_leather1.mp3"],onload:e,onloaderror:t})})),new Promise((function(e,t){An.handleLeather2=new kn.Howl({src:["bin/sounds/handle_small_leather2.mp3"],onload:e,onloaderror:t})})),new Promise((function(e,t){An.ping=new kn.Howl({src:["bin/sounds/ping.mp3"],onload:e,onloaderror:t,volume:.2})})),new Promise((function(e,t){An.doorOpening=new kn.Howl({src:["bin/sounds/door_open.mp3"],onload:e,onloaderror:t,volume:.5})})),new Promise((function(e,t){An.chestOpening=new kn.Howl({src:["bin/sounds/chest_open.mp3"],onload:e,onloaderror:t,volume:.5})})),new Promise((function(e,t){An.boxBreaking=new kn.Howl({src:["bin/sounds/box_break.mp3"],onload:e,onloaderror:t,volume:.1})})),new Promise((function(e,t){An.forrestTheme=new kn.Howl({src:["bin/sounds/water_prelude.mp3"],onload:e,onloaderror:t,volume:0,loop:!0})}))])}()}catch(e){return void(null!==this.display&&(this.display.clear(),this.display.drawText(10,22,"%c{white}Error loading game files, please reload the page")))}An.caveTheme=new kn.Howl({src:["bin/sounds/unpromised.mp3"],volume:0,loop:!0}),this.ecs.registerTags("blocks","blocksSight","drawAfterSeen","input","sentient"),this.ecs.registerComponent(Pt,100),this.ecs.registerComponent(It,100),this.ecs.registerComponent(Mt,100),this.ecs.registerComponent(Gt,100),this.ecs.registerComponent(Lt,10),this.ecs.registerComponent(Dt,20),this.ecs.registerComponent(jt,20),this.ecs.registerComponent(Ft,50),this.ecs.registerComponent(Nt,50),this.ecs.registerComponent(Rt,50),this.ecs.registerComponent(Ht,50),this.ecs.registerComponent($t,50),this.ecs.registerComponent(zt,50),this.ecs.registerComponent(Wt,20),this.ecs.registerComponent(Ut,50),this.ecs.registerComponent(Bt,20),this.ecs.registerComponent(qt,20),this.ecs.registerComponent(Vt,20),this.ecs.registerComponent(Kt,20),this.ecs.registerComponent(Xt,50),this.ecs.registerComponent(Yt,50),this.ecs.registerComponent(Qt,50),this.ecs.registerComponent(Zt,10),this.ecs.registerComponent(Jt,1),this.ecs.registerComponent(en,50),this.ecs.registerComponent(tn,50),this.ecs.registerComponent(nn,50),this.ecs.registerComponent(rn,50),this.ecs.registerComponent(on,50),this.ecs.registerComponent(an,20),this.ecs.registerComponent(sn,20),this.ecs.registerComponent(ln,50),this.ecs.registerComponent(un,10),this.ecs.registerComponent(cn,10),this.ecs.registerSystem("frame",ir),this.ecs.registerSystem("frame",er),this.ecs.registerSystem("frame",tr),this.ecs.registerSystem("frame",nr),this.ecs.registerSystem("postCommand",mn),this.ecs.registerSystem("postCommand",gn),this.ecs.registerSystem("postCommand",pn),this.ecs.registerSystem("postTurn",fn),this.ecs.registerSystem("postTurn",lr),this.ecs.registerSystem("postTurn",ur),this.ecs.registerSystem("postTurn",cr),this.ecs.registerSystem("postTurn",ar),this.ecs.registerSystem("postTurn",or),this.ecs.registerSystem("postTurn",sr),this.ecs.registerSystem("postTurn",yn),this.player=dn(this.ecs,"player",1,1),i.gameEventEmitter.on("ui.openInventory",Dn),i.gameEventEmitter.on("ui.closeInventory",jn),i.gameEventEmitter.on("ui.openSpells",Gn),i.gameEventEmitter.on("ui.closeSpells",Ln),i.gameEventEmitter.on("ui.openKeybinding",zn),i.gameEventEmitter.on("ui.openKeybinding",In),i.gameEventEmitter.on("ui.closeKeybinding",Wn),i.gameEventEmitter.on("ui.closeKeybinding",In),i.gameEventEmitter.on("ui.select",In),i.gameEventEmitter.on("ui.cursorMove",Mn),i.gameEventEmitter.on("level.loaded",$n),i.gameEventEmitter.on("door.open",Nn),i.gameEventEmitter.on("chest.open",Rn),i.gameEventEmitter.on("crate.break",Hn),i.gameEventEmitter.on("barrel.break",Hn),i.gameEventEmitter.on("tutorial.start",qn),i.gameEventEmitter.on("tutorial.attacking",Vn),i.gameEventEmitter.on("tutorial.inventory",Kn),i.gameEventEmitter.on("tutorial.spellMenu",Xn),i.gameEventEmitter.on("tutorial.pickUpItem",Yn),i.gameEventEmitter.on("tutorial.spellTargeting",Qn),i.gameEventEmitter.on("tutorial.wildSpells",Zn),this.scheduler.add(this.player.id,!0),this.gameCamera.follow(this.player),ae.init(),this.lastTimestamp=performance.now(),this.mainLoop(performance.now())}render(){if(null===this.display)throw new Error("Cannot render without a display");if(null===this.player)throw new Error("Cannot render without a player");const e=this.player.getOne(Jt),t=this.player.getOne(jt),n=this.player.getOne(Bt);switch(this.state){case V.Gameplay:this.display.clear(),this.gameCamera.update(this.map),function(e,t,n){for(let r=0;r<n.length;r++)for(let i=0;i<n[r].length;i++){const{x:o,y:a}=t.worldToScreen(i,r);ot(e,n[r][i],o,a)}}(this.display,this.gameCamera,this.map),this.ecs.runSystems("frame"),function(e,t,n,r){var o,a,s,l,u;const c=t.getEntity("player");if(void 0===c)throw new Error("No player entity found");const h=_n(c),d=wn(c),p=c.getOne(Wt),f=c.getOne(Jt),m=c.getOne(tn),g=c.getOne(en),y=c.getOne(nn);if(null===h||null===d||void 0===p||void 0===f)throw new Error("Player missing data");let v="grey";(null===(o=i.Game)||void 0===o?void 0:o.player)===(null===(a=i.Game)||void 0===a?void 0:a.currentActor)&&(v="blue");for(let t=0;t<58;t++)for(let n=0;n<6;n++)e.draw(t,38-(6-n),"#",v,v);e.drawText(1,32,`%c{white}%b{${v}}HP: ${h.hp}/${h.maxHp}`),e.drawText(30,32,`%c{white}%b{${v}}STR: ${d.strength}`),e.drawText(38,32,`%c{white}%b{${v}}DEF: ${d.defense}`),e.drawText(46,32,`%c{white}%b{${v}}EXP: ${p.experience}/${50+150*p.level}`),(null===(s=i.Game)||void 0===s?void 0:s.player)===(null===(l=i.Game)||void 0===l?void 0:l.currentActor)?e.drawText(1,34,`%c{white}%b{${v}}State: ${Et[f.state]}`):e.drawText(1,34,`%c{white}%b{${v}}Enemy Turn`);let _="none";void 0!==m&&m.onFire?_="On Fire":void 0!==g&&g.frozen?_="Frozen":void 0!==y&&y.wet&&(_="Wet"),e.drawText(30,34,`%c{white}%b{${v}}Status: ${_}`);const w=ae.getMousePosition();if(null===w)return;const{x:b,y:x}=w;if(b<0||x<0||b>=n[0].length||x>=n.length)return;const C=n[x][b];if(!(null==C?void 0:C.isVisibleAndLit()))return;!0===(null===(u=i.Game)||void 0===u?void 0:u.debugPathfinding)&&e.drawText(30,36,`%c{white}%b{${v}}(${b}, ${x}): ${C.pathfindingCost}`);const T=Object(J.get)(rt(r,b,x),"[0]",null);if(null===T)return void e.drawText(1,36,`%c{white}%b{${v}}${C.name}`);const E=T.getOne(Mt),S=_n(T),k=T.getOne(qt);void 0!==E&&void 0!==k&&null!==S?e.drawText(1,36,`%c{white}%b{${v}}A ${E.name} (${S.hp}/${S.maxHp}) (${k.knowsTargetPosition})`):void 0!==E&&null!==S?e.drawText(1,36,`%c{white}%b{${v}}A ${E.name} (${S.hp}/${S.maxHp})`):void 0!==E&&e.drawText(1,36,`%c{white}%b{${v}}A ${E.name}`)}(this.display,this.ecs,this.map,this.entityMap);break;case V.PauseMenu:if(void 0===e)return;this.keyBindingMenu.draw(e.keyCommands);break;case V.InventoryMenu:if(void 0===t)return;this.inventoryMenu.draw(De(t));break;case V.SpellMenu:if(void 0===n)return;this.spellSelectionMenu.draw(En(n));break;case V.OpeningCinematic:this.display.clear(),this.display.drawText(2,15,"%c{white}This is an experiment to test a bunch of gameplay ideas I have. It doesn't represent a finished product, but I hope you'll enjoy it anyway!"),this.display.drawText(18,25,"%c{white}Press [enter] to start");break;case V.LoseCinematic:this.display.clear(),this.display.drawText(23,12,"%c{white}You have died"),this.display.drawText(18,15,"%c{white}Press [enter] to start");break;case V.WinCinematic:this.display.clear(),this.display.drawText(18,15,"%c{white}Press [enter] to restart the game");break;default:te(this.state)}this.display.drawWithCache()}loadLevel(e){if(null===i.gameEventEmitter)throw new Error("Global gameEventEmitter cannot be null");this.scheduler.clear(),this.scheduler.add(this.player.id,!0);const{map:t,playerLocation:n}=function(e,t){if(!(t in Ze))throw new Error(t+" is not a valid level");const n=Ze[t],r=n.tileheight,i=[];let o=[0,0];const a=Object(J.get)(n.layers.filter(e=>"Tile Layer"===e.name),"[0]"),s=Object(J.get)(n.layers.filter(e=>"Object Layer"===e.name),"[0]"),l=Object(J.get)(n.layers.filter(e=>"Environment Layer"===e.name),"[0]"),u=Object(J.get)(n.layers.filter(e=>"Node Layer"===e.name),"[0]");if(null===a)throw new Error("No tile layer in map "+t);if(null===s)throw new Error("No object layer in map "+t);if(null===u)throw new Error("No node layer in map "+t);const c=a.data.map(e=>{if(!(e in Je))throw new Error(e+" is not valid tile");const t=Je[e];return new tt(t.name,t.char,t.fgColor,t.bgColor,t.fgColorExplored,t.bgColorExplored,t.blocks,t.blocksSight)});for(let e=0;e<c.length;e+=n.width)i.push(c.slice(e,e+n.width));return u.objects.forEach(t=>{e.createEntity({id:t.id.toString(10),c:{PositionComponent:{x:Math.floor(t.x/r),y:Math.floor(t.y/r)}}})}),u.objects.forEach(t=>{const n=e.getEntity(t.id.toString());if(void 0===n)throw new Error(`Node ${t.id} not initialized in level load`);const r=nt(t,"next"),i=null!==r?e.getEntity(r.toString(10)):null;if(null!==i){n.addComponent({type:"PatrolPathComponent"}).next=i}}),l.data.forEach((t,r)=>{if(0===t)return;const i=et.get(t);if(void 0===i)throw new Error("Unknown environment tile "+t);dn(e,i,Math.floor(r%n.width),Math.floor(r/n.width))}),s.objects.forEach(t=>{if(void 0!==t.point){if("object"!==t.type)throw new Error("Unrecognized object type "+t.type);{const n=nt(t,"objectType"),i=nt(t,"inventory"),a=nt(t,"levelName"),s=nt(t,"spellId"),l=nt(t,"patrolTarget"),u=nt(t,"fallbackPosition"),c=nt(t,"event");if(null===n)throw new Error("No type for "+t.name);if("player"===n)o=[Math.floor(t.x/r),Math.floor(t.y/r)];else{const o=dn(e,n,Math.floor(t.x/r),Math.floor(t.y/r));if(null!==i){const e=new Map;i.split(",").filter(e=>e in Ge).forEach(t=>e.set(t,1));const t=o.getOne(jt);void 0===t?o.addComponent({type:"InventoryComponent",inventory:e}):t.inventory=e}if(null!==a&&o.addComponent({type:"LoadLevelComponent",levelName:a}),null!==s&&o.addComponent({type:"SpellsComponent",knownSpells:new Set([s])}),null!==l){const t=e.getEntity(l.toString());if(void 0===t)throw new Error(`Patrol target ${l} is not initialized`);o.addComponent({type:"PatrolAIComponent",patrolTarget:t});const n=o.getOne(qt);if(void 0===n)throw new Error("Trying to set patrol target without an ai");n.actions.delete("wander"),n.actions.delete("guard"),n.actions.add("patrol");const{goals:r,planner:i}=Xe(n.actions);n.goals=r,n.planner=i,n.update()}if(null!==u){const t=e.getEntity(u.toString());if(void 0===t)throw new Error(`Fallback target ${u} is not initialized`);o.addComponent({type:"FallbackAIComponent",isAtFallbackPosition:!1,fallbackPosition:t});const n=o.getOne(qt);if(void 0===n)throw new Error("Trying to set fallback position without an ai");n.actions.add("goToFallbackPosition");const{goals:r,planner:i}=Xe(n.actions);n.goals=r,n.planner=i,n.update()}"event_trigger"===n&&null!==c&&(o.addComponent({type:"TriggerTypeComponent",triggerType:"event"}),o.addComponent({type:"EventTriggerComponent",event:c}))}}}}),{map:i,playerLocation:o}}(this.ecs,e);this.map=t;const r=this.player.getOne(Pt);if(void 0===r)throw new Error("Player doesn't have a PositionComponent");r.x=n[0],r.y=n[1],r.update(),this.ecs.runSystems("postCommand"),i.gameEventEmitter.emit("level.loaded",e)}handleInput(){if(null===i.gameEventEmitter)throw new Error("Global gameEventEmitter cannot be null");const e=this.player.getOne(Jt),t=this.player.getOne(jt),n=this.player.getOne(Bt),r=this.player.getOne(rn);if(this.state===V.Gameplay)return ae.isDown("Escape")?(i.gameEventEmitter.emit("ui.openKeybinding"),void(this.state=V.PauseMenu)):void(this.currentCommand=function(e,t,n,r){if(null===i.gameEventEmitter)throw new Error("Global gameEventEmitter cannot be null");const o=r.getOne(Jt),a=r.getOne(Pt),s=r.getOne(Rt);if(void 0===o||void 0===a||void 0===s)throw new Error("player is missing data");if(o.state===Et.Combat){for(let e=0;e<o.keyCommands.length;e++){const t=o.keyCommands[e];if(ae.isDown(t.key))return t.command}const r=ae.getLeftMouseDown();if(null!==r){if(at(r,a)<1.5){const e=St(0,t,n,r);if(null!==e&&e!==o.entity)return new _t(e)}const l=i.Game.map[r.y][r.x];if(void 0===l||!1===l.explored)return null;const u=gt(a,r,s.maxTilesPerMove,t,n);if(null!==u)return new vt(u,e,t,n)}return null}if(o.state===Et.Target){i.gameEventEmitter.emit("tutorial.spellTargeting");for(let e=0;e<o.keyCommands.length;e++){const t=o.keyCommands[e];if(ae.isDown(t.key))return t.command}const r=ae.getLeftMouseDown();if(null===r)return null;let a=null;return null!==o.itemForTarget?a=new xt(o.itemForTarget.id,e,t,n,r,o.reticleRotation):null!==o.spellForTarget&&(a=new Ct(o.spellForTarget.id,e,t,n,r,o.reticleRotation)),o.state=Et.Combat,o.itemForTarget=null,o.spellForTarget=null,o.update(),a}return null}(this.ecs,this.map,this.entityMap,this.player));if(this.state===V.PauseMenu){if(void 0===e)return;if(ae.isDown("Escape"))return i.gameEventEmitter.emit("ui.closeKeybinding"),this.state=V.Gameplay,void this.keyBindingMenu.resetState();this.keyBindingMenu.handleInput(e.keyCommands)}else if(this.state===V.InventoryMenu){if(void 0===t||void 0===e)return;if(ae.isDown("Escape"))return i.gameEventEmitter.emit("ui.closeInventory"),this.state=V.Gameplay,void this.inventoryMenu.resetState();const n=this.inventoryMenu.handleInput(De(t));if(null!==n)switch(n.type){case K.HealSelf:case K.ClairvoyanceScroll:case K.HasteSelf:case K.WildDamageScroll:this.state=V.Gameplay,this.currentCommand=new xt(n.id,this.ecs,this.map,this.entityMap);break;case K.DamageScroll:case K.SlowOther:case K.ConfuseScroll:this.state=V.Gameplay,e.itemForTarget=n,e.state=Et.Target,e.update();break;default:te(n.type)}}else if(this.state===V.SpellMenu){if(void 0===n||void 0===e)return;if(ae.isDown("Escape"))return i.gameEventEmitter.emit("ui.closeSpells"),this.state=V.Gameplay,void this.spellSelectionMenu.resetState();const t=this.spellSelectionMenu.handleInput(En(n));if(null!==t){if(void 0!==r&&r.silenced)return void ve("Cannot cast spells while silenced");switch(t.type){case X.Effect:case X.HealSelf:case X.Passive:case X.WildDamage:this.state=V.Gameplay,this.currentCommand=new Ct(t.id,this.ecs,this.map,this.entityMap);break;case X.DamageOther:case X.HealOther:this.state=V.Gameplay,e.spellForTarget=t,e.state=Et.Target,e.update();break;default:te(t.type)}}}else this.state===V.OpeningCinematic?ae.isDown("Enter")&&(this.loadLevel("forrest_001"),this.state=V.Gameplay,i.gameEventEmitter.emit("tutorial.start")):this.state===V.WinCinematic?ae.isDown("Enter")&&(this.reset(),this.state=V.Gameplay):this.state===V.LoseCinematic&&ae.isDown("Enter")&&(this.reset(),this.state=V.Gameplay)}mainLoop(e){i.animationFrameID=window.requestAnimationFrame(this.mainLoop.bind(this)),this.deltaTime=e-this.lastTimestamp,this.lastTimestamp=e,null===this.currentActor&&(this.currentActor=this.ecs.getEntity(this.scheduler.next())),null!==this.currentActor&&null===this.currentCommand&&(this.currentActor===this.player?this.handleInput():this.processAI?this.currentCommand=Qe(this.ecs,this.currentActor,this.map,this.entityMap):this.currentCommand=new yt(!0)),null!==this.currentCommand&&null!==this.currentActor&&!0===this.processCommands&&this.currentCommand.execute(this.deltaTime,this.currentActor),null!==this.currentCommand&&this.currentCommand.isFinished()&&(this.currentCommand.usedTurn()&&(this.currentActor===this.player&&(this.ecs.runSystems("postTurn"),this.totalTurns++),this.ecs.runSystems("postCommand"),this.currentActor=this.ecs.getEntity(this.scheduler.next())),this.currentCommand=null,this.debugPathfinding&&function(e){for(let t=0;t<e.length;t++)for(let n=0;n<e[t].length;n++)e[t][n].pathfindingCost="0"}(this.map));const t=_n(this.player);(null===t||t.hp<=0)&&(this.state=V.LoseCinematic),this.render(),ae.clearInputs(),this.ecs.tick()}getTurnNumber(){return this.totalTurns}},i.window.Game=i.Game,i.window.giveAllItems=function(){if(null===i.Game)throw new Error("Global game object is null");const e=i.Game.player.getOne(jt);if(void 0===e)throw new Error("Global player does not have an inventory");for(const t in Ge)Fe(e,t)},i.window.giveAllSpells=function(){if(null===i.Game)throw new Error("Global game object is null");if(void 0===i.Game.player.getOne(Bt))throw new Error("Global player cannot learn spells");for(const e in Le)Tn(i.Game.player,e,10)},i.window.toggleAI=function(){if(null===i.Game)throw new Error("Global game object is null");i.Game.processAI=!i.Game.processAI},i.window.togglePlayerFOV=function(){if(null===i.Game)throw new Error("Global game object is null");i.Game.isLightingEnabled=!i.Game.isLightingEnabled},i.window.toggleCommandExecution=function(){if(null===i.Game)throw new Error("Global game object is null");i.Game.processCommands=!i.Game.processCommands},i.window.togglePathfindingDebug=function(){if(null===i.Game)throw new Error("Global game object is null");i.Game.debugPathfinding=!i.Game.debugPathfinding},i.window.toggleAIDebug=function(){if(null===i.Game)throw new Error("Global game object is null");i.Game.debugAI=!i.Game.debugAI},i.window.startGameLoop=function(){if(null===i.Game)throw new Error("Global game object is null");null===i.animationFrameID&&(i.animationFrameID=window.requestAnimationFrame(i.Game.mainLoop.bind(i.Game)))},i.window.stopGameLoop=function(){null!==i.animationFrameID&&(window.cancelAnimationFrame(i.animationFrameID),i.animationFrameID=null)},i.window.getEntity=function(e){if(null===i.Game)throw new Error("Global game object is null");return i.Game.ecs.getEntity(e)},i.window.getEntities=function(e,t){if(null===i.Game)throw new Error("Global game object is null");return rt(i.Game.entityMap,e,t)},i.window.step=function(){if(null===i.Game)throw new Error("Global game object is null");null!==i.Game.currentCommand&&null!==i.Game.currentActor&&i.Game.currentCommand.execute(i.Game.deltaTime,i.Game.currentActor)},i.Game.startGameplay()},function(e,t,n){"use strict";n.r(t),n.d(t,"v1",(function(){return m})),n.d(t,"v3",(function(){return E})),n.d(t,"v4",(function(){return S})),n.d(t,"v5",(function(){return O})),n.d(t,"NIL",(function(){return P})),n.d(t,"version",(function(){return I})),n.d(t,"validate",(function(){return s})),n.d(t,"stringify",(function(){return d})),n.d(t,"parse",(function(){return g}));var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),i=new Uint8Array(16);function o(){if(!r)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(i)}var a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var s=function(e){return"string"==typeof e&&a.test(e)},l=[],u=0;u<256;++u)l.push((u+256).toString(16).substr(1));var c,h,d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase();if(!s(n))throw TypeError("Stringified UUID is invalid");return n},p=0,f=0;var m=function(e,t,n){var r=t&&n||0,i=t||new Array(16),a=(e=e||{}).node||c,s=void 0!==e.clockseq?e.clockseq:h;if(null==a||null==s){var l=e.random||(e.rng||o)();null==a&&(a=c=[1|l[0],l[1],l[2],l[3],l[4],l[5]]),null==s&&(s=h=16383&(l[6]<<8|l[7]))}var u=void 0!==e.msecs?e.msecs:Date.now(),m=void 0!==e.nsecs?e.nsecs:f+1,g=u-p+(m-f)/1e4;if(g<0&&void 0===e.clockseq&&(s=s+1&16383),(g<0||u>p)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");p=u,f=m,h=s;var y=(1e4*(268435455&(u+=122192928e5))+m)%4294967296;i[r++]=y>>>24&255,i[r++]=y>>>16&255,i[r++]=y>>>8&255,i[r++]=255&y;var v=u/4294967296*1e4&268435455;i[r++]=v>>>8&255,i[r++]=255&v,i[r++]=v>>>24&15|16,i[r++]=v>>>16&255,i[r++]=s>>>8|128,i[r++]=255&s;for(var _=0;_<6;++_)i[r+_]=a[_];return t||d(i)};var g=function(e){if(!s(e))throw TypeError("Invalid UUID");var t,n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n};var y=function(e,t,n){function r(e,r,i,o){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof r&&(r=g(r)),16!==r.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var a=new Uint8Array(16+e.length);if(a.set(r),a.set(e,r.length),(a=n(a))[6]=15&a[6]|t,a[8]=63&a[8]|128,i){o=o||0;for(var s=0;s<16;++s)i[o+s]=a[s];return i}return d(a)}try{r.name=e}catch(e){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r};function v(e){return 14+(e+64>>>9<<4)+1}function _(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function w(e,t,n,r,i,o){return _((a=_(_(t,e),_(r,o)))<<(s=i)|a>>>32-s,n);var a,s}function b(e,t,n,r,i,o,a){return w(t&n|~t&r,e,t,i,o,a)}function x(e,t,n,r,i,o,a){return w(t&r|n&~r,e,t,i,o,a)}function C(e,t,n,r,i,o,a){return w(t^n^r,e,t,i,o,a)}function T(e,t,n,r,i,o,a){return w(n^(t|~r),e,t,i,o,a)}var E=y("v3",48,(function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){for(var t=[],n=32*e.length,r=0;r<n;r+=8){var i=e[r>>5]>>>r%32&255,o=parseInt("0123456789abcdef".charAt(i>>>4&15)+"0123456789abcdef".charAt(15&i),16);t.push(o)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[v(t)-1]=t;for(var n=1732584193,r=-271733879,i=-1732584194,o=271733878,a=0;a<e.length;a+=16){var s=n,l=r,u=i,c=o;n=b(n,r,i,o,e[a],7,-680876936),o=b(o,n,r,i,e[a+1],12,-389564586),i=b(i,o,n,r,e[a+2],17,606105819),r=b(r,i,o,n,e[a+3],22,-1044525330),n=b(n,r,i,o,e[a+4],7,-176418897),o=b(o,n,r,i,e[a+5],12,1200080426),i=b(i,o,n,r,e[a+6],17,-1473231341),r=b(r,i,o,n,e[a+7],22,-45705983),n=b(n,r,i,o,e[a+8],7,1770035416),o=b(o,n,r,i,e[a+9],12,-1958414417),i=b(i,o,n,r,e[a+10],17,-42063),r=b(r,i,o,n,e[a+11],22,-1990404162),n=b(n,r,i,o,e[a+12],7,1804603682),o=b(o,n,r,i,e[a+13],12,-40341101),i=b(i,o,n,r,e[a+14],17,-1502002290),r=b(r,i,o,n,e[a+15],22,1236535329),n=x(n,r,i,o,e[a+1],5,-165796510),o=x(o,n,r,i,e[a+6],9,-1069501632),i=x(i,o,n,r,e[a+11],14,643717713),r=x(r,i,o,n,e[a],20,-373897302),n=x(n,r,i,o,e[a+5],5,-701558691),o=x(o,n,r,i,e[a+10],9,38016083),i=x(i,o,n,r,e[a+15],14,-660478335),r=x(r,i,o,n,e[a+4],20,-405537848),n=x(n,r,i,o,e[a+9],5,568446438),o=x(o,n,r,i,e[a+14],9,-1019803690),i=x(i,o,n,r,e[a+3],14,-187363961),r=x(r,i,o,n,e[a+8],20,1163531501),n=x(n,r,i,o,e[a+13],5,-1444681467),o=x(o,n,r,i,e[a+2],9,-51403784),i=x(i,o,n,r,e[a+7],14,1735328473),r=x(r,i,o,n,e[a+12],20,-1926607734),n=C(n,r,i,o,e[a+5],4,-378558),o=C(o,n,r,i,e[a+8],11,-2022574463),i=C(i,o,n,r,e[a+11],16,1839030562),r=C(r,i,o,n,e[a+14],23,-35309556),n=C(n,r,i,o,e[a+1],4,-1530992060),o=C(o,n,r,i,e[a+4],11,1272893353),i=C(i,o,n,r,e[a+7],16,-155497632),r=C(r,i,o,n,e[a+10],23,-1094730640),n=C(n,r,i,o,e[a+13],4,681279174),o=C(o,n,r,i,e[a],11,-358537222),i=C(i,o,n,r,e[a+3],16,-722521979),r=C(r,i,o,n,e[a+6],23,76029189),n=C(n,r,i,o,e[a+9],4,-640364487),o=C(o,n,r,i,e[a+12],11,-421815835),i=C(i,o,n,r,e[a+15],16,530742520),r=C(r,i,o,n,e[a+2],23,-995338651),n=T(n,r,i,o,e[a],6,-198630844),o=T(o,n,r,i,e[a+7],10,1126891415),i=T(i,o,n,r,e[a+14],15,-1416354905),r=T(r,i,o,n,e[a+5],21,-57434055),n=T(n,r,i,o,e[a+12],6,1700485571),o=T(o,n,r,i,e[a+3],10,-1894986606),i=T(i,o,n,r,e[a+10],15,-1051523),r=T(r,i,o,n,e[a+1],21,-2054922799),n=T(n,r,i,o,e[a+8],6,1873313359),o=T(o,n,r,i,e[a+15],10,-30611744),i=T(i,o,n,r,e[a+6],15,-1560198380),r=T(r,i,o,n,e[a+13],21,1309151649),n=T(n,r,i,o,e[a+4],6,-145523070),o=T(o,n,r,i,e[a+11],10,-1120210379),i=T(i,o,n,r,e[a+2],15,718787259),r=T(r,i,o,n,e[a+9],21,-343485551),n=_(n,s),r=_(r,l),i=_(i,u),o=_(o,c)}return[n,r,i,o]}(function(e){if(0===e.length)return[];for(var t=8*e.length,n=new Uint32Array(v(t)),r=0;r<t;r+=8)n[r>>5]|=(255&e[r/8])<<r%32;return n}(e),8*e.length))}));var S=function(e,t,n){var r=(e=e||{}).random||(e.rng||o)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return d(r)};function k(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:return t^n^r;case 2:return t&n^t&r^n&r;case 3:return t^n^r}}function A(e,t){return e<<t|e>>>32-t}var O=y("v5",80,(function(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var r=unescape(encodeURIComponent(e));e=[];for(var i=0;i<r.length;++i)e.push(r.charCodeAt(i))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var o=e.length/4+2,a=Math.ceil(o/16),s=new Array(a),l=0;l<a;++l){for(var u=new Uint32Array(16),c=0;c<16;++c)u[c]=e[64*l+4*c]<<24|e[64*l+4*c+1]<<16|e[64*l+4*c+2]<<8|e[64*l+4*c+3];s[l]=u}s[a-1][14]=8*(e.length-1)/Math.pow(2,32),s[a-1][14]=Math.floor(s[a-1][14]),s[a-1][15]=8*(e.length-1)&4294967295;for(var h=0;h<a;++h){for(var d=new Uint32Array(80),p=0;p<16;++p)d[p]=s[h][p];for(var f=16;f<80;++f)d[f]=A(d[f-3]^d[f-8]^d[f-14]^d[f-16],1);for(var m=n[0],g=n[1],y=n[2],v=n[3],_=n[4],w=0;w<80;++w){var b=Math.floor(w/20),x=A(m,5)+k(b,g,y,v)+_+t[b]+d[w]>>>0;_=v,v=y,y=A(g,30)>>>0,g=m,m=x}n[0]=n[0]+m>>>0,n[1]=n[1]+g>>>0,n[2]=n[2]+y>>>0,n[3]=n[3]+v>>>0,n[4]=n[4]+_>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]})),P="00000000-0000-0000-0000-000000000000";var I=function(e){if(!s(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}}]);