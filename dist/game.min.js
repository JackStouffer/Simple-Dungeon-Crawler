!function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=10)}([function(e,t,i){"use strict";const n=2.3283064365386963e-10;class r{constructor(){this._seed=0,this._s0=0,this._s1=0,this._s2=0,this._c=0}getSeed(){return this._seed}setSeed(e){return e=e<1?1/e:e,this._seed=e,this._s0=(e>>>0)*n,e=69069*e+1>>>0,this._s1=e*n,e=69069*e+1>>>0,this._s2=e*n,this._c=1,this}getUniform(){let e=2091639*this._s0+this._c*n;return this._s0=this._s1,this._s1=this._s2,this._c=0|e,this._s2=e-this._c,this._s2}getUniformInt(e,t){let i=Math.max(e,t),n=Math.min(e,t);return Math.floor(this.getUniform()*(i-n+1))+n}getNormal(e=0,t=1){let i,n,r;do{i=2*this.getUniform()-1,n=2*this.getUniform()-1,r=i*i+n*n}while(r>1||0==r);return e+i*Math.sqrt(-2*Math.log(r)/r)*t}getPercentage(){return 1+Math.floor(100*this.getUniform())}getItem(e){return e.length?e[Math.floor(this.getUniform()*e.length)]:null}shuffle(e){let t=[],i=e.slice();for(;i.length;){let e=i.indexOf(this.getItem(i));t.push(i.splice(e,1)[0])}return t}getWeightedValue(e){let t=0;for(let i in e)t+=e[i];let i,n=this.getUniform()*t,r=0;for(i in e)if(r+=e[i],n<r)return i;return i}getState(){return[this._s0,this._s1,this._s2,this._c]}setState(e){return this._s0=e[0],this._s1=e[1],this._s2=e[2],this._c=e[3],this}clone(){return(new r).setState(this.getState())}}t.a=(new r).setSeed(Date.now())},function(e,t,i){"use strict";function n(e,t){return(e%t+t)%t}function r(e,t=0,i=1){return e<t?t:e>i?i:e}function s(e){return e.charAt(0).toUpperCase()+e.substring(1)}function o(e,...t){let i=o.map;return e.replace(/%(?:([a-z]+)|(?:{([^}]+)}))/gi,(function(n,r,o,a){if("%"==e.charAt(a-1))return n.substring(1);if(!t.length)return n;let l=t[0],h=(r||o).split(","),c=h.shift()||"",u=i[c.toLowerCase()];if(!u)return n;l=t.shift();let p=l[u].apply(l,h),g=c.charAt(0);return g!=g.toLowerCase()&&(p=s(p)),p}))}i.r(t),i.d(t,"mod",(function(){return n})),i.d(t,"clamp",(function(){return r})),i.d(t,"capitalize",(function(){return s})),i.d(t,"format",(function(){return o})),o.map={s:"toString"}},function(e,t,i){"use strict";i.r(t),i.d(t,"fromString",(function(){return s})),i.d(t,"add",(function(){return o})),i.d(t,"add_",(function(){return a})),i.d(t,"multiply",(function(){return l})),i.d(t,"multiply_",(function(){return h})),i.d(t,"interpolate",(function(){return c})),i.d(t,"lerp",(function(){return u})),i.d(t,"interpolateHSL",(function(){return p})),i.d(t,"lerpHSL",(function(){return g})),i.d(t,"randomize",(function(){return d})),i.d(t,"rgb2hsl",(function(){return f})),i.d(t,"hsl2rgb",(function(){return _})),i.d(t,"toRGB",(function(){return y})),i.d(t,"toHex",(function(){return w}));var n=i(1),r=i(0);function s(e){let t,i;if(e in b)t=b[e];else{if("#"==e.charAt(0)){let i=(e.match(/[0-9a-f]/gi)||[]).map(e=>parseInt(e,16));if(3==i.length)t=i.map(e=>17*e);else{for(let e=0;e<3;e++)i[e+1]+=16*i[e],i.splice(e,1);t=i}}else t=(i=e.match(/rgb\(([0-9, ]+)\)/i))?i[1].split(/\s*,\s*/).map(e=>parseInt(e)):[0,0,0];b[e]=t}return t.slice()}function o(e,...t){let i=e.slice();for(let e=0;e<3;e++)for(let n=0;n<t.length;n++)i[e]+=t[n][e];return i}function a(e,...t){for(let i=0;i<3;i++)for(let n=0;n<t.length;n++)e[i]+=t[n][i];return e}function l(e,...t){let i=e.slice();for(let e=0;e<3;e++){for(let n=0;n<t.length;n++)i[e]*=t[n][e]/255;i[e]=Math.round(i[e])}return i}function h(e,...t){for(let i=0;i<3;i++){for(let n=0;n<t.length;n++)e[i]*=t[n][i]/255;e[i]=Math.round(e[i])}return e}function c(e,t,i=.5){let n=e.slice();for(let r=0;r<3;r++)n[r]=Math.round(n[r]+i*(t[r]-e[r]));return n}const u=c;function p(e,t,i=.5){let n=f(e),r=f(t);for(let e=0;e<3;e++)n[e]+=i*(r[e]-n[e]);return _(n)}const g=p;function d(e,t){t instanceof Array||(t=Math.round(r.a.getNormal(0,t)));let i=e.slice();for(let e=0;e<3;e++)i[e]+=t instanceof Array?Math.round(r.a.getNormal(0,t[e])):t;return i}function f(e){let t,i=e[0]/255,n=e[1]/255,r=e[2]/255,s=Math.max(i,n,r),o=Math.min(i,n,r),a=0,l=(s+o)/2;if(s==o)t=0;else{let e=s-o;switch(t=l>.5?e/(2-s-o):e/(s+o),s){case i:a=(n-r)/e+(n<r?6:0);break;case n:a=(r-i)/e+2;break;case r:a=(i-n)/e+4}a/=6}return[a,t,l]}function m(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function _(e){let t=e[2];if(0==e[1])return t=Math.round(255*t),[t,t,t];{let i=e[1],n=t<.5?t*(1+i):t+i-t*i,r=2*t-n,s=m(r,n,e[0]+1/3),o=m(r,n,e[0]),a=m(r,n,e[0]-1/3);return[Math.round(255*s),Math.round(255*o),Math.round(255*a)]}}function y(e){return`rgb(${e.map(e=>Object(n.clamp)(e,0,255)).join(",")})`}function w(e){return"#"+e.map(e=>Object(n.clamp)(e,0,255).toString(16).padStart(2,"0")).join("")}const b={black:[0,0,0],navy:[0,0,128],darkblue:[0,0,139],mediumblue:[0,0,205],blue:[0,0,255],darkgreen:[0,100,0],green:[0,128,0],teal:[0,128,128],darkcyan:[0,139,139],deepskyblue:[0,191,255],darkturquoise:[0,206,209],mediumspringgreen:[0,250,154],lime:[0,255,0],springgreen:[0,255,127],aqua:[0,255,255],cyan:[0,255,255],midnightblue:[25,25,112],dodgerblue:[30,144,255],forestgreen:[34,139,34],seagreen:[46,139,87],darkslategray:[47,79,79],darkslategrey:[47,79,79],limegreen:[50,205,50],mediumseagreen:[60,179,113],turquoise:[64,224,208],royalblue:[65,105,225],steelblue:[70,130,180],darkslateblue:[72,61,139],mediumturquoise:[72,209,204],indigo:[75,0,130],darkolivegreen:[85,107,47],cadetblue:[95,158,160],cornflowerblue:[100,149,237],mediumaquamarine:[102,205,170],dimgray:[105,105,105],dimgrey:[105,105,105],slateblue:[106,90,205],olivedrab:[107,142,35],slategray:[112,128,144],slategrey:[112,128,144],lightslategray:[119,136,153],lightslategrey:[119,136,153],mediumslateblue:[123,104,238],lawngreen:[124,252,0],chartreuse:[127,255,0],aquamarine:[127,255,212],maroon:[128,0,0],purple:[128,0,128],olive:[128,128,0],gray:[128,128,128],grey:[128,128,128],skyblue:[135,206,235],lightskyblue:[135,206,250],blueviolet:[138,43,226],darkred:[139,0,0],darkmagenta:[139,0,139],saddlebrown:[139,69,19],darkseagreen:[143,188,143],lightgreen:[144,238,144],mediumpurple:[147,112,216],darkviolet:[148,0,211],palegreen:[152,251,152],darkorchid:[153,50,204],yellowgreen:[154,205,50],sienna:[160,82,45],brown:[165,42,42],darkgray:[169,169,169],darkgrey:[169,169,169],lightblue:[173,216,230],greenyellow:[173,255,47],paleturquoise:[175,238,238],lightsteelblue:[176,196,222],powderblue:[176,224,230],firebrick:[178,34,34],darkgoldenrod:[184,134,11],mediumorchid:[186,85,211],rosybrown:[188,143,143],darkkhaki:[189,183,107],silver:[192,192,192],mediumvioletred:[199,21,133],indianred:[205,92,92],peru:[205,133,63],chocolate:[210,105,30],tan:[210,180,140],lightgray:[211,211,211],lightgrey:[211,211,211],palevioletred:[216,112,147],thistle:[216,191,216],orchid:[218,112,214],goldenrod:[218,165,32],crimson:[220,20,60],gainsboro:[220,220,220],plum:[221,160,221],burlywood:[222,184,135],lightcyan:[224,255,255],lavender:[230,230,250],darksalmon:[233,150,122],violet:[238,130,238],palegoldenrod:[238,232,170],lightcoral:[240,128,128],khaki:[240,230,140],aliceblue:[240,248,255],honeydew:[240,255,240],azure:[240,255,255],sandybrown:[244,164,96],wheat:[245,222,179],beige:[245,245,220],whitesmoke:[245,245,245],mintcream:[245,255,250],ghostwhite:[248,248,255],salmon:[250,128,114],antiquewhite:[250,235,215],linen:[250,240,230],lightgoldenrodyellow:[250,250,210],oldlace:[253,245,230],red:[255,0,0],fuchsia:[255,0,255],magenta:[255,0,255],deeppink:[255,20,147],orangered:[255,69,0],tomato:[255,99,71],hotpink:[255,105,180],coral:[255,127,80],darkorange:[255,140,0],lightsalmon:[255,160,122],orange:[255,165,0],lightpink:[255,182,193],pink:[255,192,203],gold:[255,215,0],peachpuff:[255,218,185],navajowhite:[255,222,173],moccasin:[255,228,181],bisque:[255,228,196],mistyrose:[255,228,225],blanchedalmond:[255,235,205],papayawhip:[255,239,213],lavenderblush:[255,240,245],seashell:[255,245,238],cornsilk:[255,248,220],lemonchiffon:[255,250,205],floralwhite:[255,250,240],snow:[255,250,250],yellow:[255,255,0],lightyellow:[255,255,224],ivory:[255,255,240],white:[255,255,255]}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{getContainer(){return null}setOptions(e){this._options=e}}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,i){"use strict";(function(e){i.d(t,"a",(function(){return o}));var n=i(3),r=i(2);function s(e){let t=r.fromString(e);return 36*Math.floor(t[0]*(6/256))+6*Math.floor(t[1]*(6/256))+1*Math.floor(t[2]*(6/256))+16}class o extends n.a{constructor(){super(),this._offset=[0,0],this._cursor=[-1,-1],this._lastColor=""}schedule(e){setTimeout(e,1e3/60)}setOptions(e){super.setOptions(e);let t=[e.width,e.height],i=this.computeSize();this._offset=i.map((e,i)=>Math.floor((e-t[i])/2))}clear(){e.stdout.write(`[0;48;5;${s(this._options.bg)}m[2J`)}draw(t,i){let[n,r,o,a,l]=t,h=this._offset[0]+n,c=this._offset[1]+r,u=this.computeSize();if(h<0||h>=u[0])return;if(c<0||c>=u[1])return;if(h===this._cursor[0]&&c===this._cursor[1]||(e.stdout.write(function(e,t){return`[${t+1};${e+1}H`}(h,c)),this._cursor[0]=h,this._cursor[1]=c),i&&(o||(o=" ")),!o)return;let p=function(e,t){return`[0;38;5;${s(e)};48;5;${s(t)}m`}(a,l);if(p!==this._lastColor&&(e.stdout.write(p),this._lastColor=p),"\t"!=o){let t=[].concat(o);e.stdout.write(t[0])}this._cursor[0]++,this._cursor[0]>=u[0]&&(this._cursor[0]=0,this._cursor[1]++)}computeFontSize(){throw new Error("Terminal backend has no notion of font size")}eventToPosition(e,t){return[e,t]}computeSize(){return[e.stdout.columns,e.stdout.rows]}}}).call(this,i(9))},function(e,t,i){(function(e){var t;t={compressionlevel:-1,editorsettings:{export:{target:"."}},height:39,infinite:!1,layers:[{data:[1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,1165,1165,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,1165,1165,1165,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,1165,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,1165,1165,1165,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,1165,1165,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,1165,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,1165,1165,1165,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,1165,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,1165,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,1165,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,1165,1165,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1165,1165,1165,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1165,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048],height:39,id:1,name:"World",opacity:1,type:"tilelayer",visible:!0,width:70,x:0,y:0},{draworder:"topdown",id:4,name:"Object Layer 1",objects:[{height:0,id:4,name:"Player",point:!0,properties:[{name:"id",type:"string",value:"player"}],rotation:0,type:"",visible:!0,width:0,x:434.407214885732,y:597.42625896958},{height:0,id:5,name:"Rat",point:!0,properties:[{name:"id",type:"string",value:"rat"}],rotation:0,type:"",visible:!0,width:0,x:1034.21306581315,y:637.979450172237},{height:0,id:10,name:"Rat",point:!0,properties:[{name:"id",type:"string",value:"rat"}],rotation:0,type:"",visible:!0,width:0,x:946.647780925402,y:1192.16241737488},{height:0,id:11,name:"Door",point:!0,properties:[{name:"id",type:"string",value:"load_door"},{name:"levelName",type:"string",value:"level_2"}],rotation:0,type:"",visible:!0,width:0,x:1553.3522190746,y:567.853960595562},{height:0,id:12,name:"Lantern",point:!0,properties:[{name:"id",type:"string",value:"lantern"}],rotation:0,type:"",visible:!0,width:0,x:1492.09884474265,y:443.42795991692},{height:0,id:17,name:"Crate",point:!0,properties:[{name:"id",type:"string",value:"crate"},{name:"inventory",type:"string",value:"health_potion_weak"}],rotation:0,type:"",visible:!0,width:0,x:528.565696038229,y:52.1822201259912},{height:0,id:18,name:"Lantern",point:!0,properties:[{name:"id",type:"string",value:"lantern"}],rotation:0,type:"",visible:!0,width:0,x:1488.32909637162,y:695.632077651953},{height:0,id:19,name:"Rat",point:!0,properties:[{name:"id",type:"string",value:"rat"}],rotation:0,type:"",visible:!0,width:0,x:681.765657499422,y:97.0649410677145}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:5,nextobjectid:20,orientation:"orthogonal",renderorder:"right-down",tiledversion:"1.3.4",tileheight:32,tilesets:[{firstgid:1,source:"../DungeonCrawl_ProjectUtumnoTileset.tsx"}],tilewidth:32,type:"map",version:1.2,width:70},"undefined"==typeof onTileMapLoaded?("undefined"==typeof TileMaps&&(TileMaps={}),TileMaps.level_1=t):onTileMapLoaded("level_1",t),e&&e.exports&&(e.exports=t)}).call(this,i(4)(e))},function(e,t,i){(function(e){var t;t={compressionlevel:-1,editorsettings:{export:{target:"."}},height:39,infinite:!1,layers:[{data:[1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,2936,2936,2936,900,1048,1048,1048,900,900,900,900,900,900,900,2869,900,900,900,2869,900,900,900,2869,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,1048,1048,1048,900,900,900,900,900,2710,2710,2710,2710,2710,2710,2710,2710,2710,2710,2710,2710,2710,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,1048,1048,1048,900,900,900,900,900,2710,2710,2710,2710,2710,2710,2710,2710,2710,2710,2710,2710,2710,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,2869,900,900,900,2869,900,900,900,2869,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,1048,1048,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,1048,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,1048,1048,1048,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,1048,1048,1048,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048],height:39,id:1,name:"World",opacity:1,type:"tilelayer",visible:!0,width:70,x:0,y:0},{draworder:"topdown",id:4,name:"Object Layer 1",objects:[{height:0,id:4,name:"Player",point:!0,properties:[{name:"id",type:"string",value:"player"}],rotation:0,type:"",visible:!0,width:0,x:48.9730893444762,y:727.91157376972},{height:0,id:5,name:"Golbin",point:!0,properties:[{name:"id",type:"string",value:"goblin"}],rotation:0,type:"",visible:!0,width:0,x:644.193719444052,y:712.330540708638},{height:0,id:6,name:"Chest",point:!0,properties:[{name:"id",type:"string",value:"chest"},{name:"inventory",type:"string",value:"health_potion_weak,lightning_scroll_weak"}],rotation:0,type:"",visible:!0,width:0,x:341.526275397425,y:948.672967850652},{height:0,id:7,name:"Stairs",point:!0,properties:[{name:"id",type:"string",value:"stairs"},{name:"levelName",type:"string",value:"level_2"}],rotation:0,type:"",visible:!0,width:0,x:1202.30788561211,y:247.937747564976},{height:0,id:8,name:"Crate",point:!0,properties:[{name:"id",type:"string",value:"crate"},{name:"inventory",type:"string",value:"health_potion_weak"}],rotation:0,type:"",visible:!0,width:0,x:370.617261554132,y:949.94792690583},{height:0,id:9,name:"Crate",point:!0,properties:[{name:"id",type:"string",value:"crate"},{name:"inventory",type:"string",value:""}],rotation:0,type:"",visible:!0,width:0,x:944.729776321084,y:725.333340842067},{height:0,id:11,name:"Crate",point:!0,properties:[{name:"id",type:"string",value:"crate"},{name:"inventory",type:"string",value:"health_potion_weak"}],rotation:0,type:"",visible:!0,width:0,x:943.603906892819,y:760.182468483655},{height:0,id:12,name:"Golbin",point:!0,properties:[{name:"id",type:"string",value:"goblin"}],rotation:0,type:"",visible:!0,width:0,x:340.545596044442,y:1083.26097831731},{height:0,id:14,name:"Fire",point:!0,properties:[{name:"id",type:"string",value:"campfire"}],rotation:0,type:"",visible:!0,width:0,x:658.781710294825,y:237.201980125518},{height:0,id:15,name:"Fire",point:!0,properties:[{name:"id",type:"string",value:"campfire"}],rotation:0,type:"",visible:!0,width:0,x:786.258618604088,y:238.296842869239},{height:0,id:16,name:"Fire",point:!0,properties:[{name:"id",type:"string",value:"campfire"}],rotation:0,type:"",visible:!0,width:0,x:910.850368936736,y:239.506471513245},{height:0,id:17,name:"Lantern",point:!0,properties:[{name:"id",type:"string",value:"lantern"}],rotation:0,type:"",visible:!0,width:0,x:209.265755413088,y:951.97774283295},{height:0,id:18,name:"Golbin",point:!0,properties:[{name:"id",type:"string",value:"goblin"}],rotation:0,type:"",visible:!0,width:0,x:949.558485544938,y:145.155437280755},{height:0,id:19,name:"Golbin",point:!0,properties:[{name:"id",type:"string",value:"goblin"}],rotation:0,type:"",visible:!0,width:0,x:622.958751663239,y:147.574694568767},{height:0,id:20,name:"Rat",point:!0,properties:[{name:"id",type:"string",value:"rat"}],rotation:0,type:"",visible:!0,width:0,x:244.344986089271,y:226.200556429176},{height:0,id:22,name:"Load Door",point:!0,properties:[{name:"id",type:"string",value:"load_door"},{name:"levelName",type:"string",value:"level_1"}],rotation:0,type:"",visible:!0,width:0,x:14.605418138987,y:723.203769140165},{height:0,id:29,name:"Door",point:!0,properties:[{name:"id",type:"string",value:"door"}],rotation:0,type:"",visible:!0,width:0,x:526.910048927362,y:728.264960481746}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:5,nextobjectid:30,orientation:"orthogonal",renderorder:"right-down",tiledversion:"1.3.4",tileheight:32,tilesets:[{firstgid:1,source:"../DungeonCrawl_ProjectUtumnoTileset.tsx"}],tilewidth:32,type:"map",version:1.2,width:70},"undefined"==typeof onTileMapLoaded?("undefined"==typeof TileMaps&&(TileMaps={}),TileMaps.level_2=t):onTileMapLoaded("level_2",t),e&&e.exports&&(e.exports=t)}).call(this,i(4)(e))},function(e,t,i){(function(e){var t;t={compressionlevel:-1,height:39,infinite:!1,layers:[{data:[1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,1048,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,1048,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,1048,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,1048,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,1048,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,1048,1048,1048,1048,1048,1048,1048,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048,1048],height:39,id:1,name:"Tile Layer 1",opacity:1,type:"tilelayer",visible:!0,width:70,x:0,y:0},{draworder:"topdown",id:2,name:"Object Layer 1",objects:[{height:0,id:1,name:"Player",point:!0,properties:[{name:"id",type:"string",value:"player"}],rotation:0,type:"",visible:!0,width:0,x:880.250035462825,y:754.192197850584},{height:0,id:2,name:"Door",point:!0,properties:[{name:"id",type:"string",value:"door"}],rotation:0,type:"",visible:!0,width:0,x:1297.45889387145,y:627.80269058296},{height:0,id:3,name:"Goblin",point:!0,properties:[{name:"id",type:"string",value:"goblin"}],rotation:0,type:"",visible:!0,width:0,x:1297.45889387145,y:488.789237668161},{height:0,id:4,name:"Chest",point:!0,properties:[{name:"id",type:"string",value:"chest"},{name:"inventory",type:"string",value:"health_potion_weak,lightning_scroll_weak"}],rotation:0,type:"",visible:!0,width:0,x:1201.79372197309,y:887.892376681614},{height:0,id:5,name:"Lantern",point:!0,properties:[{name:"id",type:"string",value:"lantern"}],rotation:0,type:"",visible:!0,width:0,x:1139.76083707025,y:757.847533632287},{height:0,id:6,name:"Chest",point:!0,properties:[{name:"id",type:"string",value:"chest"},{name:"inventory",type:"string",value:"health_potion_weak,health_potion_weak"}],rotation:0,type:"",visible:!0,width:0,x:1038.86397608371,y:887.144992526158},{height:0,id:7,name:"Magika Shrine",point:!0,properties:[{name:"id",type:"string",value:"magic_shrine"},{name:"spellId",type:"string",value:"lightning_bolt"}],rotation:0,type:"",visible:!0,width:0,x:1425.26158445441,y:760.837070254111},{height:0,id:8,name:"Crate",point:!0,properties:[{name:"id",type:"string",value:"crate"},{name:"inventory",type:"string",value:"health_potion_weak"}],rotation:0,type:"",visible:!0,width:0,x:1135.27653213752,y:887.144992526158},{height:0,id:9,name:"Door",point:!0,properties:[{name:"id",type:"string",value:"door"}],rotation:0,type:"",visible:!0,width:0,x:1039.61136023916,y:630.792227204783},{height:0,id:10,name:"Goblin Brute",point:!0,properties:[{name:"id",type:"string",value:"goblin_brute"}],rotation:0,type:"",visible:!0,width:0,x:1043.34828101644,y:507.473841554559}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:3,nextobjectid:11,orientation:"orthogonal",renderorder:"right-down",tiledversion:"1.3.4",tileheight:32,tilesets:[{firstgid:1,source:"../DungeonCrawl_ProjectUtumnoTileset.tsx"}],tilewidth:32,type:"map",version:1.2,width:70},"undefined"==typeof onTileMapLoaded?("undefined"==typeof TileMaps&&(TileMaps={}),TileMaps.dev_room=t):onTileMapLoaded("dev_room",t),e&&e.exports&&(e.exports=t)}).call(this,i(4)(e))},function(e,t){var i,n,r=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(i===setTimeout)return setTimeout(e,0);if((i===s||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:s}catch(e){i=s}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var l,h=[],c=!1,u=-1;function p(){c&&l&&(c=!1,l.length?h=l.concat(h):u=-1,h.length&&g())}function g(){if(!c){var e=a(p);c=!0;for(var t=h.length;t;){for(l=h,h=[];++u<t;)l&&l[u].run();u=-1,t=h.length}l=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function f(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];h.push(new d(e,t)),1!==h.length||c||a(g)},d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=f,r.addListener=f,r.once=f,r.off=f,r.removeListener=f,r.removeAllListeners=f,r.emit=f,r.prependListener=f,r.prependOnceListener=f,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,i){"use strict";i.r(t),i.d(t,"mouseLook",(function(){return Qe}));var n={};i.r(n),i.d(n,"TYPE_TEXT",(function(){return b})),i.d(n,"TYPE_NEWLINE",(function(){return v})),i.d(n,"TYPE_FG",(function(){return x})),i.d(n,"TYPE_BG",(function(){return k})),i.d(n,"measure",(function(){return C})),i.d(n,"tokenize",(function(){return S}));var r=i(0),s=i(3);class o extends s.a{constructor(){super(),this._ctx=document.createElement("canvas").getContext("2d")}schedule(e){requestAnimationFrame(e)}getContainer(){return this._ctx.canvas}setOptions(e){super.setOptions(e);const t=`${e.fontStyle?e.fontStyle+" ":""} ${e.fontSize}px ${e.fontFamily}`;this._ctx.font=t,this._updateSize(),this._ctx.font=t,this._ctx.textAlign="center",this._ctx.textBaseline="middle"}clear(){this._ctx.fillStyle=this._options.bg,this._ctx.fillRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height)}eventToPosition(e,t){let i=this._ctx.canvas,n=i.getBoundingClientRect();return e-=n.left,t-=n.top,e*=i.width/n.width,t*=i.height/n.height,e<0||t<0||e>=i.width||t>=i.height?[-1,-1]:this._normalizedEventToPosition(e,t)}}var a=i(1);class l extends o{constructor(){super(),this._spacingX=0,this._spacingY=0,this._hexSize=0}draw(e,t){let[i,n,r,s,o]=e,a=[(i+1)*this._spacingX,n*this._spacingY+this._hexSize];if(this._options.transpose&&a.reverse(),t&&(this._ctx.fillStyle=o,this._fill(a[0],a[1])),!r)return;this._ctx.fillStyle=s;let l=[].concat(r);for(let e=0;e<l.length;e++)this._ctx.fillText(l[e],a[0],Math.ceil(a[1]))}computeSize(e,t){return this._options.transpose&&(e+=t,e-=t=e-t),[Math.floor(e/this._spacingX)-1,Math.floor((t-2*this._hexSize)/this._spacingY+1)]}computeFontSize(e,t){this._options.transpose&&(e+=t,e-=t=e-t);let i=2*e/((this._options.width+1)*Math.sqrt(3))-1,n=t/(2+1.5*(this._options.height-1)),r=Math.min(i,n),s=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;let o=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=s;let a=o/100;r=Math.floor(r)+1;let l=2*r/(this._options.spacing*(1+a/Math.sqrt(3)));return Math.ceil(l)-1}_normalizedEventToPosition(e,t){let i;this._options.transpose?(e+=t,e-=t=e-t,i=this._ctx.canvas.width):i=this._ctx.canvas.height;let n=i/this._options.height;return t=Math.floor(t/n),Object(a.mod)(t,2)?(e-=this._spacingX,e=1+2*Math.floor(e/(2*this._spacingX))):e=2*Math.floor(e/(2*this._spacingX)),[e,t]}_fill(e,t){let i=this._hexSize,n=this._options.border;const r=this._ctx;r.beginPath(),this._options.transpose?(r.moveTo(e-i+n,t),r.lineTo(e-i/2+n,t+this._spacingX-n),r.lineTo(e+i/2-n,t+this._spacingX-n),r.lineTo(e+i-n,t),r.lineTo(e+i/2-n,t-this._spacingX+n),r.lineTo(e-i/2+n,t-this._spacingX+n),r.lineTo(e-i+n,t)):(r.moveTo(e,t-i+n),r.lineTo(e+this._spacingX-n,t-i/2+n),r.lineTo(e+this._spacingX-n,t+i/2-n),r.lineTo(e,t+i-n),r.lineTo(e-this._spacingX+n,t+i/2-n),r.lineTo(e-this._spacingX+n,t-i/2+n),r.lineTo(e,t-i+n)),r.fill()}_updateSize(){const e=this._options,t=Math.ceil(this._ctx.measureText("W").width);let i,n;this._hexSize=Math.floor(e.spacing*(e.fontSize+t/Math.sqrt(3))/2),this._spacingX=this._hexSize*Math.sqrt(3)/2,this._spacingY=1.5*this._hexSize,e.transpose?(i="height",n="width"):(i="width",n="height"),this._ctx.canvas[i]=Math.ceil((e.width+1)*this._spacingX),this._ctx.canvas[n]=Math.ceil((e.height-1)*this._spacingY+2*this._hexSize)}}var h=(()=>{class e extends o{constructor(){super(),this._spacingX=0,this._spacingY=0,this._canvasCache={}}setOptions(e){super.setOptions(e),this._canvasCache={}}draw(t,i){e.cache?this._drawWithCache(t):this._drawNoCache(t,i)}_drawWithCache(e){let t,[i,n,r,s,o]=e,a=""+r+s+o;if(a in this._canvasCache)t=this._canvasCache[a];else{let e=this._options.border;t=document.createElement("canvas");let i=t.getContext("2d");if(t.width=this._spacingX,t.height=this._spacingY,i.fillStyle=o,i.fillRect(e,e,t.width-e,t.height-e),r){i.fillStyle=s,i.font=this._ctx.font,i.textAlign="center",i.textBaseline="middle";let e=[].concat(r);for(let t=0;t<e.length;t++)i.fillText(e[t],this._spacingX/2,Math.ceil(this._spacingY/2))}this._canvasCache[a]=t}this._ctx.drawImage(t,i*this._spacingX,n*this._spacingY)}_drawNoCache(e,t){let[i,n,r,s,o]=e;if(t){let e=this._options.border;this._ctx.fillStyle=o,this._ctx.fillRect(i*this._spacingX+e,n*this._spacingY+e,this._spacingX-e,this._spacingY-e)}if(!r)return;this._ctx.fillStyle=s;let a=[].concat(r);for(let e=0;e<a.length;e++)this._ctx.fillText(a[e],(i+.5)*this._spacingX,Math.ceil((n+.5)*this._spacingY))}computeSize(e,t){return[Math.floor(e/this._spacingX),Math.floor(t/this._spacingY)]}computeFontSize(e,t){let i=Math.floor(e/this._options.width),n=Math.floor(t/this._options.height),r=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;let s=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=r;let o=s/100*n/i;return o>1&&(n=Math.floor(n/o)),Math.floor(n/this._options.spacing)}_normalizedEventToPosition(e,t){return[Math.floor(e/this._spacingX),Math.floor(t/this._spacingY)]}_updateSize(){const e=this._options,t=Math.ceil(this._ctx.measureText("W").width);this._spacingX=Math.ceil(e.spacing*t),this._spacingY=Math.ceil(e.spacing*e.fontSize),e.forceSquareRatio&&(this._spacingX=this._spacingY=Math.max(this._spacingX,this._spacingY)),this._ctx.canvas.width=e.width*this._spacingX,this._ctx.canvas.height=e.height*this._spacingY}}return e.cache=!1,e})();class c extends o{constructor(){super(),this._colorCanvas=document.createElement("canvas")}draw(e,t){let[i,n,r,s,o]=e,a=this._options.tileWidth,l=this._options.tileHeight;if(t&&(this._options.tileColorize?this._ctx.clearRect(i*a,n*l,a,l):(this._ctx.fillStyle=o,this._ctx.fillRect(i*a,n*l,a,l))),!r)return;let h=[].concat(r),c=[].concat(s),u=[].concat(o);for(let e=0;e<h.length;e++){let t=this._options.tileMap[h[e]];if(!t)throw new Error(`Char "${h[e]}" not found in tileMap`);if(this._options.tileColorize){let r=this._colorCanvas,s=r.getContext("2d");s.globalCompositeOperation="source-over",s.clearRect(0,0,a,l);let o=c[e],h=u[e];s.drawImage(this._options.tileSet,t[0],t[1],a,l,0,0,a,l),"transparent"!=o&&(s.fillStyle=o,s.globalCompositeOperation="source-atop",s.fillRect(0,0,a,l)),"transparent"!=h&&(s.fillStyle=h,s.globalCompositeOperation="destination-over",s.fillRect(0,0,a,l)),this._ctx.drawImage(r,i*a,n*l,a,l)}else this._ctx.drawImage(this._options.tileSet,t[0],t[1],a,l,i*a,n*l,a,l)}}computeSize(e,t){return[Math.floor(e/this._options.tileWidth),Math.floor(t/this._options.tileHeight)]}computeFontSize(){throw new Error("Tile backend does not understand font size")}_normalizedEventToPosition(e,t){return[Math.floor(e/this._options.tileWidth),Math.floor(t/this._options.tileHeight)]}_updateSize(){const e=this._options;this._ctx.canvas.width=e.width*e.tileWidth,this._ctx.canvas.height=e.height*e.tileHeight,this._colorCanvas.width=e.tileWidth,this._colorCanvas.height=e.tileHeight}}var u=i(2);class p extends s.a{constructor(){super(),this._uniforms={};try{this._gl=this._initWebGL()}catch(e){alert(e.message)}}static isSupported(){return!!document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0})}schedule(e){requestAnimationFrame(e)}getContainer(){return this._gl.canvas}setOptions(e){super.setOptions(e),this._updateSize();let t=this._options.tileSet;t&&"complete"in t&&!t.complete?t.addEventListener("load",()=>this._updateTexture(t)):this._updateTexture(t)}draw(e,t){const i=this._gl,n=this._options;let[r,s,o,a,l]=e,h=i.canvas.height-(s+1)*n.tileHeight;if(i.scissor(r*n.tileWidth,h,n.tileWidth,n.tileHeight),t&&(n.tileColorize?i.clearColor(0,0,0,0):i.clearColor(..._(l)),i.clear(i.COLOR_BUFFER_BIT)),!o)return;let c=[].concat(o),u=[].concat(l),p=[].concat(a);i.uniform2fv(this._uniforms.targetPosRel,[r,s]);for(let e=0;e<c.length;e++){let t=this._options.tileMap[c[e]];if(!t)throw new Error(`Char "${c[e]}" not found in tileMap`);i.uniform1f(this._uniforms.colorize,n.tileColorize?1:0),i.uniform2fv(this._uniforms.tilesetPosAbs,t),n.tileColorize&&(i.uniform4fv(this._uniforms.tint,_(p[e])),i.uniform4fv(this._uniforms.bg,_(u[e]))),i.drawArrays(i.TRIANGLE_STRIP,0,4)}}clear(){const e=this._gl;e.clearColor(..._(this._options.bg)),e.scissor(0,0,e.canvas.width,e.canvas.height),e.clear(e.COLOR_BUFFER_BIT)}computeSize(e,t){return[Math.floor(e/this._options.tileWidth),Math.floor(t/this._options.tileHeight)]}computeFontSize(){throw new Error("Tile backend does not understand font size")}eventToPosition(e,t){let i=this._gl.canvas,n=i.getBoundingClientRect();return e-=n.left,t-=n.top,e*=i.width/n.width,t*=i.height/n.height,e<0||t<0||e>=i.width||t>=i.height?[-1,-1]:this._normalizedEventToPosition(e,t)}_initWebGL(){let e=document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0});window.gl=e;let t=function(e,t,i){const n=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(n)||"");const r=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(r,i),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(r)||"");const s=e.createProgram();if(e.attachShader(s,n),e.attachShader(s,r),e.linkProgram(s),!e.getProgramParameter(s,e.LINK_STATUS))throw new Error(e.getProgramInfoLog(s)||"");return s}(e,d,f);return e.useProgram(t),function(e){const t=new Float32Array([0,0,1,0,0,1,1,1]),i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0)}(e),g.forEach(i=>this._uniforms[i]=e.getUniformLocation(t,i)),this._program=t,e.enable(e.BLEND),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.enable(e.SCISSOR_TEST),e}_normalizedEventToPosition(e,t){return[Math.floor(e/this._options.tileWidth),Math.floor(t/this._options.tileHeight)]}_updateSize(){const e=this._gl,t=this._options,i=[t.width*t.tileWidth,t.height*t.tileHeight];e.canvas.width=i[0],e.canvas.height=i[1],e.viewport(0,0,i[0],i[1]),e.uniform2fv(this._uniforms.tileSize,[t.tileWidth,t.tileHeight]),e.uniform2fv(this._uniforms.targetSize,i)}_updateTexture(e){!function(e,t){let i=e.createTexture();e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t)}(this._gl,e)}}const g=["targetPosRel","tilesetPosAbs","tileSize","targetSize","colorize","bg","tint"],d="\n#version 300 es\n\nin vec2 tilePosRel;\nout vec2 tilesetPosPx;\n\nuniform vec2 tilesetPosAbs;\nuniform vec2 tileSize;\nuniform vec2 targetSize;\nuniform vec2 targetPosRel;\n\nvoid main() {\n\tvec2 targetPosPx = (targetPosRel + tilePosRel) * tileSize;\n\tvec2 targetPosNdc = ((targetPosPx / targetSize)-0.5)*2.0;\n\ttargetPosNdc.y *= -1.0;\n\n\tgl_Position = vec4(targetPosNdc, 0.0, 1.0);\n\ttilesetPosPx = tilesetPosAbs + tilePosRel * tileSize;\n}".trim(),f="\n#version 300 es\nprecision highp float;\n\nin vec2 tilesetPosPx;\nout vec4 fragColor;\nuniform sampler2D image;\nuniform bool colorize;\nuniform vec4 bg;\nuniform vec4 tint;\n\nvoid main() {\n\tfragColor = vec4(0, 0, 0, 1);\n\n\tvec4 texel = texelFetch(image, ivec2(tilesetPosPx), 0);\n\n\tif (colorize) {\n\t\ttexel.rgb = tint.a * tint.rgb + (1.0-tint.a) * texel.rgb;\n\t\tfragColor.rgb = texel.a*texel.rgb + (1.0-texel.a)*bg.rgb;\n\t\tfragColor.a = texel.a + (1.0-texel.a)*bg.a;\n\t} else {\n\t\tfragColor = texel;\n\t}\n}".trim();let m={};function _(e){if(!(e in m)){let t;if("transparent"==e)t=[0,0,0,0];else if(e.indexOf("rgba")>-1){t=(e.match(/[\d.]+/g)||[]).map(Number);for(let e=0;e<3;e++)t[e]=t[e]/255}else t=u.fromString(e).map(e=>e/255),t.push(1);m[e]=t}return m[e]}var y=i(5);const w=/%([bc]){([^}]*)}/g,b=0,v=1,x=2,k=3;function C(e,t){let i={width:0,height:1},n=S(e,t),r=0;for(let e=0;e<n.length;e++){let t=n[e];switch(t.type){case b:r+=t.value.length;break;case v:i.height++,i.width=Math.max(i.width,r),r=0}}return i.width=Math.max(i.width,r),i}function S(e,t){let i=[],n=0;e.replace(w,(function(t,r,s,o){let a=e.substring(n,o);return a.length&&i.push({type:b,value:a}),i.push({type:"c"==r?x:k,value:s.trim()}),n=o+t.length,""}));let r=e.substring(n);return r.length&&i.push({type:b,value:r}),function(e,t){t||(t=1/0);let i=0,n=0,r=-1;for(;i<e.length;){let s=e[i];if(s.type==v&&(n=0,r=-1),s.type!=b){i++;continue}for(;0==n&&" "==s.value.charAt(0);)s.value=s.value.substring(1);let o=s.value.indexOf("\n");if(-1!=o){s.value=M(e,i,o,!0);let t=s.value.split("");for(;t.length&&" "==t[t.length-1];)t.pop();s.value=t.join("")}if(s.value.length){if(n+s.value.length>t){let o=-1;for(;;){let e=s.value.indexOf(" ",o+1);if(-1==e)break;if(n+e>t)break;o=e}if(-1!=o)s.value=M(e,i,o,!0);else if(-1!=r){let t=e[r],n=t.value.lastIndexOf(" ");t.value=M(e,r,n,!0),i=r}else s.value=M(e,i,t-n,!1)}else n+=s.value.length,-1!=s.value.indexOf(" ")&&(r=i);i++}else e.splice(i,1)}e.push({type:v});let s=null;for(let t=0;t<e.length;t++){let i=e[t];switch(i.type){case b:s=i;break;case v:if(s){let e=s.value.split("");for(;e.length&&" "==e[e.length-1];)e.pop();s.value=e.join("")}s=null}}return e.pop(),e}(i,t)}function M(e,t,i,n){let r={type:v},s={type:b,value:e[t].value.substring(i+(n?1:0))};return e.splice(t+1,0,r,s),e[t].value.substring(0,i)}const T={4:[[0,-1],[1,0],[0,1],[-1,0]],8:[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]],6:[[-1,-1],[1,-1],[2,0],[1,1],[-1,1],[-2,0]]},E={hex:l,rect:h,tile:c,"tile-gl":p,term:y.a},G={width:80,height:25,transpose:!1,layout:"rect",fontSize:15,spacing:1,border:0,forceSquareRatio:!1,fontFamily:"monospace",fontStyle:"",fg:"#ccc",bg:"#000",tileWidth:32,tileHeight:32,tileMap:{},tileSet:null,tileColorize:!1};var O=(()=>{class e{constructor(e={}){this._data={},this._dirty=!1,this._options={},e=Object.assign({},G,e),this.setOptions(e),this.DEBUG=this.DEBUG.bind(this),this._tick=this._tick.bind(this),this._backend.schedule(this._tick)}DEBUG(e,t,i){let n=[this._options.bg,this._options.fg];this.draw(e,t,null,null,n[i%n.length])}clear(){this._data={},this._dirty=!0}setOptions(e){if(Object.assign(this._options,e),e.width||e.height||e.fontSize||e.fontFamily||e.spacing||e.layout){if(e.layout){let t=E[e.layout];this._backend=new t}this._backend.setOptions(this._options),this._dirty=!0}return this}getOptions(){return this._options}getContainer(){return this._backend.getContainer()}computeSize(e,t){return this._backend.computeSize(e,t)}computeFontSize(e,t){return this._backend.computeFontSize(e,t)}computeTileSize(e,t){return[Math.floor(e/this._options.width),Math.floor(t/this._options.height)]}eventToPosition(e){let t,i;return"touches"in e?(t=e.touches[0].clientX,i=e.touches[0].clientY):(t=e.clientX,i=e.clientY),this._backend.eventToPosition(t,i)}draw(e,t,i,n,r){n||(n=this._options.fg),r||(r=this._options.bg);let s=`${e},${t}`;this._data[s]=[e,t,i,n,r],!0!==this._dirty&&(this._dirty||(this._dirty={}),this._dirty[s]=!0)}drawText(e,t,i,n){let r=null,s=null,o=e,a=t,l=1;n||(n=this._options.width-e);let h=S(i,n);for(;h.length;){let t=h.shift();switch(t.type){case b:let i=!1,n=!1,h=!1,c=!1;for(let e=0;e<t.value.length;e++){let l=t.value.charCodeAt(e),u=t.value.charAt(e);if("term"===this._options.layout){let e=l>>8;if(17===e||e>=46&&e<=159||e>=172&&e<=215||l>=43360&&l<=43391){this.draw(o+0,a,u,r,s),this.draw(o+1,a,"\t",r,s),o+=2;continue}}h=l>65280&&l<65377||l>65500&&l<65512||l>65518,i=32==u.charCodeAt(0)||12288==u.charCodeAt(0),!c||h||i||o++,h&&!n&&o++,this.draw(o++,a,u,r,s),n=i,c=h}break;case x:r=t.value||null;break;case k:s=t.value||null;break;case v:o=e,a++,l++}}return l}_tick(){if(this._backend.schedule(this._tick),this._dirty){if(!0===this._dirty){this._backend.clear();for(let e in this._data)this._draw(e,!1)}else for(let e in this._dirty)this._draw(e,!0);this._dirty=!1}}_draw(e,t){let i=this._data[e];i[4]!=this._options.bg&&(t=!0),this._backend.draw(i,t)}}return e.Rect=h,e.Hex=l,e.Tile=c,e.TileGL=p,e.Term=y.a,e})();class L{constructor(){this.heap=[],this.timestamp=0}lessThan(e,t){return e.key==t.key?e.timestamp<t.timestamp:e.key<t.key}shift(e){this.heap=this.heap.map(({key:t,value:i,timestamp:n})=>({key:t+e,value:i,timestamp:n}))}len(){return this.heap.length}push(e,t){this.timestamp+=1;const i=this.len();this.heap.push({value:e,timestamp:this.timestamp,key:t}),this.updateUp(i)}pop(){if(0==this.len())throw new Error("no element to pop");const e=this.heap[0];return this.len()>1?(this.heap[0]=this.heap.pop(),this.updateDown(0)):this.heap.pop(),e}find(e){for(let t=0;t<this.len();t++)if(e==this.heap[t].value)return this.heap[t];return null}remove(e){let t=null;for(let i=0;i<this.len();i++)e==this.heap[i].value&&(t=i);return null!=t&&(this.len()>1?(this.heap[t]=this.heap.pop(),this.updateDown(t),!0):(this.heap.pop(),!0))}parentNode(e){return Math.floor((e-1)/2)}leftChildNode(e){return 2*e+1}rightChildNode(e){return 2*e+2}existNode(e){return e>=0&&e<this.heap.length}swap(e,t){const i=this.heap[e];this.heap[e]=this.heap[t],this.heap[t]=i}minNode(e){const t=e.filter(this.existNode.bind(this));let i=t[0];for(const e of t)this.lessThan(this.heap[e],this.heap[i])&&(i=e);return i}updateUp(e){if(0==e)return;const t=this.parentNode(e);this.existNode(t)&&this.lessThan(this.heap[e],this.heap[t])&&(this.swap(e,t),this.updateUp(t))}updateDown(e){const t=this.leftChildNode(e),i=this.rightChildNode(e);if(!this.existNode(t))return;const n=this.minNode([e,t,i]);n!=e&&(this.swap(e,n),this.updateDown(n))}debugPrint(){console.log(this.heap)}}class P{constructor(){this._time=0,this._events=new L}getTime(){return this._time}clear(){return this._events=new L,this}add(e,t){this._events.push(e,t)}get(){if(!this._events.len())return null;let{key:e,value:t}=this._events.pop();return e>0&&(this._time+=e,this._events.shift(-e)),t}getEventTime(e){const t=this._events.find(e);if(t){const{key:e}=t;return e}}remove(e){return this._events.remove(e)}}class A{constructor(){this._queue=new P,this._repeat=[],this._current=null}getTime(){return this._queue.getTime()}add(e,t){return t&&this._repeat.push(e),this}getTimeOf(e){return this._queue.getEventTime(e)}clear(){return this._queue.clear(),this._repeat=[],this._current=null,this}remove(e){let t=this._queue.remove(e),i=this._repeat.indexOf(e);return-1!=i&&this._repeat.splice(i,1),this._current==e&&(this._current=null),t}next(){return this._current=this._queue.get(),this._current}}var I={Simple:class extends A{add(e,t){return this._queue.add(e,0),super.add(e,t)}next(){return null!==this._current&&-1!=this._repeat.indexOf(this._current)&&this._queue.add(this._current,0),super.next()}},Speed:class extends A{add(e,t,i){return this._queue.add(e,void 0!==i?i:1/e.getSpeed()),super.add(e,t)}next(){return this._current&&-1!=this._repeat.indexOf(this._current)&&this._queue.add(this._current,1/this._current.getSpeed()),super.next()}},Action:class extends A{constructor(){super(),this._defaultDuration=1,this._duration=this._defaultDuration}add(e,t,i){return this._queue.add(e,i||this._defaultDuration),super.add(e,t)}clear(){return this._duration=this._defaultDuration,super.clear()}remove(e){return e==this._current&&(this._duration=this._defaultDuration),super.remove(e)}next(){return null!==this._current&&-1!=this._repeat.indexOf(this._current)&&(this._queue.add(this._current,this._duration||this._defaultDuration),this._duration=this._defaultDuration),super.next()}setDuration(e){return this._current&&(this._duration=e),this}}};class R{constructor(e,t={}){this._lightPasses=e,this._options=Object.assign({topology:8},t)}_getCircle(e,t,i){let n,r,s,o=[];switch(this._options.topology){case 4:r=1,s=[0,1],n=[T[8][7],T[8][1],T[8][3],T[8][5]];break;case 6:n=T[6],r=1,s=[-1,1];break;case 8:n=T[4],r=2,s=[-1,1];break;default:throw new Error("Incorrect topology for FOV computation")}let a=e+s[0]*i,l=t+s[1]*i;for(let e=0;e<n.length;e++)for(let t=0;t<i*r;t++)o.push([a,l]),a+=n[e][0],l+=n[e][1];return o}}const F=[[-1,0,0,1],[0,-1,1,0],[0,-1,-1,0],[-1,0,0,-1],[1,0,0,-1],[0,1,-1,0],[0,1,1,0],[1,0,0,1]];var z={DiscreteShadowcasting:class extends R{compute(e,t,i,n){if(n(e,t,0,1),!this._lightPasses(e,t))return;let r,s,o,a,l,h=[];for(let c=1;c<=i;c++){let i=this._getCircle(e,t,c),u=360/i.length;for(let e=0;e<i.length;e++)if(o=i[e][0],a=i[e][1],r=u*(e-.5),s=r+u,l=!this._lightPasses(o,a),this._visibleCoords(Math.floor(r),Math.ceil(s),l,h)&&n(o,a,c,1),2==h.length&&0==h[0]&&360==h[1])return}}_visibleCoords(e,t,i,n){if(e<0){let r=this._visibleCoords(0,t,i,n),s=this._visibleCoords(360+e,360,i,n);return r||s}let r=0;for(;r<n.length&&n[r]<e;)r++;if(r==n.length)return i&&n.push(e,t),!0;let s=0;if(r%2){for(;r<n.length&&n[r]<t;)r++,s++;return 0!=s&&(i&&(s%2?n.splice(r-s,s,t):n.splice(r-s,s)),!0)}for(;r<n.length&&n[r]<t;)r++,s++;return(e!=n[r-s]||1!=s)&&(i&&(s%2?n.splice(r-s,s,e):n.splice(r-s,s,e,t)),!0)}},PreciseShadowcasting:class extends R{compute(e,t,i,n){if(n(e,t,0,1),!this._lightPasses(e,t))return;let r,s,o,a,l,h,c=[];for(let u=1;u<=i;u++){let i=this._getCircle(e,t,u),p=i.length;for(let e=0;e<p;e++)if(r=i[e][0],s=i[e][1],a=[e?2*e-1:2*p-1,2*p],l=[2*e+1,2*p],o=!this._lightPasses(r,s),h=this._checkVisibility(a,l,o,c),h&&n(r,s,u,h),2==c.length&&0==c[0][0]&&c[1][0]==c[1][1])return}}_checkVisibility(e,t,i,n){if(e[0]>t[0]){return(this._checkVisibility(e,[e[1],e[1]],i,n)+this._checkVisibility([0,1],t,i,n))/2}let r=0,s=!1;for(;r<n.length;){let t=n[r],i=t[0]*e[1]-e[0]*t[1];if(i>=0){0!=i||r%2||(s=!0);break}r++}let o=n.length,a=!1;for(;o--;){let e=n[o],i=t[0]*e[1]-e[0]*t[1];if(i>=0){0==i&&o%2&&(a=!0);break}}let l,h=!0;if((r==o&&(s||a)||s&&a&&r+1==o&&o%2||r>o&&r%2)&&(h=!1),!h)return 0;let c=o-r+1;if(c%2)if(r%2){let e=n[r];l=(t[0]*e[1]-e[0]*t[1])/(e[1]*t[1]),i&&n.splice(r,c,t)}else{let t=n[o];l=(t[0]*e[1]-e[0]*t[1])/(e[1]*t[1]),i&&n.splice(r,c,e)}else{if(!(r%2))return i&&n.splice(r,c,e,t),1;{let e=n[r],t=n[o];l=(t[0]*e[1]-e[0]*t[1])/(e[1]*t[1]),i&&n.splice(r,c)}}return l/((t[0]*e[1]-e[0]*t[1])/(e[1]*t[1]))}},RecursiveShadowcasting:class extends R{compute(e,t,i,n){n(e,t,0,1);for(let r=0;r<F.length;r++)this._renderOctant(e,t,F[r],i,n)}compute180(e,t,i,n,r){r(e,t,0,1);let s=(n-1+8)%8,o=(n-2+8)%8,a=(n+1+8)%8;this._renderOctant(e,t,F[o],i,r),this._renderOctant(e,t,F[s],i,r),this._renderOctant(e,t,F[n],i,r),this._renderOctant(e,t,F[a],i,r)}compute90(e,t,i,n,r){r(e,t,0,1);let s=(n-1+8)%8;this._renderOctant(e,t,F[n],i,r),this._renderOctant(e,t,F[s],i,r)}_renderOctant(e,t,i,n,r){this._castVisibility(e,t,1,1,0,n+1,i[0],i[1],i[2],i[3],r)}_castVisibility(e,t,i,n,r,s,o,a,l,h,c){if(!(n<r))for(let u=i;u<=s;u++){let i=-u-1,p=-u,g=!1,d=0;for(;i<=0;){i+=1;let f=e+i*o+p*a,m=t+i*l+p*h,_=(i-.5)/(p+.5),y=(i+.5)/(p-.5);if(!(y>n)){if(_<r)break;if(i*i+p*p<s*s&&c(f,m,u,1),g){if(!this._lightPasses(f,m)){d=y;continue}g=!1,n=d}else!this._lightPasses(f,m)&&u<s&&(g=!0,this._castVisibility(e,t,u+1,n,_,s,o,a,l,h,c),d=y)}}if(g)break}}}};Math.sqrt(3),Math.sqrt(3);class N{constructor(e,t,i,n={}){this._toX=e,this._toY=t,this._passableCallback=i,this._options=Object.assign({topology:8},n),this._dirs=T[this._options.topology],8==this._options.topology&&(this._dirs=[this._dirs[0],this._dirs[2],this._dirs[4],this._dirs[6],this._dirs[1],this._dirs[3],this._dirs[5],this._dirs[7]])}_getNeighbors(e,t){let i=[];for(let n=0;n<this._dirs.length;n++){let r=this._dirs[n],s=e+r[0],o=t+r[1];this._passableCallback(s,o)&&i.push([s,o])}return i}}var j={Dijkstra:class extends N{constructor(e,t,i,n){super(e,t,i,n),this._computed={},this._todo=[],this._add(e,t,null)}compute(e,t,i){let n=e+","+t;if(n in this._computed||this._compute(e,t),!(n in this._computed))return;let r=this._computed[n];for(;r;)i(r.x,r.y),r=r.prev}_compute(e,t){for(;this._todo.length;){let i=this._todo.shift();if(i.x==e&&i.y==t)return;let n=this._getNeighbors(i.x,i.y);for(let e=0;e<n.length;e++){let t=n[e],r=t[0],s=t[1];r+","+s in this._computed||this._add(r,s,i)}}}_add(e,t,i){let n={x:e,y:t,prev:i};this._computed[e+","+t]=n,this._todo.push(n)}},AStar:class extends N{constructor(e,t,i,n={}){super(e,t,i,n),this._todo=[],this._done={}}compute(e,t,i){for(this._todo=[],this._done={},this._fromX=e,this._fromY=t,this._add(this._toX,this._toY,null);this._todo.length;){let i=this._todo.shift(),n=i.x+","+i.y;if(n in this._done)continue;if(this._done[n]=i,i.x==e&&i.y==t)break;let r=this._getNeighbors(i.x,i.y);for(let e=0;e<r.length;e++){let t=r[e],n=t[0],s=t[1];n+","+s in this._done||this._add(n,s,i)}}let n=this._done[e+","+t];if(n)for(;n;)i(n.x,n.y),n=n.prev}_add(e,t,i){let n=this._distance(e,t),r={x:e,y:t,prev:i,g:i?i.g+1:0,h:n},s=r.g+r.h;for(let e=0;e<this._todo.length;e++){let t=this._todo[e],i=t.g+t.h;if(s<i||s==i&&n<t.h)return void this._todo.splice(e,0,r)}this._todo.push(r)}_distance(e,t){switch(this._options.topology){case 4:return Math.abs(e-this._fromX)+Math.abs(t-this._fromY);case 6:let i=Math.abs(e-this._fromX),n=Math.abs(t-this._fromY);return n+Math.max(0,(i-n)/2);case 8:return Math.max(Math.abs(e-this._fromX),Math.abs(t-this._fromY))}}}};class D{constructor(e){this._scheduler=e,this._lock=1}start(){return this.unlock()}lock(){return this._lock++,this}unlock(){if(!this._lock)throw new Error("Cannot unlock unlocked engine");for(this._lock--;!this._lock;){let e=this._scheduler.next();if(!e)return this.lock();let t=e.act();t&&t.then&&(this.lock(),t.then(this.unlock.bind(this)))}return this}}class U{constructor(e,t={}){this._reflectivityCallback=e,this._options={},t=Object.assign({passes:1,emissionThreshold:100,range:10},t),this._lights={},this._reflectivityCache={},this._fovCache={},this.setOptions(t)}setOptions(e){return Object.assign(this._options,e),e&&e.range&&this.reset(),this}setFOV(e){return this._fov=e,this._fovCache={},this}setLight(e,t,i){let n=e+","+t;return i?this._lights[n]="string"==typeof i?u.fromString(i):i:delete this._lights[n],this}clearLights(){this._lights={}}reset(){return this._reflectivityCache={},this._fovCache={},this}compute(e){let t={},i={},n={};for(let e in this._lights){let t=this._lights[e];i[e]=[0,0,0],u.add_(i[e],t)}for(let e=0;e<this._options.passes;e++)this._emitLight(i,n,t),e+1!=this._options.passes&&(i=this._computeEmitters(n,t));for(let t in n){let i=t.split(",");e(parseInt(i[0]),parseInt(i[1]),n[t])}return this}_emitLight(e,t,i){for(let n in e){let r=n.split(","),s=parseInt(r[0]),o=parseInt(r[1]);this._emitLightFromCell(s,o,e[n],t),i[n]=1}return this}_computeEmitters(e,t){let i={};for(let n in e){if(n in t)continue;let r,s=e[n];if(n in this._reflectivityCache)r=this._reflectivityCache[n];else{let e=n.split(","),t=parseInt(e[0]),i=parseInt(e[1]);r=this._reflectivityCallback(t,i),this._reflectivityCache[n]=r}if(0==r)continue;let o=[0,0,0],a=0;for(let e=0;e<3;e++){let t=Math.round(s[e]*r);o[e]=t,a+=t}a>this._options.emissionThreshold&&(i[n]=o)}return i}_emitLightFromCell(e,t,i,n){let r,s=e+","+t;r=s in this._fovCache?this._fovCache[s]:this._updateFOV(e,t);for(let e in r){let t,s=r[e];e in n?t=n[e]:(t=[0,0,0],n[e]=t);for(let e=0;e<3;e++)t[e]+=Math.round(i[e]*s)}return this}_updateFOV(e,t){let i=e+","+t,n={};this._fovCache[i]=n;let r=this._options.range;return this._fov.compute(e,t,r,function(e,t,i,s){let o=s*(1-i/r);0!=o&&(n[e+","+t]=o)}.bind(this)),n}}const X=u;var Y={},H=i(6),W=i.n(H),B=i(7),q=i.n(B),$=i(8),V=i.n($);const K={level_1:W.a,level_2:q.a,dev_room:V.a};class J{constructor(e,t,i,n,r,s,o,a,l=!1,h=!1){this.name=e,this.char=t,this.fgColor=i,this.bgColor=n,this.fgColorExplored=r,this.bgColorExplored=s,this.blocks=o,this.blocksSight=a,this.visible=l,this.explored=h,this.reflectivity=.18,this.lightingColor=n}isVisibleAndLit(){return this.visible&&this.lightingColor!==Ce}}function Q(e){const t=K[e],i=t.tileheight,n=[],r=[];let s=null;if(t.width!==ye&&t.height!==we)throw new Error(`Loaded map ${name} doesn't match world width/height`);if(2!==t.layers.length)throw new Error(`Loaded map ${name} should only have two layers`);const o=t.layers[0].data.map(e=>{if(!(e in Te))throw new Error(e+" is not valid tile");const t=Te[e];return new J(t.name,t.char,t.fgColor,t.bgColor,t.fgColorExplored,t.bgColorExplored,t.blocks,t.blocksSight)});for(let e=0;e<o.length;e+=ye)n.push(o.slice(e,e+ye));return t.layers[1].objects.forEach(e=>{function t(t){if(!e.properties||!e.properties.length)return null;const i=e.properties.filter(e=>e.name===t);return 0===i.length?null:i[0].value}let n;const o=t("id"),a=t("inventory"),l=t("levelName"),h=t("spellId");if(o){if(e.point)"player"===o?s=[Math.floor(e.x/i),Math.floor(e.y/i)]:(n=Ve(o,Math.floor(e.x/i),Math.floor(e.y/i)),a&&n.inventoryComponent&&a.split(",").forEach(e=>n.inventoryComponent.addItem(e)),l&&n.interactable&&n.interactable.setLevel&&n.interactable.setLevel(l),h&&n.interactable&&n.interactable.setSpell&&n.interactable.setSpell(h),r.push(n));else if("Rectangle"===e.type){const t=Math.floor(e.x/i),n=Math.floor(e.y/i),s=Math.floor(e.width/i)+t,a=Math.floor(e.height/i)+n;for(let e=n;e<a;e++)for(let i=t;i<s;i++)r.push(Ve(o,e,i))}}else console.error("No id for "+e.name)}),{map:n,playerLocation:s,objects:r}}function Z(e,t,i){return e.filter(e=>e.x===t&&e.y===i)}function ee(e,t,i,n){if(i<0||n<0||i>=ye||n>=we||e[n][i].blocks)return!0;const r=t.filter(e=>e.x===i&&e.y===n&&!0===e.blocks)[0];return r||null}function te(e,t,i,n){let r,s;t.blocks?t.explored?t.explored&&t.visible?(r=t.fgColor,s=t.bgColor):t.explored&&!t.visible&&(r=ve,s=ve):(r=be,s=be):t.isVisibleAndLit()?(r=t.fgColor,s=t.lightingColor):t.explored?(r=ke,s=ke):(r=xe,s=xe),e.draw(i,n,t.char,r,s)}function ie(e,t){const i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i**2+n**2)}function ne(e){return function(t,i){return e.x===t&&e.y===i||null===ee(Y.Game.map,Y.Game.gameObjects,t,i)}}function re(e){return function(t,i){return e.x===t&&e.y===i||!1===function(e,t,i,n){if(i<0||n<0||i>=ye||n>=we||e[n][i].blocksSight)return!0;const r=Z(t,i,n);for(let e=0;e<r.length;e++)if(r[e].blocksSight)return!0;return!1}(Y.Game.map,Y.Game.gameObjects,t,i)}}function se(e){return function(t,i,n,r){t===Y.Game.player.x&&i===Y.Game.player.y&&r>0&&(Y.Game.displayMessage(e.owner.name+" saw you"),e.state="chase")}}class oe{constructor(e){this.owner=null,this.state="wander",this.sightRange=e}setOwner(e){this.owner=e}act(){if("wander"===this.state){new z.PreciseShadowcasting(re(this.owner)).compute(this.owner.x,this.owner.y,this.sightRange,se(this));const e=T[8][r.a.getItem([0,1,2,3,4,5,6,7])],t=this.owner.x+e[0],i=this.owner.y+e[1];if(null!==ee(Y.Game.map,Y.Game.gameObjects,t,i))return;this.owner.x=t,this.owner.y=i}else if("chase"===this.state){let e=Y.Game.player.x,t=Y.Game.player.y;const i=new j.AStar(e,t,ne(this.owner),{topology:8}),n=[];if(i.compute(this.owner.x,this.owner.y,(function(e,t){n.push([e,t])})),n.shift(),1===n.length)this.owner.fighter.attack(Y.Game.player);else{if(0===n.length)return;e=n[0][0],t=n[0][1],this.owner.x=e,this.owner.y=t}}}}class ae{constructor(e){this.owner=null,this.state="patrol",this.sightRange=e,this.patrolTarget=null}setOwner(e){this.owner=e}act(){if("patrol"===this.state){new z.PreciseShadowcasting(re(this.owner)).compute(this.owner.x,this.owner.y,this.sightRange,se(this)),null===this.patrolTarget&&(this.patrolTarget=function(e,t){let i=0,n=0;for(;exports.isBlocked(e,t,i,n);)i=Math.floor(r.a.getUniform()*ye),n=Math.floor(r.a.getUniform()*we);return{x:i,y:n}}(Y.Game.map,Y.Game.gameObjects));const t=new j.AStar(this.patrolTarget.x,this.patrolTarget.y,ne(this.owner),{topology:8}),i=[];function e(e,t){i.push([e,t])}if(t.compute(this.owner.x,this.owner.y,e),i.shift(),0===i.length)return void(this.patrolTarget=null);this.owner.x=i[0][0],this.owner.y=i[0][1]}else if("chase"===this.state){const t=new j.AStar(Y.Game.player.x,Y.Game.player.y,re(this.owner),{topology:8}),i=[];function e(e,t){i.push([e,t])}if(t.compute(this.owner.x,this.owner.y,e),i.shift(),1===i.length)this.owner.fighter.attack(Y.Game.player);else{if(0===i.length)return;this.owner.x=i[0][0],this.owner.y=i[0][1]}}}}class le{constructor(e,t){this.owner=null,this.oldAI=e,this.turns=t}act(){if(this.turns>0){const e=T[4][r.a.getItem([0,1,2,3])],t=this.owner.x+e[0],i=this.owner.y+e[1];if(null!==ee(Y.Game.map,Y.Game.gameObjects,t,i))return;this.owner.x=t,this.owner.y=i}else this.owner===Y.Game.player?Y.Game.displayMessage("You are no longer confused"):Y.Game.displayMessage(this.owner.name+" is no longer confused"),this.owner.ai=this.oldAI;this.turns--}}class he{constructor(e,t){this.owner=null,this.bgColor=e,this.emptyColor=t}setOwner(e){this.owner=e}act(){this.owner&&this.owner.inventoryComponent?0===this.owner.inventoryComponent.getIDsAndCounts().length?this.owner.graphics.bgColor=this.emptyColor:this.owner.graphics.bgColor=this.bgColor:console.error("Missing inventoryComponent for ChestAI")}}class ce{constructor(e,t){this.owner=null,this.bgColor=e,this.emptyColor=t}setOwner(e){this.owner=e}act(){this.owner&&this.owner.inventoryComponent?0===this.owner.inventoryComponent.getIDsAndCounts().length&&Y.Game.removeObject(this.owner):console.error("Missing inventoryComponent for DroppedItemAI")}}function ue(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function pe(e){Y.Game.unhookMouseLook(),Y.Game.drawAll(),Y.Game.canvas.addEventListener("mousedown",(function t(i){if(0===i.button){const n=Y.Game.display.eventToPosition(i);let r;Y.Game.canvas.removeEventListener("mousedown",t),Y.Game.hookMouseLook();const s=Z(Y.Game.gameObjects,n[0],n[1]);for(let e=0;e<s.length;e++)if(s[e].fighter){r=s[e];break}return r&&r.fighter?e(r):e(null)}}))}function ge(e,t,i){return t.fighter.hp>=t.fighter.maxHp?(t===Y.Game.player?Y.Game.displayMessage("You are already at full health."):Y.Game.displayMessage(t.name+" tries and fails to take a health potion"),i(!1)):(t.fighter.heal(e.value),i(!0))}function de(e,t,i){Y.Game.displayMessage("Left click on an enemy to target it, click elsewhere to cancel"),pe((function(n){if(null===n)return Y.Game.displayMessage("Canceled casting"),i(!1);if(Y.Game.displayMessage(`Spell hits ${n.name} for ${e.value} damage`),n.fighter.takeDamage(t,e.value,e.damageType),n.fighter&&e.statusEffectFunc&&r.a.getUniform()<=n.fighter.ailmentSusceptibility){const t=Math.round(.0625*n.fighter.maxHp),i=ue(3,6);n.fighter.addStatusEffect(e.statusEffectFunc(n,t,i))}return i(!0)}))}function fe(e,t,i){const n=function(e,t,i,n){let r=null,s=n+1;for(let n=0;n<t.length;n++){const o=t[n];if(void 0!==o.fighter&&null!==o.fighter&&o!==i&&e[o.y][o.x].visible){const e=ie(i,o);e<s&&(r=o,s=e)}}return r}(Y.Game.map,Y.Game.gameObjects,t,8);if(null===n)return t===Y.Game.player&&Y.Game.displayMessage("No target is close enough to use the scroll"),i(!1);if(Y.Game.displayMessage(`Spell hits ${n.name} for ${e.value} damage`),n.fighter.takeDamage(t,e.value,e.damageType),n.fighter&&e.statusEffectFunc&&r.a.getUniform()<=n.fighter.ailmentSusceptibility){const t=Math.round(.0625*n.fighter.maxHp),i=ue(3,6);n.fighter.addStatusEffect(e.statusEffectFunc(n,t,i))}return i(!0)}class me{constructor(e,t,i,n){this.owner=e,this.name=t,this.turns=i,this.actCallback=n}act(){this.actCallback(this.owner,this.name),this.turns--}}function _e(e,t,i){return new me(e,"Burn",i,(function(e){e.fighter&&e.fighter.takeDamage(null,t),e===Y.Game.player?Y.Game.displayMessage("You were hurt by the burn for "+t+" damage"):Y.Game.displayMessage(e.name+" was hurt by the burn for "+t+" damage")}))}const ye=70,we=38,be="black",ve="rgb(20, 20, 20)",xe="black",ke="rgb(50, 50, 50)",Ce="rgb(50, 50, 50)",Se={physical:1,fire:2,lightning:3,ice:4,nature:5};Object.freeze(Se);const Me={weak:.5,normal:1,strong:2,nullified:0};Object.freeze(Me);const Te={900:{name:"empty ground",char:"",fgColor:"white",bgColor:"white",fgColorExplored:ke,bgColorExplored:ke,blocks:!1,blocksSight:!1,reflectivity:.18},1048:{name:"A wall",char:"",fgColor:"#352620",bgColor:"#352620",fgColorExplored:ve,bgColorExplored:ve,blocks:!0,blocksSight:!0,reflectivity:.18},1165:{name:"A tree",char:"ቸ",fgColor:"lightgreen",bgColor:"darkgreen",fgColorExplored:ve,bgColorExplored:ve,blocks:!0,blocksSight:!0,reflectivity:.18},2710:{name:"A table",char:"Π",fgColor:"tan",bgColor:"brown",fgColorExplored:ve,bgColorExplored:ve,blocks:!0,blocksSight:!1,reflectivity:.18},2869:{name:"A chair",char:"п",fgColor:"black",bgColor:"brown",fgColorExplored:ve,bgColorExplored:ve,blocks:!0,blocksSight:!1,reflectivity:.18},2936:{name:"A cabinet",char:"⌹",fgColor:"black",bgColor:"brown",fgColorExplored:ve,bgColorExplored:ve,blocks:!0,blocksSight:!1,reflectivity:.18}};Object.freeze(Te);const Ee={door:{name:"Door",graphics:"basic_graphics",ai:null,inventory:null,fighter:null,interactable:"door_interactable",char:"ᢂ",fgColor:"white",bgColor:"brown",blocks:!0,blocksSight:!0},load_door:{name:"Door to new area",graphics:"draw_after_seen",ai:null,inventory:null,fighter:null,interactable:"load_level_interactable",char:"ᢂ",fgColor:"white",bgColor:"black",blocks:!0,blocksSight:!0},stairs:{name:"Stairs",graphics:"draw_after_seen",ai:null,inventory:null,fighter:null,interactable:"load_level_interactable",char:"ᝐ",fgColor:"white",bgColor:"black",blocks:!0,blocksSight:!1},chest:{name:"Chest",graphics:"draw_after_seen",ai:"chest_ai",fighter:null,inventory:"basic_inventory",interactable:"give_items_interactable",char:"*",fgColor:"white",bgColor:"brown",emptyColor:"purple",blocks:!0,blocksSight:!1},crate:{name:"Wooden Crate",graphics:"basic_graphics",ai:null,fighter:"basic_fighter",inventory:"basic_inventory",interactable:null,char:"☒",fgColor:"white",bgColor:"brown",emptyColor:"purple",blocks:!0,blocksSight:!1,experience:0,experienceGiven:0,maxHp:5,strength:0,defense:0,onDeath:"removeFromWorld"},lantern:{name:"Small Lantern",graphics:"basic_graphics",lighting:"reflectivity",lightingColor:"yellow",lightingRange:4,ai:null,fighter:null,inventory:null,interactable:null,char:"ᛡ",fgColor:"black",bgColor:"yellow",blocks:!0,blocksSight:!1},campfire:{name:"Small Fire",graphics:"basic_graphics",lighting:"reflectivity",lightingColor:"orange",lightingRange:6,ai:null,fighter:null,inventory:null,interactable:null,char:"ж",fgColor:"black",bgColor:"orange",blocks:!0,blocksSight:!1},dropped_item:{name:"Dropped Item",graphics:"basic_graphics",ai:"dropped_item_ai",inventory:null,fighter:null,interactable:"give_items_interactable",char:"!",fgColor:"white",bgColor:"brown",blocks:!1,blocksSight:!1},magic_shrine:{name:"Magicka Shrine",graphics:"basic_graphics",ai:null,fighter:null,interactable:"give_spell_interactable",char:"۞",fgColor:"black",bgColor:"gold",blocks:!0,blocksSight:!1},player:{name:"The Player",graphics:"basic_graphics",lighting:"player_lighting",lightingColor:"white",lightingRange:7,ai:"player_control_ai",inventory:"basic_inventory",fighter:"basic_fighter",interactable:null,char:"@",fgColor:"blue",blocks:!0,blocksSight:!1,bgColor:"transparent",level:1,experience:0,experienceGiven:0,maxHp:100,maxMana:100,strength:3,defense:1,damageAffinity:{[Se.physical]:Me.normal,[Se.fire]:Me.normal,[Se.lightning]:Me.normal,[Se.ice]:Me.normal,[Se.nature]:Me.normal},onDeath:"default"},goblin:{name:"Goblin",graphics:"basic_graphics",ai:"basic_monster_ai",fighter:"basic_fighter",inventory:"basic_inventory",interactable:null,char:"G",fgColor:"green",bgColor:"transparent",blocks:!0,blocksSight:!1,level:3,experience:0,experienceGiven:50,maxHp:30,maxMana:0,strength:3,defense:1,sightRange:7,damageAffinity:{[Se.physical]:Me.normal,[Se.fire]:Me.normal,[Se.lightning]:Me.normal,[Se.ice]:Me.normal,[Se.nature]:Me.normal},inventoryPool:[["health_potion_weak",.25]],onDeath:"default"},goblin_brute:{name:"Goblin Brute",graphics:"basic_graphics",ai:"patrolling_monster_ai",fighter:"basic_fighter",inventory:"basic_inventory",interactable:null,char:"G",fgColor:"green",bgColor:"red",blocks:!0,blocksSight:!1,level:10,experience:0,experienceGiven:500,maxHp:100,maxMana:0,strength:7,defense:4,sightRange:7,damageAffinity:{[Se.physical]:Me.normal,[Se.fire]:Me.normal,[Se.lightning]:Me.normal,[Se.ice]:Me.normal,[Se.nature]:Me.normal},inventoryPool:[["health_potion_weak",.25],["health_potion",.1]],onDeath:"default"},rat:{name:"Rat",graphics:"basic_graphics",ai:"basic_monster_ai",fighter:"basic_fighter",inventory:"basic_inventory",interactable:null,char:"r",fgColor:"brown",bgColor:"transparent",blocks:!0,blocksSight:!1,level:1,experience:0,experienceGiven:10,maxHp:10,maxMana:0,strength:2,defense:1,sightRange:7,damageAffinity:{[Se.physical]:Me.normal,[Se.fire]:Me.normal,[Se.lightning]:Me.normal,[Se.ice]:Me.normal,[Se.nature]:Me.normal},inventoryPool:[],onDeath:"default"}};Object.freeze(Ee);const Ge={health_potion_weak:{displayName:"Weak Health Potion",value:25,type:"health",useFunc:ge},health_potion:{displayName:"Health Potion",value:50,type:"health",useFunc:ge},health_potion_strong:{displayName:"Health Potion",value:100,type:"health",useFunc:ge},lightning_scroll_weak:{displayName:"Weak Scroll of Lightning",value:20,type:"damage_scroll",useFunc:de,damageType:Se.lightning},lightning_scroll:{displayName:"Scroll of Lightning",value:50,type:"damage_scroll",useFunc:de,damageType:Se.lightning},lightning_scroll_strong:{displayName:"Strong Scroll of Lightning",value:100,type:"damage_scroll",useFunc:de,damageType:Se.lightning},fireball_scroll_weak:{displayName:"Weak Scroll of Fire",value:20,type:"damage_scroll",useFunc:de,damageType:Se.fire,statusEffectFunc:_e},fireball_scroll:{displayName:"Scroll of Fire",value:50,type:"damage_scroll",useFunc:de,damageType:Se.fire,statusEffectFunc:_e},fireball_scroll_strong:{displayName:"Strong Scroll of Fire",value:100,type:"damage_scroll",useFunc:de,damageType:Se.fire,statusEffectFunc:_e},lightning_scroll_weak_wild:{displayName:"Weak Scroll of Wild Lightning",value:50,type:"wild_damage_scroll",useFunc:fe,damageType:Se.lightning},lightning_scroll_wild:{displayName:"Scroll of Wild Lightning",value:100,type:"wild_damage_scroll",useFunc:fe,damageType:Se.lightning},lightning_scroll_strong_wild:{displayName:"Strong Scroll of Wild Lightning",value:150,type:"wild_damage_scroll",useFunc:fe,damageType:Se.lightning},fireball_scroll_weak_wild:{displayName:"Weak Scroll of Wild Fire",value:50,type:"wild_damage_scroll",useFunc:fe,damageType:Se.fire,statusEffectFunc:_e},fireball_scroll_wild:{displayName:"Scroll of Wild Fire",value:100,type:"wild_damage_scroll",useFunc:fe,damageType:Se.fire,statusEffectFunc:_e},fireball_scroll_strong_wild:{displayName:"Strong Scroll of Wild Fire",value:150,type:"wild_damage_scroll",useFunc:fe,damageType:Se.fire,statusEffectFunc:_e},confuse_scroll:{displayName:"Scroll of Confuse Enemy",value:8,type:"confuse_scroll",useFunc:function(e,t,i){Y.Game.displayMessage("Left click on an enemy to target it, click elsewhere to cancel"),pe((function(t){if(null===t)return i(!1);Y.Game.displayMessage(t.name+" is now confused");const n=t.ai;return t.ai=new le(n,e.value),t.ai.owner=t,i(!0)}))}},clairvoyance_scroll:{displayName:"Scroll of Clairvoyance",type:"clairvoyance_scroll",useFunc:function(e,t,i){return Y.Game.displayMessage("You have been granted Clairvoyance"),function(e){for(let t=0;t<e.length;t++)for(let i=0;i<e[t].length;i++)e[t][i].explored=!0}(Y.Game.map),i(!0)}}};Object.freeze(Ge);const Oe={lightning_bolt:{name:"Lightning Bolt",manaCost:50,value:10,useFunc:de}};function Le(e,t,i,n){if(t.length>26)return void console.error("too many items");const r="a".charCodeAt(0),s=t.length+6;for(let e=0;e<n;e++)for(let t=0;t<s;t++)0===e||0===t||e===n-1||t===s-1?Y.Game.display.draw(e,t,"1","grey","grey"):Y.Game.display.draw(e,t,"1","black","black");Y.Game.display.drawText(2,1,"%c{white}%b{black}"+e);for(let e=0;e<t.length;e++)switch(i){case"inventory":Y.Game.display.drawText(2,e+3,`%c{white}%b{black} ${String.fromCharCode(e+r)}: ${t[e].name} (${t[e].count})`);break;case"spells":Y.Game.display.drawText(2,e+3,`%c{white}%b{black} ${String.fromCharCode(e+r)}: ${t[e].name} dmg: ${t[e].value} cost: ${t[e].manaCost}`);break;default:throw new Error("Unknown menu type "+i)}}function Pe(e,t,i){return function(){const n=T[i][t],r=e.x+n[0],s=e.y+n[1],o=ee(Y.Game.map,Y.Game.gameObjects,r,s);if(!0===o)return!1;if(o){if(o.interactable)return o.interactable.interact(e),!0;if(o.fighter)return e.fighter.attack(o),!0}return e.x=r,e.y=s,!0}}function Ae(e){return function(){const t=Y.Game.gameObjects.filter(t=>"dropped_item"===t.type&&t.x===e.x&&t.y===e.y);return t.length>0?(t[0].interactable.interact(e),!0):(Y.Game.displayMessage("There's no item to pick up"),!1)}}function Ie(e){return function(){return Le("Spells",e.fighter.getKnownSpells().map(e=>Oe[e]),"spells",70),e.ai.state="spell_selection",!1}}function Re(e){return function(){return function(){for(let e=0;e<70;e++)for(let t=0;t<16;t++)0===e||0===t||69===e||15===t?Y.Game.display.draw(e,t,"1","grey","grey"):Y.Game.display.draw(e,t,"1","black","black");Y.Game.display.drawText(2,1,"%c{white}%b{black} Keyboard Bindings"),Y.Game.display.drawText(2,3,"%c{white}%b{black} Click on an option to change it");const e=Object.keys(Y.Game.player.keyCommandMap);for(let t=0;t<e.length;t++){const i=e[t];Y.Game.display.drawText(2,t+5,"%c{white}%b{black} "+Y.Game.player.keyCommandMap[i][0]+": "+i)}}(),e.ai.state="keybinding",!1}}Object.freeze(Oe);class Fe{constructor(){this.owner=null,this.keyCommandMap={},this.state="normal"}setOwner(e){var t;this.owner=e,this.keyCommandMap={w:["Move Up",Pe(this.owner,0,8)],e:["Move Up Right",Pe(this.owner,1,8)],d:["Move Right",Pe(this.owner,2,8)],c:["Move Down Right",Pe(this.owner,3,8)],s:["Move Down",Pe(this.owner,4,8)],z:["Move Down Left",Pe(this.owner,5,8)],a:["Move Left",Pe(this.owner,6,8)],q:["Move Up Left",Pe(this.owner,7,8)],i:["Inventory",(t=this.owner,function(){return Le("Player Inventory",t.inventoryComponent.getNamesAndCounts(),"inventory",70),t.ai.state="inventory",!1})],g:["Get Item",Ae(this.owner)],m:["Spells",Ie(this.owner)],Escape:["Key Bindings",Re(this.owner)]}}act(){Y.Game.engine.lock(),window.addEventListener("keydown",this)}handleEvent(e){if(e.preventDefault(),null===this.owner.fighter||this.owner.fighter.hp<=0)return;const t=e.key;if("normal"===this.state){if(!(t in this.keyCommandMap))return;if(!this.keyCommandMap[t][1]())return}else{if("inventory"===this.state){const e="a".charCodeAt(0),i="z".charCodeAt(0),n=t.charCodeAt(0);if(n<e&&n>i)return;if("Escape"===t)return this.state="normal",void Y.Game.manager.act();const r={},s=this.owner.inventoryComponent.getIDsAndCounts();for(let t=0;t<s.length;t++)r[e+t]=s[t].id;if(!(n in r))return;const o=Ge[r[n]],a=e=>{this.owner.ai.state="normal",e&&(this.owner.inventoryComponent.useItem(r[n]),Y.Game.displayMessage("Used "+o.displayName),Y.Game.engine.unlock())};return void o.useFunc(o,this.owner,a.bind(this))}if("spell_selection"===this.state){const e="a".charCodeAt(0),i="z".charCodeAt(0),n=t.charCodeAt(0);if(n<e&&n>i)return;if("Escape"===t)return this.state="normal",void Y.Game.manager.act();const r={},s=this.owner.fighter.getKnownSpells();for(let t=0;t<s.length;t++)r[e+t]=s[t];if(!(n in r))return;const o=Oe[r[n]];if(o.manaCost>this.owner.fighter.mana)return void Y.Game.displayMessage("Not enough mana to cast "+o.name);const a=e=>{this.owner.ai.state="normal",e&&(this.owner.fighter.useMana(o.manaCost),Y.Game.engine.unlock())};o.useFunc(o,this.owner,a.bind(this))}else"keybinding"===this.state&&console.log("fix me")}window.removeEventListener("keydown",this),Y.Game.engine.unlock()}}class ze{constructor(){this.owner=null}setOwner(e){this.owner=e}interact(e){if(this.owner.inventoryComponent){const t=this.owner.inventoryComponent.getIDsAndCounts();if(t.length>0)for(let i=0;i<t.length;i++){const n=t[i];Y.Game.displayMessage("Found a "+Ge[n.id].displayName),e.inventoryComponent.addItem(n.id,n.count),this.owner.inventoryComponent.useItem(n.id)}else Y.Game.displayMessage("Empty")}else console.error("Missing inventoryComponent on ",this.owner)}}class Ne{constructor(){this.owner=null,this.spellId=null}setOwner(e){this.owner=e}setSpell(e){this.spellId=e}interact(e){if(!this.spellId)throw new Error("No spell id given");if(!(this.spellId in Oe))throw new Error(this.spellId+" is not a valid spell");const t=e.fighter.addSpellById(this.spellId),i=Oe[this.spellId];t?Y.Game.displayMessage("You learned a new spell: "+i.name):Y.Game.displayMessage("You already know "+i.name)}}class je{constructor(){this.owner=null,this.levelName=null}setLevel(e){this.levelName=e}setOwner(e){this.owner=e}interact(){Y.Game.removeObject(this.owner)}}class De{constructor(){this.owner=null,this.levelName=null}setLevel(e){this.levelName=e}setOwner(e){this.owner=e}interact(){if(!this.levelName)throw new Error("No level name has been set for load");Y.Game.loadLevel(this.levelName)}}class Ue{constructor(){this.owner=null,this._inventory={}}setOwner(e){this.owner=e}getIDsAndCounts(){return Reflect.ownKeys(this._inventory).map(e=>({id:e,count:this._inventory[e]}))}getNamesAndCounts(){return Reflect.ownKeys(this._inventory).map(e=>({name:Ge[e].displayName,count:this._inventory[e]}))}hasItem(e){return e in this._inventory}addItem(e,t=1){if(e in this._inventory){const i=this._inventory[e]+t;if(100===i)return!1;this._inventory[e]=i}else this._inventory[e]=t;return!0}useItem(e){if(!(e in this._inventory))throw new Error(`Item ${e} not in inventory`);this._inventory[e]--,0===this._inventory[e]&&delete this._inventory[e]}}class Xe{constructor(e,t,i){this.char=e,this.fgColor=t,this.bgColor=i,this.owner=null}setOwner(e){this.owner=e}draw(e,t){this.owner&&t[this.owner.y][this.owner.x].isVisibleAndLit()&&e.draw(this.owner.x,this.owner.y,this.char,this.fgColor,this.bgColor)}}class Ye{constructor(e,t,i){this.char=e,this.fgColor=t,this.bgColor=i,this.owner=null}setOwner(e){this.owner=e}draw(e,t){this.owner&&t[this.owner.y][this.owner.x].explored&&e.draw(this.owner.x,this.owner.y,this.char,this.fgColor,this.bgColor)}}function He(e){return function(t,i){return t<0||i<0||t>=ye||i>=we||e[i][t].blocksSight?0:e[i][t].reflectivity}}class We{constructor(e,t){this.color=e,this.range=t}setOwner(e){this.owner=e}compute(e){const t=new z.PreciseShadowcasting(re(this.owner)),i=new U(He(e),{range:this.range,passes:2});i.setFOV(t),i.setLight(this.owner.x,this.owner.y,this.color),i.compute((function(t,i,n){t<0||i<0||t>=ye||i>=we||(e[i][t].lightingColor=X.toRGB(X.add(X.fromString(e[i][t].lightingColor),n)))})),e[this.owner.y][this.owner.x].lightingColor=this.color}}class Be{constructor(e,t){this.color=e,this.range=t}setOwner(e){this.owner=e}compute(e){new z.PreciseShadowcasting(re(this.owner)).compute(this.owner.x,this.owner.y,100,(function(t,i){t<0||i<0||t>=ye||i>=we||(e[i][t].visible=!0)}));const t=new z.PreciseShadowcasting(re(this.owner)),i=new U(He(e),{range:this.range,passes:2});i.setFOV(t),i.setLight(this.owner.x,this.owner.y,this.color),i.compute((function(t,i,n){t<0||i<0||t>=ye||i>=we||(e[i][t].lightingColor=X.toRGB(X.add(X.fromString(e[i][t].lightingColor),n)),e[i][t].explored=!0)}))}}class qe{constructor(e,t=null){this.hp=e.maxHp,this.maxHp=e.maxHp,this.mana=e.maxMana,this.maxMana=e.maxMana,this.strength=e.strength,this.defense=e.defense,this.deathCallback=t,this.owner=null,this.experience=e.experience,this.experienceGiven=e.experienceGiven,this.level=e.level,this.criticalChance=.05,this.criticalDamageMultipler=1.5,this.statusEffects=[],this.ailmentSusceptibility=e.ailmentSusceptibility,this.knownSpells=new Set}setOwner(e){this.owner=e}act(){const e=50+150*this.level;if(this.experience>=e&&(this.level+=1,this.experience=0,this.hp=this.maxHp,this.strength++,this.owner===Y.Game.player&&Y.Game.displayMessage("You reached level "+this.level+"!")),this.statusEffects.length>0)for(let e=0;e<this.statusEffects.length;e++){const t=this.statusEffects[e];t.act(),0===t.turns&&(Y.Game.displayMessage(`${this.owner.name} recovered from its ${t.name}`),this.statusEffects.splice(e,1))}}takeDamage(e,t){t>0&&(this.hp-=t),this.hp<=0&&(e.fighter.experience+=this.experienceGiven,null!==this.deathCallback&&this.deathCallback(this.owner))}attack(e){if(!e.fighter)return;let t=Math.round(Math.max(1,this.strength-e.fighter.defense)),i=!1;r.a.getUniform()<=this.criticalChance&&(t=Math.ceil(t*this.criticalDamageMultipler),i=!0),t>0?(i?Y.Game.displayMessage("CRITICAL! "+this.owner.name+" attacks "+e.name+" for "+t+" damage."):Y.Game.displayMessage(this.owner.name+" attacks "+e.name+" for "+t+" damage."),e.fighter.takeDamage(this.owner,t)):Y.Game.displayMessage(this.owner.name+" attacks "+e.name+", but it's too weak!")}heal(e){this.hp+=e,this.hp>this.maxHp&&(this.hp=this.maxHp)}useMana(e){this.mana=Math.max(this.mana-e,0)}addStatusEffect(e){this.statusEffects.push(e)}addSpellById(e){return!this.knownSpells.has(e)&&(this.knownSpells.add(e),!0)}getKnownSpells(){return[...this.knownSpells]}}class $e{constructor(e,t,i,n,r=!1,s=!1){this.type=e,this.x=t,this.y=i,this.name=n,this.blocks=r,this.blocksSight=s,this.graphics=null,this.lighting=null,this.fighter=null,this.ai=null,this.inventoryComponent=null,this.interactable=null}setGraphics(e){e.setOwner(this),this.graphics=e}setLighting(e){e.setOwner(this),this.lighting=e}setFighter(e){e.setOwner(this),this.fighter=e}setAI(e){e.setOwner(this),this.ai=e}setInventory(e){e.setOwner(this),this.inventoryComponent=e}setInteractable(e){e.setOwner(this),this.interactable=e}act(){this.ai&&"function"==typeof this.ai.act&&this.ai.act(),this.fighter&&"function"==typeof this.fighter.act&&this.fighter.act()}}function Ve(e,t=0,i=0){if(!(e in Ee))throw new Error(e+" is not valid object id");const n=Ee[e],s=new $e(e,t,i,n.name,n.blocks,n.blocksSight);if(n.ai)switch(n.ai){case"player_control_ai":s.setAI(new Fe);break;case"basic_monster_ai":s.setAI(new oe(n.sightRange));break;case"patrolling_monster_ai":s.setAI(new ae(n.sightRange));break;case"chest_ai":s.setAI(new he(n.bgColor,n.emptyColor));break;case"dropped_item_ai":s.setAI(new ce);break;default:console.error("Unhandled AI type "+n.ai)}if(n.graphics)switch(n.graphics){case"basic_graphics":s.setGraphics(new Xe(n.char,n.fgColor,n.bgColor));break;case"draw_after_seen":s.setGraphics(new Ye(n.char,n.fgColor,n.bgColor));break;default:console.error("Unhandled Graphics type "+n.graphics)}if(n.lighting)switch(n.lighting){case"reflectivity":s.setLighting(new We(n.lightingColor,n.lightingRange));break;case"player_lighting":s.setLighting(new Be(n.lightingColor,n.lightingRange));break;default:console.error("Unhandled Lighting type "+n.lighting)}if(n.fighter){let e;switch(n.onDeath){case"default":e=Ke;break;case"removeFromWorld":e=Je;break;default:console.error("Unhandled onDeath type "+n.onDeath)}switch(n.fighter){case"basic_fighter":s.setFighter(new qe(n,e));break;default:console.error("Unhandled Fighter type "+n.fighter)}}if(n.inventory){switch(n.inventory){case"basic_inventory":s.setInventory(new Ue);break;default:console.error("Unhandled Inventory type "+n.inventory)}if(n.inventoryPool)for(let e=0;e<n.inventoryPool.length;e++)r.a.getUniform()<=n.inventoryPool[e][1]&&s.inventoryComponent.addItem(n.inventoryPool[e][0])}if(n.interactable)switch(n.interactable){case"give_items_interactable":s.setInteractable(new ze);break;case"give_spell_interactable":s.setInteractable(new Ne);break;case"load_level_interactable":s.setInteractable(new De);break;case"door_interactable":s.setInteractable(new je);break;default:console.error("Unhandled Interactable type "+n.interactable)}return s}function Ke(e){if(Y.Game.displayMessage(e.name+" has been killed"),e.graphics.char="%",e.graphics.fgColor="green",e.graphics.bgColor="darkred",e.blocks=!1,e.fighter=null,e.ai=null,e.interactable=null,e.name="Remains of a "+e.name,e.inventoryComponent.getIDsAndCounts().length>0){const t=Ve("dropped_item",e.x,e.y);t.inventoryComponent=e.inventoryComponent,Y.Game.addObject(t)}e.inventoryComponent=null}function Je(e){if(e.inventoryComponent.getIDsAndCounts().length>0){const t=Ve("dropped_item",e.x,e.y);t.inventoryComponent=e.inventoryComponent,Y.Game.addObject(t)}Y.Game.removeObject(e)}function Qe(e){const t=Y.Game.display.eventToPosition(e),i=Z(Y.Game.gameObjects,t[0],t[1])[0];i&&i.name&&i.ai&&i.ai.state?"wander"===i.ai.state?Y.Game.displayMessage("A "+i.name+", it hasn't seen you."):Y.Game.displayMessage("A "+i.name):i&&i.name?Y.Game.displayMessage(i.name):i||Y.Game.displayMessage(Y.Game.map[t[1]][t[0]].name)}class Ze{constructor(e){this.game=e}act(){this.game.engine.lock(),this.game.currentTurn++,null!==this.game.player.fighter?(!function(e){for(let t=0;t<e.length;t++)for(let i=0;i<e[t].length;i++)e[t][i].visible=!1,e[t][i].lightingColor=Ce}(this.game.map),this.game.drawAll(),this.game.engine.unlock()):this.game.loseCinematic()}}Y.Game=new class{constructor(){this.canvas=null,this.display=null,this.player=null,this.engine=null,this.scheduler=null,this.gameObjects=[],this.map=[],this.currentLogLines=[],this.currentLevel=0,this.currentTurn=0,this.totalMessages=0,this.display=new O({width:70,height:45,fontSize:13,forceSquareRatio:!0}),this.canvas=this.display.getContainer(),document.getElementById("canvas").appendChild(this.canvas),this.openingCinematic()}reset(){!function(e){for(let t=0;t<45;t++)for(let i=0;i<70;i++)e.draw(i,t,".","black","black")}(this.display),this.player.fighter=null,this.player.ai=null,window.removeEventListener("keydown",this.player.ai),this.player=null,this.currentLevel=0,this.map=[],this.gameObjects=[],this.currentLogLines=[],this.scheduler.clear()}openingCinematic(){this.display.drawText(7,12,"%c{white}Your country is being overrun by the forces of darkness"),this.display.drawText(8,15,"%c{white}Tales tell of a weapon of great power lost in the"),this.display.drawText(4,16,"%c{white}lands beyond the dwarf stronghold Durdwin, under the Red Hills."),this.display.drawText(17,18,"%c{white}None who have entered have returned"),this.display.drawText(14,20,"%c{white}It is the last hope of a desperate people"),this.display.drawText(16,21,"%c{white}You have volunteered to retrieve it"),this.display.drawText(24,27,"%c{white}Press [enter] to start");const e=this;window.addEventListener("keydown",(function t(i){"Enter"===i.key&&(e.startGameplay(),window.removeEventListener("keydown",t))}))}winCinematic(){this.reset(),this.display.drawText(12,12,"%c{white}You have reached the bottom and have retrieved"),this.display.drawText(16,13,"%c{white}the fabled weapon and saved your people"),this.display.drawText(18,24,"%c{white}Press [enter] to restart the game");const e=this;window.addEventListener("keydown",(function t(i){"Enter"===i.key&&(e.startGameplay(),window.removeEventListener("keydown",t))}))}loseCinematic(){this.reset(),this.display.drawText(5,12,"%c{white}You have died, and the last hope of your people dies with you"),this.display.drawText(18,24,"%c{white}Press [enter] to restart the game");const e=this;window.addEventListener("keydown",(function t(i){"Enter"===i.key&&(e.startGameplay(),window.removeEventListener("keydown",t))}))}startGameplay(){this.hookMouseLook(),this.scheduler=new I.Simple,this.manager=new Ze(this),this.player=Ve("player",1,1),this.loadLevel("level_1")}displayMessage(e){this.totalMessages++;for(let e=0;e<70;e++)for(let t=1;t<6;t++)this.display.draw(e,45-t,"","black","black");5===this.currentLogLines.length&&this.currentLogLines.splice(0,1),this.currentLogLines.push(this.totalMessages+") "+e);for(let e=0;e<this.currentLogLines.length;e++)this.display.drawText(0,40+e,"%c{white}"+this.currentLogLines[e])}drawAll(){this.gameObjects.filter(e=>e.lighting&&"function"==typeof e.lighting.compute).forEach(e=>e.lighting.compute(this.map)),this.player.lighting.compute(this.map),function(e,t){for(let i=0;i<t.length;i++)for(let n=0;n<t[i].length;n++)te(e,t[i][n],n,i)}(this.display,this.map),this.gameObjects.filter(e=>e.graphics&&"function"==typeof e.graphics.draw).forEach(e=>e.graphics.draw(this.display,this.map)),this.player.graphics.draw(this.display,this.map),function(e,t,i){for(let t=0;t<70;t++)e.draw(t,39,"#","blue","blue");e.drawText(1,39,"%c{white}%b{blue}HP: "+i.fighter.hp+"/"+i.fighter.maxHp),e.drawText(14,39,"%c{white}%b{blue}Mana: "+i.fighter.mana+"/"+i.fighter.maxMana),e.drawText(30,39,"%c{white}%b{blue}STR: "+i.fighter.strength),e.drawText(38,39,"%c{white}%b{blue}DEF: "+i.fighter.defense),e.drawText(46,39,"%c{white}%b{blue}LVL: "+i.fighter.level),e.drawText(54,39,"%c{white}%b{blue}EXP: "+i.fighter.experience+"/"+(50+150*i.fighter.level))}(this.display,this.currentLevel,this.player)}loadLevel(e){if(this.currentLevel++,21===this.currentLevel)return void this.winCinematic();const{map:t,playerLocation:i,objects:n}=Q(e);this.map=t,this.gameObjects=n,this.player.x=i[0],this.player.y=i[1],this.player.fighter.mana=this.player.fighter.maxMana,this.scheduler.clear(),this.scheduler.add(this.manager,!0),this.scheduler.add(this.player,!0),this.gameObjects.forEach(e=>this.scheduler.add(e,!0)),this.engine=new D(this.scheduler),this.engine.start()}hookMouseLook(){this.canvas.addEventListener("mousedown",Qe)}unhookMouseLook(){this.canvas.removeEventListener("mousedown",Qe)}addObject(e){this.gameObjects.push(e),this.scheduler.add(this.gameObjects[this.gameObjects.length-1],!0)}removeObject(e){this.gameObjects.splice(this.gameObjects.indexOf(e),1),this.scheduler.remove(e)}}}]);